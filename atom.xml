<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ä»£ç æ®µå°ç«™</title>
  <icon>https://www.gravatar.com/avatar/4c71a513a84e4d430b9f9aed224237fc</icon>
  <subtitle>CodeTool - ä¸ªäººè®¡ç®—æœºç±»ç»ƒæ‰‹å°åšå®¢</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.codetool.top/"/>
  <updated>2020-03-09T18:59:46.148Z</updated>
  <id>https://www.codetool.top/</id>
  
  <author>
    <name>Rhett Peng</name>
    <email>pctdyx@qq.net</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>SpringBootæ—¥å¿—æ¡†æ¶çš„ä½¿ç”¨</title>
    <link href="https://www.codetool.top/article/SpringBoot%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <id>https://www.codetool.top/article/SpringBootæ—¥å¿—æ¡†æ¶çš„ä½¿ç”¨/</id>
    <published>2020-03-09T18:46:53.000Z</published>
    <updated>2020-03-09T18:59:46.148Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ç½®çŸ¥è¯†ï¼š</p><ul><li><a href="æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨">æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨ï¼ˆæ—¥å¿—ç³»åˆ—03ï¼‰</a></li><li><a href="../Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨">Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨ï¼ˆæ—¥å¿—ç³»åˆ—04ï¼‰</a></li></ul><p>æ¨èé˜…è¯»ï¼š</p><ul><li><a href="../Javaæ—¥å¿—æ¡†æ¶JULå’ŒLog4jä»‹ç»">Javaæ—¥å¿—æ¡†æ¶JULå’ŒLog4jä»‹ç»ï¼ˆæ—¥å¿—ç³»åˆ—01ï¼‰</a></li><li><a href="../æ—¥å¿—é—¨é¢ä»‹ç»å’ŒJCLä½¿ç”¨">æ—¥å¿—é—¨é¢ä»‹ç»å’ŒJCLä½¿ç”¨ï¼ˆæ—¥å¿—ç³»åˆ—02ï¼‰</a></li><li><a href="../Javaæ—¥å¿—æ¡†æ¶LOG4J2çš„ä»‹ç»å’Œä½¿ç”¨">Javaæ—¥å¿—æ¡†æ¶LOG4J2çš„ä»‹ç»å’Œä½¿ç”¨ï¼ˆæ—¥å¿—ç³»åˆ—05ï¼‰</a></li></ul><p>ï¼ˆJavaæ—¥å¿—ç³»åˆ—åˆ°è¿™ç¯‡ç®—æ˜¯å®Œç»“äº†å§ï¼Œå®Œç»“æ’’èŠ±<em>â˜…,Â°</em>:.â˜†(ï¿£â–½ï¿£)/$:<em>.Â°â˜…</em> ã€‚ï¼‰</p><h1 id="logging-starteræ¦‚è¿°">1 logging-starteræ¦‚è¿°</h1><p>SpringBootä½¿ç”¨æ—¥å¿—åŠŸèƒ½ä¾èµ–äº</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-logging<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><p>å®é™…ä¸Šï¼Œä¸éœ€è¦å¯¼å…¥è¿™ä¸ªä¾èµ–ï¼Œå› ä¸ºspringbootçš„æ ¸å¿ƒspring-boot-starterå­˜åœ¨å¯¹spring-boot-starter-loggingçš„ä¼ é€’ä¾èµ–ã€‚</p><p><img src="https://api.codetool.top/img/15837774833693.png" alt="logging-staterä¾èµ–"></p><ul><li><code>jul-to-slf4j</code>ï¼šå°†JULè½¬ä¸ºSLF4Jï¼ˆä½¿ç”¨SLF4Jä½œä¸ºæ—¥å¿—é—¨é¢ï¼‰</li><li><code>log4j-to-slf4j</code>ï¼šå°†LOG4J2æ—¥å¿—é—¨é¢è½¬ä¸ºSLF4J</li><li><code>logback-classic</code>ï¼šä½¿ç”¨logbackä½œä¸ºé»˜è®¤æ—¥å¿—å®ç°</li></ul><p>SpringBoot 2.0 ä¹‹å‰è¿˜ä¼šæœ‰ä¸€ä¸ª<code>log4j-over-slf4j</code>ç”¨æ¥è½¬æ¢log4jï¼Œ<strong>2.0ä¹‹åå°±å–æ¶ˆäº†å¯¹log4jçš„æ”¯æŒã€‚</strong>ï¼ˆè™½ç„¶å¯ä»¥é€šè¿‡starterä½¿ç”¨log4jï¼Œä½†å·²ç»ä¸æ¨èäº†ï¼‰</p><p>å¯ä»¥çœ‹å‡ºï¼ŒSpringBootä½¿ç”¨SLF4Jä½œä¸ºæ—¥å¿—é—¨é¢ï¼Œlogbackä½œä¸ºé»˜è®¤æ—¥å¿—å®ç°ã€‚</p><p>å¦‚æœæ˜¯å…¶ä»–æ—¥å¿—é—¨é¢å’Œæ—¥å¿—æ¡†æ¶ä¼šè‡ªåŠ¨æ¡¥æ¥è‡³SLF4Jã€‚</p><h1 id="æ—¥å¿—ç›¸å…³é…ç½®">2 æ—¥å¿—ç›¸å…³é…ç½®</h1><h2 id="SpringBooté…ç½®">2.1 SpringBooté…ç½®</h2><p>è¿™é‡Œä½¿ç”¨propertiesè¯­æ³•ï¼Œyamlä¹Ÿåªæ˜¯è½¬æ¢ä¸€ä¸‹æ ¼å¼</p><pre class=" language-properties"><code class="language-properties"><span class="token comment" spellcheck="true"># è®¾ç½®è‡ªå®šä¹‰loggerçš„æ—¥å¿—çº§åˆ«</span><span class="token attr-name">logging.level.com.rhett.FileLogger</span><span class="token punctuation">=</span><span class="token attr-value">trace</span><span class="token comment" spellcheck="true"># è®¾ç½®console appenderçš„pattern</span><span class="token attr-name">logging.pattern.console</span><span class="token punctuation">=</span><span class="token attr-value">[%-5level] %d{yyyy-MM-dd HH:mm:ss} %c [%thread] --- %m%n</span><span class="token comment" spellcheck="true"># æŒ‡å®šæ—¥å¿—æ–‡ä»¶å­˜æ”¾çš„ç›®å½•ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯spring.log</span><span class="token attr-name">logging.file.path</span><span class="token punctuation">=</span><span class="token attr-value">logs/springboot/</span><span class="token comment" spellcheck="true"># è®¾ç½®file appenderçš„pattern</span><span class="token attr-name">logging.pattern.file</span><span class="token punctuation">=</span><span class="token attr-value">[%-5level] %d{yyyy-MM-dd HH:mm:ss} %c [%thread] --- %m%n</span></code></pre><h2 id="æŒ‡å®šé…ç½®">2.2 æŒ‡å®šé…ç½®</h2><p>å¦‚æœæƒ³é…ç½®ä¸€äº›é«˜çº§åŠŸèƒ½ï¼Œå¯ä»¥éœ€è¦å¯¼å…¥å…·ä½“æŸä¸ªæ—¥å¿—æ¡†æ¶çš„é…ç½®ï¼ŒSpringBootä¼šè‡ªåŠ¨æŸ¥æ‰¾éµå¾ªå¦‚ä¸‹å‘½åçš„é…ç½®æ–‡ä»¶ï¼š</p><table><thead><tr><th>æ—¥å¿—å®ç°</th><th>æ–‡ä»¶å‘½å</th></tr></thead><tbody><tr><td>Logback</td><td>logback-spring.xml, logback-spring.groovy, logback.xml, logback.groovy</td></tr><tr><td>Log4j2</td><td>log4j2-spring.xml , log4j2.xml</td></tr><tr><td>JUL</td><td>logging.properties</td></tr></tbody></table><p>å¯¹äºlogbackæ¥è¯´ï¼Œlogback-springè¿˜å¯ä»¥ä½¿ç”¨profileåŠŸèƒ½ï¼š</p><ul><li><code>logback.xml</code>ï¼šç›´æ¥å°±è¢«æ—¥å¿—æ¡†æ¶è¯†åˆ«äº†ï¼›</li><li><code>logback-spring.xml</code>ï¼šæ—¥å¿—æ¡†æ¶å°±ä¸ç›´æ¥åŠ è½½æ—¥å¿—çš„é…ç½®é¡¹ï¼Œç”±SpringBootè§£ææ—¥å¿—é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨SpringBootçš„ProfileåŠŸèƒ½</li></ul><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>console<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProfile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dev<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} ----> [%thread] ---> %-5level %logger{50} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>springProfile</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProfile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>test<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} ==== [%thread] ==== %-5level %logger{50} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>springProfile</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span></code></pre><p>åœ¨springbooté…ç½®ä¸­åˆ‡æ¢profileç¯å¢ƒï¼š</p><pre class=" language-properties"><code class="language-properties"><span class="token attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token attr-value">dev</span></code></pre><h1 id="å°†æ—¥å¿—å®ç°åˆ‡æ¢ä¸ºlog4j2">3 å°†æ—¥å¿—å®ç°åˆ‡æ¢ä¸ºlog4j2</h1><p>ç¦ç”¨logbackã€å¯ç”¨log4j2ï¼Œç„¶åå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨log4j2äº†ã€‚</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- ç¦ç”¨logback--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-logging<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- æ·»åŠ log4j2 --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-log4j2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‰ç½®çŸ¥è¯†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨&quot;&gt;æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨ï¼ˆæ—¥å¿—ç³»åˆ—03ï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;../Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨&quot;&gt;Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨ï¼ˆæ—¥å¿—
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="æ—¥å¿—" scheme="https://www.codetool.top/tags/%E6%97%A5%E5%BF%97/"/>
    
      <category term="SpringBoot" scheme="https://www.codetool.top/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>leetcode543-äºŒå‰æ ‘çš„ç›´å¾„</title>
    <link href="https://www.codetool.top/article/leetcode543-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84/"/>
    <id>https://www.codetool.top/article/leetcode543-äºŒå‰æ ‘çš„ç›´å¾„/</id>
    <published>2020-03-09T17:57:29.000Z</published>
    <updated>2020-03-09T19:00:01.466Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸé¢˜">1 åŸé¢˜</h1><p>ç»™å®šä¸€æ£µäºŒå‰æ ‘ï¼Œä½ éœ€è¦è®¡ç®—å®ƒçš„ç›´å¾„é•¿åº¦ã€‚ä¸€æ£µäºŒå‰æ ‘çš„ç›´å¾„é•¿åº¦æ˜¯ä»»æ„ä¸¤ä¸ªç»“ç‚¹è·¯å¾„é•¿åº¦ä¸­çš„æœ€å¤§å€¼ã€‚è¿™æ¡è·¯å¾„å¯èƒ½ç©¿è¿‡æ ¹ç»“ç‚¹ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><p>ç»™å®šäºŒå‰æ ‘</p><pre><code>          1         / \        2   3       / \           4   5    </code></pre><p>è¿”å› <strong>3</strong>, å®ƒçš„é•¿åº¦æ˜¯è·¯å¾„ [4,2,1,3] æˆ–è€… [5,2,1,3]ã€‚</p><p><strong>æ³¨æ„:</strong> ä¸¤ç»“ç‚¹ä¹‹é—´çš„è·¯å¾„é•¿åº¦æ˜¯ä»¥å®ƒä»¬ä¹‹é—´è¾¹çš„æ•°ç›®è¡¨ç¤ºã€‚</p><h1 id="è§£æ³•">2 è§£æ³•</h1><h2 id="æ€æƒ³">2.1 æ€æƒ³</h2><p>è‡ªåº•å‘ä¸Šdfsï¼Œé¦–å…ˆè¦äº†è§£è¿™ä¸ªæœ€é•¿è¾¹ä¸ä¸€å®šç»è¿‡æ ¹èŠ‚ç‚¹ï¼Œå¯¹äºæ¯ä¸ªç»“ç‚¹ï¼Œç»è¿‡å®ƒçš„æœ€é•¿ç›´å¾„ä¸ºå·¦è¾¹çš„æœ€é•¿è¾¹å’Œå³è¾¹çš„æœ€é•¿è¾¹ä¹‹å’Œã€‚è¿™ä¸ªç»“ç‚¹çš„æ·±åº¦ä¸ºå·¦è¾¹æœ€é•¿è¾¹å’Œå³è¾¹æœ€é•¿è¾¹çš„æœ€å¤§å€¼+1ã€‚è¿™æ ·è·å–å‡ºæ‰€æœ‰ç»è¿‡æŸèŠ‚ç‚¹çš„æœ€é•¿ç›´å¾„ï¼Œæ¯”è¾ƒå‡ºæœ€å¤§å€¼ã€‚</p><h2 id="ä»£ç ">2.2 ä»£ç </h2><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">diameterOfBinaryTree</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> right <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>        max <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>max<span class="token punctuation">,</span> left <span class="token operator">+</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åŸé¢˜&quot;&gt;1 åŸé¢˜&lt;/h1&gt;&lt;p&gt;ç»™å®šä¸€æ£µäºŒå‰æ ‘ï¼Œä½ éœ€è¦è®¡ç®—å®ƒçš„ç›´å¾„é•¿åº¦ã€‚ä¸€æ£µäºŒå‰æ ‘çš„ç›´å¾„é•¿åº¦æ˜¯ä»»æ„ä¸¤ä¸ªç»“ç‚¹è·¯å¾„é•¿åº¦ä¸­çš„æœ€å¤§å€¼ã€‚è¿™æ¡è·¯å¾„å¯èƒ½ç©¿è¿‡æ ¹ç»“ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç»™å®šäºŒå‰æ ‘&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="leetcode" scheme="https://www.codetool.top/tags/leetcode/"/>
    
      <category term="ç®—æ³•" scheme="https://www.codetool.top/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="DFS" scheme="https://www.codetool.top/tags/DFS/"/>
    
  </entry>
  
  <entry>
    <title>Javaæ—¥å¿—æ¡†æ¶LOG4J2çš„ä»‹ç»å’Œä½¿ç”¨</title>
    <link href="https://www.codetool.top/article/Java%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6LOG4J2%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8/"/>
    <id>https://www.codetool.top/article/Javaæ—¥å¿—æ¡†æ¶LOG4J2çš„ä»‹ç»å’Œä½¿ç”¨/</id>
    <published>2020-03-09T17:35:20.000Z</published>
    <updated>2020-03-09T18:49:48.554Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ç½®çŸ¥è¯†ï¼š <a href="../æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨">æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨</a></p><p>æ¨èé˜…è¯»ï¼š <a href="../Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨/">Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨</a></p><h1 id="log4j2æ¦‚è¿°">1 log4j2æ¦‚è¿°</h1><p>Apache Log4j2æ˜¯å¯¹Log4jçš„å‡çº§ç‰ˆï¼Œå‚è€ƒäº†logbackçš„ä¸€äº›ä¼˜ç§€çš„è®¾è®¡ï¼Œå¹¶ä¸”ä¿®å¤äº†ä¸€äº›é—®é¢˜ï¼Œå› æ­¤å¸¦æ¥äº†ä¸€äº›é‡å¤§çš„æå‡,ä¸»è¦æœ‰:</p><ul><li>å¼‚å¸¸å¤„ç†ï¼Œåœ¨logbackä¸­, Appenderä¸­çš„å¼‚å¸¸ä¸ä¼šè¢«åº”ç”¨æ„ŸçŸ¥åˆ°,ä½†æ˜¯åœ¨log4j2ä¸­,æä¾›äº†ä¸€äº›å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚</li><li>æ€§èƒ½æå‡ï¼Œlog4j2ç›¸è¾ƒäºlog4jå’Œlogbackéƒ½å…·æœ‰å¾ˆæ˜æ˜¾çš„æ€§èƒ½æå‡ã€‚</li><li>è‡ªåŠ¨é‡è½½é…ç½®ï¼Œå‚è€ƒäº†logbackçš„è®¾è®¡ï¼Œå½“ç„¶ä¼šæä¾›è‡ªåŠ¨åˆ·æ–°å‚æ•°é…ç½®ï¼Œæœ€å®ç”¨çš„å°±æ˜¯æˆ‘ä»¬åœ¨ç”Ÿäº§ä¸Šå¯ä»¥åŠ¨æ€åœ°ä¿®æ”¹æ—¥å¿—çš„çº§åˆ«è€Œä¸éœ€è¦é‡å¯åº”ç”¨ã€‚</li><li>æ— åƒåœ¾æœºåˆ¶ï¼Œlog4j2åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å…¶è®¾è®¡çš„ä¸€å¥—æ— åƒåœ¾æœºåˆ¶ï¼Œé¿å…é¢‘ç¹çš„æ—¥å¿—æ”¶é›†å¯¼è‡´çš„jvm gcã€‚</li></ul><p>Log4j2å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªæ—¥å¿—é—¨é¢ï¼Œä½†slf4jå·²ç»è¶³å¤Ÿä¼˜ç§€ï¼Œè¾ƒå°‘äººæŠŠLog4j2ç”¨ä½œæ—¥å¿—é—¨é¢ï¼Œé€šå¸¸è¿˜æ˜¯æŠŠå®ƒå½“æˆä¸€ä¸ªæ—¥å¿—å®ç°æ­é…slf4jä½¿ç”¨ã€‚</p><h1 id="log4j2æ—¥å¿—é—¨é¢">2 log4j2æ—¥å¿—é—¨é¢</h1><p>ç®€è¦ä»‹ç»ä¸€ä¸‹log4j2ä½œä¸ºæ—¥å¿—é—¨é¢çš„ä½¿ç”¨</p><p>mavenä¾èµ–ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.12.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.12.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><p>è¿™æ ·ä½¿ç”¨çš„å°±æ˜¯Log4j2æ—¥å¿—é—¨é¢+æœ¬èº«çš„å®ç°</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Logger LOGGER <span class="token operator">=</span> LogManager<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>LOG4J2Test<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQuick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    LOGGER<span class="token punctuation">.</span><span class="token function">fatal</span><span class="token punctuation">(</span><span class="token string">"fatal"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    LOGGER<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    LOGGER<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"warn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    LOGGER<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"debug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    LOGGER<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">"trace"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h1 id="log4j2-slf4jä½¿ç”¨">3 log4j2+slf4jä½¿ç”¨</h1><p>mavené…ç½®</p><pre class=" language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- slf4jæ—¥å¿—é—¨é¢ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>slf4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7.30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- log4j2é€‚é…å™¨ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j-slf4j-impl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.13.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- log4j2 --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.13.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><p>è¿™æ˜¯æœ€ç®€å•çš„å†™æ³•ï¼Œ<code>log4j-slf4j-impl</code>ä¾èµ–äº<code>log4j-api</code>ï¼Œå®ƒæ›´åƒæ˜¯æ¡¥æ¥Log4j2æ—¥å¿—é—¨é¢ã€‚</p><p>ä½¿ç”¨å°±æ˜¯SLF4Jçš„ä½¿ç”¨æ–¹æ³•ï¼ˆå‡è®¾ä½ æ²¡è·³å‰ç½®çŸ¥è¯†ğŸŒšï¼‰</p><h1 id="log4j2é…ç½®">4 log4j2é…ç½®</h1><p>log4j2é»˜è®¤åŠ è½½classpathä¸‹çš„<code>log4j2.xml</code>æ–‡ä»¶ä¸­çš„é…ç½®</p><p>å®ƒå’Œlogbackå®åœ¨æ˜¯å¤ªåƒäº†ï¼Œæ¯•ç«Ÿæœ¬æ¥å°±æ˜¯æŠ„è¢­çš„logbackï¼ˆè¿™æ˜¯å¯ä»¥è¯´çš„å—ğŸŒšï¼‰</p><p>logbackçš„é…ç½®è§<a href="../Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨/">Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨</a></p><p>æ‰€ä»¥æˆ‘æŠŠé…ç½®è´´å‡ºæ¥åº”è¯¥å°±èƒ½çœ‹æ‡‚ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token comment" spellcheck="true">&lt;!-- statusï¼Œä»£è¡¨æ—¥å¿—æ¡†æ¶æœ¬èº«çš„è¾“å‡ºæ—¥å¿—çº§åˆ«ï¼›monitorIntervalï¼Œé…ç½®ä¸º120ï¼Œå•ä½ä¸ºç§’ã€‚ç±»ä¼¼äºlogbackçš„scanPeriod --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Configuration</span> <span class="token attr-name">status</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>WARN<span class="token punctuation">"</span></span> <span class="token attr-name">monitorInterval</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>120<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- ç±»ä¼¼äºlogbackçš„propertyï¼Œä½†æ˜¯æ”¾å…¥äº†propertiesèŠ‚ç‚¹ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>LOG_HOME<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>/logs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- å°†æ‰€æœ‰Appenderæ”¾å…¥äº†AppendersèŠ‚ç‚¹ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Appenders</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!--ConsoleèŠ‚ç‚¹å°±ç›´æ¥æŒ‡å®šäº†è¿™ä¸ªappenderä½¿ç”¨çš„ç±»æ˜¯logbackè‡ªå¸¦çš„ï¼Œnameæ˜¯è‡ªå·±å‘½åçš„,target=SYSTEM_OUTè¡¨ç¤ºè¾“å‡ºåˆ°æ§åˆ¶å°ã€‚--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Console</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Console<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SYSTEM_OUT<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--patternå’Œlogbackå‡ ä¹ä¹Ÿæ²¡æœ‰åŒºåˆ«--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>%d{HH:mm:ss.SSS} [%t] [%-5level] %c{36}:%L --- %m%n<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Console</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!--FileèŠ‚ç‚¹å°±ç›´æ¥æŒ‡å®šäº†è¿™ä¸ªappenderä½¿ç”¨çš„ç±»æ˜¯logbackè‡ªå¸¦çš„ï¼ŒfileNameæŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨å±æ€§å€¼${}ï¼Œappend="true"è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log<span class="token punctuation">"</span></span> <span class="token attr-name">fileName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${LOG_HOME}/test.log<span class="token punctuation">"</span></span> <span class="token attr-name">append</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>%d{HH:mm:ss.SSS} [%t] [%-5level] %c{36}:%L --- %m%n<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!--RandomAccessFileï¼Œæ–‡ä»¶éšæœºè¯»å†™æµAppenderï¼Œæ¯”Fileæ€§èƒ½è¾ƒå¥½--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RandomAccessFile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log<span class="token punctuation">"</span></span> <span class="token attr-name">fileName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${LOG_HOME}/test.log<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>%d{HH:mm:ss.SSS} [%t] [%-5level] %c{36}:%L --- %m%n<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RandomAccessFile</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!--RollingFileæˆ–ä½¿ç”¨RollingRandomAccessFileï¼Œè‡ªåŠ¨æ‹†åˆ†çš„æ–‡ä»¶éšæœºè¯»å†™æµAppenderï¼Œ filePatternï¼šå†å²æ—¥å¿—å°å­˜è·¯å¾„ã€‚log4j2ä¹Ÿè‡ªåŠ¨è¯†åˆ«zipç­‰åç¼€ï¼Œè¡¨ç¤ºå†å²æ—¥å¿—éœ€è¦å‹ç¼©ã€‚--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RollingRandomAccessFile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>File<span class="token punctuation">"</span></span> <span class="token attr-name">immediateFlush</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">fileName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${LOG_HOME}/today.log<span class="token punctuation">"</span></span>                                 <span class="token attr-name">filePattern</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${LOG_HOME}/$${date:yyyy-MM-dd}/myrollog-%d{yyyy-MM-dd}-%i.log<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!-- å’Œlogbackçš„è¿‡æ»¤å™¨ç±»ä¼¼ï¼ŒonMatchã€onMismatchå¯ä»¥ä¸ºNEUTRALè¡¨ç¤ºä¸­ç«‹ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Filters</span><span class="token punctuation">></span></span>                <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—çº§åˆ«è¿‡æ»¤å™¨ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThresholdFilter</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span> <span class="token attr-name">onMatch</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ACCEPT<span class="token punctuation">"</span></span> <span class="token attr-name">onMismatch</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>DENY<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Filters</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>%d{HH:mm:ss.SSS} [%t] [%-5level] %c{36}:%L --- %m%n<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token comment" spellcheck="true">&lt;!--                ä¹Ÿå¯ä»¥æ˜¯ç±»ä¼¼äºlogbackçš„HTMLLayout                &lt;HTMLLayout pattern="%d{HH:mm:ss.SSS}%t%-5level%c{36}%L%m%n" />            --></span>            <span class="token comment" spellcheck="true">&lt;!--RollingRandomAccessFileçš„å¿…é…é¡¹,TriggeringPolicy(è§¦å‘ç­–ç•¥) --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Policies</span><span class="token punctuation">></span></span>                <span class="token comment" spellcheck="true">&lt;!--åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œè§¦å‘æ‹†åˆ†è§„åˆ™ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„æ—¥å¿—æ–‡ä»¶--></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OnStartupTriggeringPolicy</span> <span class="token punctuation">/></span></span>                <span class="token comment" spellcheck="true">&lt;!--æŒ‰æ—¶é—´åˆ’åˆ†æ—¥å¿—æ–‡ä»¶ï¼Œå•ä½æ˜¯filePatternä¸­é…ç½®çš„ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TimeBasedTriggeringPolicy</span> <span class="token punctuation">/></span></span>                <span class="token comment" spellcheck="true">&lt;!--æŒ‰å¤§å°åˆ’åˆ†æ—¥å¿—æ–‡ä»¶--></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SizeBasedTriggeringPolicy</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10 MB<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Policies</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--è¦†ç›–ç­–ç•¥ï¼Œé™å®šåŒä¸€ä¸ªç›®å½•ä¸‹æ—¥å¿—æ–‡ä»¶çš„æœ€å¤§æ•°é‡--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DefaultRolloverStrategy</span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RollingRandomAccessFile</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Appenders</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- é…ç½®Root Loggerå’Œè‡ªå®šä¹‰logger --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Loggers</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>trace<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AppenderRef</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Console<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Root</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Loggers</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Configuration</span><span class="token punctuation">></span></span></code></pre><h1 id="å¼‚æ­¥æ—¥å¿—">5 å¼‚æ­¥æ—¥å¿—</h1><p>Log4j2æä¾›äº†AsyncAppenderå’ŒAsyncLoggerï¼Œé€šè¿‡BlockingQueueæ¥å®ç°å¼‚æ­¥ã€‚ï¼ˆæ¯”logbackåšçš„æ›´å…¨é¢ä¸€ç‚¹ï¼‰</p><p>é€šå¸¸ä½¿ç”¨AsyncLoggerã€‚</p><p>ä½¿ç”¨å¼‚æ­¥æ—¥å¿—éœ€è¦é…ç½®ä¾èµ–ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.lmax<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>disruptor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.4.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><h2 id="ä½¿ç”¨AsyncAppender">5.1 ä½¿ç”¨AsyncAppender</h2><p>è¿™ç§æ–¹å¼å’Œlogbackç±»ä¼¼</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Appenders</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Async</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Async<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AppenderRef</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Async</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Appenders</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Loggers</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>trace<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AppenderRef</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Console<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AppenderRef</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Async<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Loggers</span><span class="token punctuation">></span></span></code></pre><h2 id="ä½¿ç”¨AsyncLogger">5.2 ä½¿ç”¨AsyncLogger</h2><p>è¿™ç§æ–¹æ³•å¼‚æ­¥æ€§èƒ½æ›´é«˜ä¸€ç‚¹</p><h3 id="å…¨å±€å¼‚æ­¥">5.2.1 å…¨å±€å¼‚æ­¥</h3><p>æ‰€æœ‰æ—¥å¿—éƒ½å¼‚æ­¥ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸Šä¸ç”¨åšä»»ä½•æ”¹åŠ¨ï¼Œåªéœ€è¦æ·»åŠ ä¸€ä¸ª<code>log4j2.component.properties</code>é…ç½®ï¼š</p><pre class=" language-properties"><code class="language-properties"><span class="token attr-name">Log4jContextSelector</span><span class="token punctuation">=</span><span class="token attr-value">org.apache.logging.log4j.core.async.AsyncLoggerContextSelector</span></code></pre><h3 id="æ··åˆå¼‚æ­¥">5.2.2 æ··åˆå¼‚æ­¥</h3><p>å¯ä»¥åœ¨åº”ç”¨ä¸­åŒæ—¶ä½¿ç”¨åŒæ­¥æ—¥å¿—å’Œå¼‚æ­¥æ—¥å¿—ï¼Œè¿™ä½¿å¾—æ—¥å¿—çš„é…ç½®æ–¹å¼æ›´åŠ çµæ´»ã€‚</p><p>éœ€è¦é…ç½®è‡ªå®šä¹‰loggerï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Loggers</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- includeLocationå…³é—­æ–‡ä»¶ä¿¡æ¯ã€è¡Œå·ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å½±å“æ€§èƒ½ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AsyncLogger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.rhett.AsyncLogger<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>trace<span class="token punctuation">"</span></span> <span class="token attr-name">includeLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AppenderRef</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AsyncLogger</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Loggers</span><span class="token punctuation">></span></span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‰ç½®çŸ¥è¯†ï¼š &lt;a href=&quot;../æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨&quot;&gt;æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¨èé˜…è¯»ï¼š &lt;a href=&quot;../Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨/&quot;&gt;Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="java" scheme="https://www.codetool.top/tags/java/"/>
    
      <category term="æ—¥å¿—" scheme="https://www.codetool.top/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨</title>
    <link href="https://www.codetool.top/article/Java%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6Logback%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8/"/>
    <id>https://www.codetool.top/article/Javaæ—¥å¿—æ¡†æ¶Logbackä»‹ç»å’Œä½¿ç”¨/</id>
    <published>2020-03-09T15:07:24.000Z</published>
    <updated>2020-03-09T15:55:54.323Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ç½®çŸ¥è¯†ï¼š</p><p><a href="../æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨">æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨</a></p><h1 id="Logbackæ¦‚è¿°">1 Logbackæ¦‚è¿°</h1><p>Logbackæ˜¯ç”±log4jã€slf4jåˆ›å§‹äººCeki GÃ¼lcÃ¼è®¾è®¡çš„å¦ä¸€ä¸ªå¼€æºæ—¥å¿—ç»„ä»¶ï¼Œæ€§èƒ½æ¯”log4jè¦å¥½ã€‚å®ƒè‡ªç„¶åœ°å®ç°äº†slf4jè§„èŒƒã€‚</p><p>Logbackä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæ¨¡å—ï¼š</p><ul><li><code>logback-core</code>ï¼šlogbackçš„æ ¸å¿ƒæ¨¡å—ï¼Œä¹Ÿæ˜¯å…¶å®ƒä¸¤ä¸ªæ¨¡å—çš„åŸºç¡€æ¨¡å—</li><li><code>logback-classic</code>ï¼šå®ƒæ˜¯log4jçš„ä¸€ä¸ªæ”¹è‰¯ç‰ˆæœ¬,åŒæ—¶å®ƒå®Œæ•´å®ç°äº†slf4jAPI</li><li><code>logback-access</code>: è®¿é—®æ¨¡å—ä¸Servletå®¹å™¨é›†æˆæä¾›é€šè¿‡Httpæ¥è®¿é—®æ—¥å¿—çš„åŠŸèƒ½</li></ul><p>Logbackçš„æ ¸å¿ƒç»„ä»¶ï¼š</p><ul><li>Loggerï¼šæ—¥å¿—çš„è®°å½•å™¨,æŠŠå®ƒå…³è”åˆ°åº”ç”¨çš„å¯¹åº”çš„contextä¸Šåï¼Œä¸»è¦ç”¨äºå­˜æ”¾æ—¥å¿—å¯¹è±¡,ä¹Ÿå¯ä»¥å®šä¹‰æ—¥å¿—ç±»å‹ã€çº§åˆ«ã€‚</li><li>Appenderï¼šç”¨äºæŒ‡å®šæ—¥å¿—è¾“å‡ºçš„ç›®çš„åœ°,ç›®çš„åœ°å¯ä»¥æ˜¯æ§åˆ¶å°ã€æ–‡ä»¶ã€æ•°æ®åº“ç­‰ç­‰ã€‚</li><li>Layoutï¼šè´Ÿè´£æŠŠäº‹ä»¶è½¬æ¢æˆå­—ç¬¦ä¸²,æ ¼å¼åŒ–çš„æ—¥å¿—ä¿¡æ¯çš„è¾“å‡ºã€‚åœ¨ logbackLayoutencoderä¸­å¯¹è±¡è¢«å°è£…åœ¨ä¸­ã€‚</li></ul><h1 id="Logbackä½¿ç”¨">2 Logbackä½¿ç”¨</h1><p>mavenä¾èµ–ï¼š</p><p>è¿™é‡Œä½¿ç”¨slf4jæ¥ç®¡ç†</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>slf4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7.30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>ch.qos.logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>logback-classic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><h1 id="Logbacké…ç½®">3 Logbacké…ç½®</h1><p>logbackä¼šä¾æ¬¡è¯»å–ä»¥ä¸‹ç±»å‹é…ç½®æ–‡ä»¶ï¼š</p><ul><li>logback.groovy</li><li>logback-test.xml</li><li>logback.xml</li></ul><p>å¦‚æœå‡ä¸å­˜åœ¨ä¼šé‡‡ç”¨é»˜è®¤é…ç½®</p><p>logbackå®˜æ–¹æä¾›çš„log4jé…ç½®è½¬logbacké…ç½®å·¥å…·ï¼š<a href="http://logback.qos.ch/translator/" target="_blank" rel="noopener">http://logback.qos.ch/translator/</a></p><h2 id="åŸºæœ¬é…ç½®">3.1 åŸºæœ¬é…ç½®</h2><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>[%-5level] %d{yyyy-MM-dd HH:mm:ss.SSS} %c %M %L [%thread] %m%n<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>log_dir<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/logs<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- æ§åˆ¶å°æ—¥å¿—è¾“å‡ºçš„ appender--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>console<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æ§åˆ¶è¾“å‡ºæµå¯¹è±¡ï¼Œé»˜è®¤System.outæ”¹ä¸ºSystem.err--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">></span></span>System.err<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—æ¶ˆæ¯æ ¼å¼é…ç½®--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>${pattern}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—æ–‡ä»¶è¾“å‡ºçš„ appender--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.FileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—æ–‡ä»¶ä¿å­˜è·¯å¾„ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>${log_dir}/logback.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—æ¶ˆæ¯æ ¼å¼é…ç½®--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>${pattern}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- root logger é…ç½®--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ALL<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>console<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender-ref</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender-ref</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span></code></pre><p>patternå¸¸ç”¨è½¬æ¢ç¬¦ï¼š</p><ul><li><code>%c/%logger</code>ï¼šè¾“å‡ºæ—¥å¿—çš„loggeråï¼Œå¯æœ‰ä¸€ä¸ªæ•´å½¢å‚æ•°ï¼ŒåŠŸèƒ½æ˜¯ç¼©çŸ­loggeråï¼Œä¾‹å¦‚%logger{5}</li><li><code>%cn</code>ï¼šè¾“å‡ºä¸Šä¸‹æ–‡åç§°ã€‚</li><li><code>%d{pattern}</code>ï¼šè¾“å‡ºæ—¥å¿—çš„æ‰“å°æ—¥å¿—ï¼Œæ¨¡å¼è¯­æ³•ä¸<code>java.text.SimpleDateFormat</code>å…¼å®¹ã€‚</li><li><code>%p/%le/%level</code>ï¼šè¾“å‡ºæ—¥å¿—çº§åˆ«ã€‚</li><li><code>%t/%thread</code>:    è¾“å‡ºäº§ç”Ÿæ—¥å¿—çš„çº¿ç¨‹åã€‚</li><li><code>%n</code>ï¼šè¾“å‡ºå¹³å°ç›¸å…³çš„åˆ†è¡Œç¬¦â€œ\nâ€æˆ–è€…â€œ\r\nâ€ã€‚</li><li><code>%m/%msg/%message</code>ï¼šè¾“å‡ºåº”ç”¨ç¨‹åºæä¾›çš„ä¿¡æ¯ã€‚</li><li><code>%L/%line</code>ï¼šè¾“å‡ºæ‰§è¡Œæ—¥å¿—è¯·æ±‚çš„è¡Œå·ã€‚</li></ul><p>ä½¿ç”¨HTMLæ ¼å¼è¾“å‡ºï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—æ–‡ä»¶è¾“å‡ºçš„ appender--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>htmlFile<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.FileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—æ–‡ä»¶ä¿å­˜è·¯å¾„ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>${log_dir}/logback.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—æ¶ˆæ¯æ ¼å¼é…ç½®--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.encoder.LayoutWrappingEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.html.HTMLLayout<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%level%d{yyyy-MM-dd HH:mm:ss.SSS}%c%M%L%thread%m<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span></code></pre><h2 id="åŠ¨æ€åˆ·æ–°é…ç½®">3.2 åŠ¨æ€åˆ·æ–°é…ç½®</h2><p>æ ¹èŠ‚ç‚¹<code>configuration</code>å¯ä»¥é…ç½®ä¸¤ä¸ªå±æ€§ï¼š</p><ul><li><code>scan</code>: å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrueã€‚</li><li><code>scanPeriod</code>: è®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚å½“scanä¸ºtrueæ—¶ï¼Œæ­¤å±æ€§ç”Ÿæ•ˆã€‚é»˜è®¤çš„æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿã€‚</li></ul><p>é€šè¿‡é…ç½®è¿™ä¸¤ä¸ªå±æ€§ï¼Œå¯ä»¥åœ¨ç³»ç»Ÿè¿è¡Œæ—¶ä¿®æ”¹logbackçš„é…ç½®è€Œä¸éœ€è¦é‡å†™éƒ¨ç½²ï¼Œä¾‹å¦‚ä¿®æ”¹æ—¥å¿—çº§åˆ«</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">scan</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">scanPeriod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60 seconds<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- ... --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span></code></pre><h2 id="æ—¥å¿—æ‹†åˆ†å’Œå½’æ¡£å‹ç¼©çš„appender">3.3 æ—¥å¿—æ‹†åˆ†å’Œå½’æ¡£å‹ç¼©çš„appender</h2><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rollFile<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—æ–‡ä»¶ä¿å­˜è·¯å¾„ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>${log_dir}/roll_logback.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—æ¶ˆæ¯æ ¼å¼é…ç½®--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>${pattern}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- æŒ‡å®šæ‹†åˆ†è§„åˆ™ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æŒ‰ç…§æ—¶é—´å’Œå‹ç¼©æ ¼å¼å£°æ˜æ‹†åˆ†çš„æ–‡ä»¶å --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>${log_dir}/rolling.%d{yyyy-MM-dd}.log%i.gz<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æŒ‰ç…§æ–‡ä»¶å¤§å°æ‹†åˆ† --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>1MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span></code></pre><h2 id="è¿‡æ»¤å™¨">3.4 è¿‡æ»¤å™¨</h2><p>å†™åœ¨Appenderä¸­</p><p>çº§åˆ«è¿‡æ»¤å™¨ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—è¿‡æ»¤è§„åˆ™ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span></code></pre><p>å…¶ä»–çš„è¿˜æœ‰ThresholdFilterï¼ˆä¸´ç•Œå€¼è¿‡æ»¤å™¨ï¼‰ã€EvaluatorFilterï¼ˆæ±‚å€¼è¿‡æ»¤å™¨ï¼‰ç­‰ã€‚</p><h2 id="å¼‚æ­¥æ—¥å¿—">3.5 å¼‚æ­¥æ—¥å¿—</h2><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>async<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.AsyncAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- æŒ‡å®šæŸä¸ªå…·ä½“çš„appender --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender-ref</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span></code></pre><h2 id="è‡ªå®šä¹‰Logger">3.6 è‡ªå®šä¹‰Logger</h2><pre class=" language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- è‡ªå®šä¹‰loggerå¯¹è±¡    additivityï¼šæ˜¯å¦ç»§æ‰¿è‡ªrootLogger--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.rhett.consoleLogger<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>console<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender-ref</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span></code></pre><h1 id="logback-accessçš„ä½¿ç”¨">4 logback-accessçš„ä½¿ç”¨</h1><p>logback-accessæ¨¡å—ä¸Servletå®¹å™¨(å¦‚Tomcatå’ŒJetty)é›†æˆ,ä»¥æä¾›HTTPè®¿é—®æ—¥å¿—åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨logback-accesæ¨¡å—æ¥æ›¿æ¢tomcatçš„è®¿é—®æ—¥å¿—ã€‚</p><p>æ­¥éª¤ï¼š</p><ol><li>å°†<code>logback-access.jar</code>ä¸<code>logback-core.jar</code>å¤åˆ¶åˆ°<code>$TOMCAT_HOME/lib/</code>ç›®å½•ä¸‹</li><li>åœ¨<code>$TOMCAT_HOME/conf/server.xml</code>ä¸­çš„Hostå…ƒç´ ä¸­æ·»åŠ ï¼š</li></ol><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Value</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.access.tomcat.LogbackValue<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><ol start="3"><li>logbacké»˜è®¤ä¼šåœ¨<code>$TOMCAT_HOME/conf</code>ä¸‹æŸ¥æ‰¾æ–‡ä»¶<code>logback-access.xml</code></li></ol><p>ç¤ºä¾‹é…ç½®ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- always a good activate OnConsoleStatusListener--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusListener</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.status.OnConsoleStatusListener<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>LOG_DIR<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${catalina.base}/logs<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>FILE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>${LOG_DIR}/access.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>access.%d{yyyy-MM-dd).log.zip<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>combined<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>FILE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‰ç½®çŸ¥è¯†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;../æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨&quot;&gt;æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;Logbackæ¦‚è¿°&quot;&gt;1 Logbackæ¦‚è¿°&lt;/h1&gt;&lt;p&gt;Logbackæ˜¯ç”±log4jã€slf4jåˆ›å§‹äººCeki GÃ¼lcÃ¼è®¾è®¡
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="java" scheme="https://www.codetool.top/tags/java/"/>
    
      <category term="æ—¥å¿—" scheme="https://www.codetool.top/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨</title>
    <link href="https://www.codetool.top/article/%E6%97%A5%E5%BF%97%E9%97%A8%E9%9D%A2SLF4J%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8/"/>
    <id>https://www.codetool.top/article/æ—¥å¿—é—¨é¢SLF4Jä»‹ç»å’Œä½¿ç”¨/</id>
    <published>2020-03-09T12:43:21.000Z</published>
    <updated>2020-03-09T16:11:37.656Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SLF4jæ¦‚è¿°">1 SLF4jæ¦‚è¿°</h1><p>ä¸Šç¯‡æ–‡ç« å†™äº†<a href="../æ—¥å¿—é—¨é¢ä»‹ç»å’ŒJCLä½¿ç”¨">æ—¥å¿—é—¨é¢ä»‹ç»å’ŒJCLä½¿ç”¨</a>ï¼Œä½œä¸ºä¸€ä¸ªæ›¾ç»çš„ä¸»æµæ—¥å¿—é—¨é¢æŠ€æœ¯ï¼ŒJCLç»ˆç©¶å› ä¸ºè®¾è®¡æ—¶çš„äº§ç”Ÿé—®é¢˜æ‰€é™ï¼Œå¯¼è‡´è‡³ä»Šå·²æ²¡ä»€ä¹ˆäººä½¿ç”¨ï¼Œè€Œä¸€æ¬¾ä¼˜ç§€çš„æ—¥å¿—é—¨é¢æŠ€æœ¯SLF4jï¼Œå¸å–äº†JCLçš„æ•™è®­ä¸ç»éªŒï¼Œå‡ºç°åœ¨javaå¼€å‘è€…çš„è§†é‡ä¸­ï¼Œå¼€å§‹è¢«å¹¿æ³›å…³æ³¨å’Œä½¿ç”¨ã€‚</p><p>è¿™é‡Œå¦‚æœè°ˆè°ˆå†å²è¿˜è›®å¥½ç©çš„ï¼Œæ¶‰åŠåˆ°ä¸€ä½Javaæ—¥å¿—é¢†åŸŸçŸ¥åäººç‰©Ceki GÃ¼lcÃ¼ï¼Œlog4jã€slf4jã€logbackéƒ½æ˜¯å‡ºè‡ªä»–ä¹‹æ‰‹ï¼Œåœ¨Apacheç»„ç»‡å¼€å‘çš„log4jï¼Œåæ¥ç¦»å¼€äº†apacheå¼€å‘äº†logbackï¼Œapacheåè€Œåˆæ¨å‡ºäº†log4j2ä¸ä¹‹ç«äº‰ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹çœ‹<a href="https://segmentfault.com/a/1190000021121882" target="_blank" rel="noopener">Javaæ—¥å¿—ç³»ç»Ÿå†å²ä»å…¥é—¨åˆ°å´©æºƒ - ä¸ªäººæ–‡ç«  - SegmentFault æ€å¦</a></p><p>SLF4Jï¼Œå³<strong>ç®€å•æ—¥å¿—é—¨é¢</strong>ï¼ˆSimple Logging Facade for Javaï¼‰,ä¹Ÿä¸ºJavaæ—¥å¿—è®¿é—®æä¾›äº†ä¸€å¥—æ ‡å‡†ã€è§„èŒƒçš„APIæ¡†æ¶ï¼Œå®ƒæ”¯æŒäº†log4jå’Œlogbackï¼Œå®ƒæœ¬èº«ä¹Ÿæä¾›äº†åŠŸèƒ½è¾ƒç®€å•çš„æ—¥å¿—å®ç°ï¼Œä½†ä¸€èˆ¬å¾ˆå°‘ç”¨åˆ°ï¼Œå®ƒçš„è®¾è®¡æ€æƒ³å’ŒJCLè¾ƒä¸ºä¸åŒï¼Œè¦ä¹ˆéµå¾ªslf4jè§„èŒƒå¼€å‘ï¼Œè¦ä¹ˆä½¿ç”¨<strong>é€‚é…å™¨</strong>æ¥å®Œæˆslf-apiä¸å…·ä½“æ—¥å¿—å®ç°æ¡†æ¶çš„æ•´åˆã€‚</p><h1 id="SLF4jä½¿ç”¨">2 SLF4jä½¿ç”¨</h1><h2 id="mavenä¾èµ–">2.1 mavenä¾èµ–</h2><pre class=" language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- slf4jæ—¥å¿—é—¨é¢ --></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>slf4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7.30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- slf4jå†…ç½®çš„ç®€å•å®ç° --></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>slf4j-simple<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7.30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><h2 id="æ—¥å¿—ç»‘å®š">2.2 æ—¥å¿—ç»‘å®š</h2><p>SLF4Jä½¿ç”¨æŒ‡å®šçš„æ—¥å¿—æ¡†æ¶éœ€è¦é€šè¿‡â€œæ—¥å¿—ç»‘å®šâ€ï¼Œé€šè¿‡ä¸€äº›jaræ–‡ä»¶å®ç°ã€‚</p><p>ç»‘å®šå…·ä½“çš„æ—¥å¿—å®ç°æ¡†æ¶ï¼š</p><ol><li>ç»‘å®šå·²ç»å®ç°äº†sf4çš„æ—¥å¿—æ¡†æ¶ç›´æ¥æ·»åŠ å¯¹åº”ä¾èµ–</li><li>ç»‘å®šæ²¡æœ‰å®ç°sf4çš„æ—¥å¿—æ¡†æ¶å…ˆæ·»åŠ æ—¥å¿—çš„é€‚é…å™¨å†æ·»åŠ å®ç°ç±»çš„ä¾èµ–</li></ol><p>logbackã€slf4j-simpleéµå¾ªäº†slf4j-apiçš„å¼€å‘ï¼Œåªéœ€è¦å¯¼å…¥å¯¹åº”ä¾èµ–ã€‚</p><p>slf4j-nopæ˜¯å…³é—­æ—¥å¿—åŠŸèƒ½ã€‚</p><p>å¦‚æœç»‘å®šäº†å¤šä¸ªæ—¥å¿—å®ç°ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„æ—¥å¿—å®ç°ã€‚</p><p><img src="https://api.codetool.top/img/15837539283526.png" alt></p><p>ä¾‹ï¼šç»‘å®šlog4j</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>slf4j-log4j12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><h2 id="æ¡¥æ¥">2.3 æ¡¥æ¥</h2><p>slf4jçš„å¼ºå¤§ä¹‹å¤„è¿˜åœ¨äºå®ƒå¯¹é—ç•™ä»£ç çš„æ”¯æŒï¼Œå¦‚æœé¡¹ç›®ä¹‹å‰ä½¿ç”¨çš„æ˜¯ä¾‹å¦‚Log4jç­‰æ—¥å¿—æ¡†æ¶å®ç°ï¼Œå¯ä»¥é€šè¿‡slf4jæä¾›çš„â€œæ¡¥æ¥å™¨â€å°†å…¶è½¬ç§»è‡³slf4jä½¿ç”¨ã€‚ç”šè‡³è¿˜å¯ä»¥æ¡¥æ¥JCLã€‚</p><p><img src="https://api.codetool.top/img/15837554998133.png" alt></p><p>ä¾‹å¦‚ï¼šlog4jä»£ç é€šè¿‡æ¡¥æ¥å™¨è½¬ç§»è‡³logbackå®ç°ï¼Œé¦–å…ˆç§»é™¤log4jä¾èµ–ï¼Œç„¶åæ·»åŠ æ¡¥æ¥å™¨ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j-over-slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><p>è¿™é‡Œä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜æ¯”å¦‚<code>log4j-over-slf4j</code>ä¸<code>slf4j-log4j12</code>å…±å­˜å‡ºç°stack overflowï¼Œå°±æ˜¯å› ä¸ºslf4j&lt;-&gt;log4jæ­»å¾ªç¯</p><h2 id="ç‰¹æ€§">2.4 ç‰¹æ€§</h2><p><strong>æ ¸å¿ƒç±»ï¼š</strong></p><ul><li>Loggerï¼šæ—¥å¿—è®°å½•å™¨ï¼Œç”¨äºå†™æ—¥å¿—</li><li>LoggerFactoryï¼šæ—¥å¿—è®°å½•å™¨çš„å·¥å‚ç±»ï¼Œç”¨äºè·å–æ—¥å¿—è®°å½•å™¨ã€‚</li></ul><p><strong>æ—¥å¿—çº§åˆ«ï¼š</strong></p><ul><li>trace</li><li>debug</li><li>info</li><li>warn</li><li>error</li></ul><p>æ¯”JCLè¿˜å°‘ä¸€ä¸ªfatalçº§åˆ«ã€‚</p><p><strong>ä½¿ç”¨å ä½ç¬¦è¾“å‡ºæ—¥å¿—ä¿¡æ¯ï¼š</strong></p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Logger LOGGER <span class="token operator">=</span> LoggerFactory<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>SLF4JTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQuick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    String name <span class="token operator">=</span> <span class="token string">"rhett"</span><span class="token punctuation">;</span>    LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"åå­—ï¼š{}"</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p><strong>å°†ç³»ç»Ÿå¼‚å¸¸ä¿¡æ¯è¾“å‡ºï¼š</strong></p><p>Loggeræä¾›äº†å¸¦throwableå‚æ•°çš„æ–¹æ³•é‡è½½ï¼Œå¯ä»¥ä¾¿æ·åœ°è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Logger LOGGER <span class="token operator">=</span> LoggerFactory<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>SLF4JTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">try</span><span class="token punctuation">{</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>        LOGGER<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"å‡ºç°å¼‚å¸¸ï¼š"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h1 id="SLF4JåŸç†">3 SLF4JåŸç†</h1><p>è¿™ä¸ªé˜¶æ®µæ¨èè‡ªå·±è¿›è¡Œæºç è·Ÿè¸ªï¼Œæˆ‘å¤§æ¦‚æŠŠæ–¹æ³•æ ˆè´´ä¸€ä¸‹</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> Logger <span class="token function">getLogger</span><span class="token punctuation">(</span>Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>    Logger logger <span class="token operator">=</span> <span class="token function">getLogger</span><span class="token punctuation">(</span>clazz<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//!!!</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>DETECT_LOGGER_NAME_MISMATCH<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> autoComputedCallingClass <span class="token operator">=</span> Util<span class="token punctuation">.</span><span class="token function">getCallingClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>autoComputedCallingClass <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> <span class="token function">nonMatchingClasses</span><span class="token punctuation">(</span>clazz<span class="token punctuation">,</span> autoComputedCallingClass<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            Util<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Detected logger name mismatch. Given name: \"%s\"; computed name: \"%s\"."</span><span class="token punctuation">,</span> logger<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                            autoComputedCallingClass<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Util<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token string">"See "</span> <span class="token operator">+</span> LOGGER_NAME_MISMATCH_URL <span class="token operator">+</span> <span class="token string">" for an explanation"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> logger<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> Logger <span class="token function">getLogger</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>    ILoggerFactory iLoggerFactory <span class="token operator">=</span> <span class="token function">getILoggerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> iLoggerFactory<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> ILoggerFactory <span class="token function">getILoggerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>INITIALIZATION_STATE <span class="token operator">==</span> UNINITIALIZED<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>LoggerFactory<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>INITIALIZATION_STATE <span class="token operator">==</span> UNINITIALIZED<span class="token punctuation">)</span> <span class="token punctuation">{</span>                INITIALIZATION_STATE <span class="token operator">=</span> ONGOING_INITIALIZATION<span class="token punctuation">;</span>                <span class="token function">performInitialization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//é€šå¾€bindæ–¹æ³•</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>INITIALIZATION_STATE<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">case</span> SUCCESSFUL_INITIALIZATION<span class="token operator">:</span>        <span class="token keyword">return</span> StaticLoggerBinder<span class="token punctuation">.</span><span class="token function">getSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLoggerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> NOP_FALLBACK_INITIALIZATION<span class="token operator">:</span>        <span class="token keyword">return</span> NOP_FALLBACK_FACTORY<span class="token punctuation">;</span>    <span class="token keyword">case</span> FAILED_INITIALIZATION<span class="token operator">:</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>UNSUCCESSFUL_INIT_MSG<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> ONGOING_INITIALIZATION<span class="token operator">:</span>        <span class="token comment" spellcheck="true">// support re-entrant behavior.</span>        <span class="token comment" spellcheck="true">// See also http://jira.qos.ch/browse/SLF4J-97</span>        <span class="token keyword">return</span> SUBST_FACTORY<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"Unreachable code"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        Set<span class="token operator">&lt;</span>URL<span class="token operator">></span> staticLoggerBinderPathSet <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// skip check under android, see also</span>        <span class="token comment" spellcheck="true">// http://jira.qos.ch/browse/SLF4J-328</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isAndroid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            staticLoggerBinderPathSet <span class="token operator">=</span> <span class="token function">findPossibleStaticLoggerBinderPathSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//!!!</span>            <span class="token function">reportMultipleBindingAmbiguity</span><span class="token punctuation">(</span>staticLoggerBinderPathSet<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// the next line does the binding</span>        StaticLoggerBinder<span class="token punctuation">.</span><span class="token function">getSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        INITIALIZATION_STATE <span class="token operator">=</span> SUCCESSFUL_INITIALIZATION<span class="token punctuation">;</span>        <span class="token function">reportActualBinding</span><span class="token punctuation">(</span>staticLoggerBinderPathSet<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoClassDefFoundError</span> ncde<span class="token punctuation">)</span> <span class="token punctuation">{</span>        String msg <span class="token operator">=</span> ncde<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">messageContainsOrgSlf4jImplStaticLoggerBinder</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            INITIALIZATION_STATE <span class="token operator">=</span> NOP_FALLBACK_INITIALIZATION<span class="token punctuation">;</span>            Util<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token string">"Failed to load class \"org.slf4j.impl.StaticLoggerBinder\"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Util<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token string">"Defaulting to no-operation (NOP) logger implementation"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Util<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token string">"See "</span> <span class="token operator">+</span> NO_STATICLOGGERBINDER_URL <span class="token operator">+</span> <span class="token string">" for further details."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token function">failedBinding</span><span class="token punctuation">(</span>ncde<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">throw</span> ncde<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>NoSuchMethodError</span> nsme<span class="token punctuation">)</span> <span class="token punctuation">{</span>        String msg <span class="token operator">=</span> nsme<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>msg <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> msg<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"org.slf4j.impl.StaticLoggerBinder.getSingleton()"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            INITIALIZATION_STATE <span class="token operator">=</span> FAILED_INITIALIZATION<span class="token punctuation">;</span>            Util<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token string">"slf4j-api 1.6.x (or later) is incompatible with this binding."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Util<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token string">"Your binding is version 1.5.5 or earlier."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Util<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token string">"Upgrade your binding to version 1.6.x."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">throw</span> nsme<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">failedBinding</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"Unexpected initialization failure"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token function">postBindCleanUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token keyword">static</span> Set<span class="token operator">&lt;</span>URL<span class="token operator">></span> <span class="token function">findPossibleStaticLoggerBinderPathSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// use Set instead of list in order to deal with bug #138</span>    <span class="token comment" spellcheck="true">// LinkedHashSet appropriate here because it preserves insertion order</span>    <span class="token comment" spellcheck="true">// during iteration</span>    Set<span class="token operator">&lt;</span>URL<span class="token operator">></span> staticLoggerBinderPathSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token operator">&lt;</span>URL<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        ClassLoader loggerFactoryClassLoader <span class="token operator">=</span> LoggerFactory<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Enumeration<span class="token operator">&lt;</span>URL<span class="token operator">></span> paths<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>loggerFactoryClassLoader <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            paths <span class="token operator">=</span> ClassLoader<span class="token punctuation">.</span><span class="token function">getSystemResources</span><span class="token punctuation">(</span>STATIC_LOGGER_BINDER_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            paths <span class="token operator">=</span> loggerFactoryClassLoader<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>STATIC_LOGGER_BINDER_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>paths<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            URL path <span class="token operator">=</span> paths<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            staticLoggerBinderPathSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ioe<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Util<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token string">"Error getting resources from path"</span><span class="token punctuation">,</span> ioe<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> staticLoggerBinderPathSet<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> <span class="token keyword">static</span> String STATIC_LOGGER_BINDER_PATH <span class="token operator">=</span> <span class="token string">"org/slf4j/impl/StaticLoggerBinder.class"</span><span class="token punctuation">;</span></code></pre><p><strong>æ³¨æ„:</strong> è™½ç„¶<code>StaticLoggerBinder</code>æ˜¯åœ¨<code>org.slf4j.impl</code>åŒ…ä¸‹,ä½†æ—¥å¿—é—¨é¢jaråŒ…ä¸­å¹¶æ— æ­¤ç±»,æ­¤ç±»æ˜¯ç”±æ¡¥æ¥å™¨å®ç°çš„ã€‚</p><p>æ¡¥æ¥å™¨çš„åŸç†å…¶å®å°±æ˜¯åœ¨å…¶jaråŒ…ä¸­å­˜åœ¨StaticLoggerBinder.class,è¿™æ ·å°±å¯åœ¨è¿è¡Œæ—¶åŠ¨æ€ç»‘å®šåº•å±‚çš„æ—¥å¿—å®ç°æ¡†æ¶ã€‚</p><p>ç„¶åå›åˆ°bindæ–¹æ³•ï¼š</p><pre class=" language-java"><code class="language-java">StaticLoggerBinder<span class="token punctuation">.</span><span class="token function">getSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è·å–äº†ä¸€ä¸ª<code>StaticLoggerBinder</code>çš„å•ä¾‹å¯¹è±¡</p><p>ç„¶åè¿”å›getILoggerFactoryæ–¹æ³•ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">case</span> SUCCESSFUL_INITIALIZATION<span class="token operator">:</span>    <span class="token keyword">return</span> StaticLoggerBinder<span class="token punctuation">.</span><span class="token function">getSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLoggerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ€»ç»“ï¼šæ¡¥æ¥å™¨ä¼šè°ƒç”¨çš„æ—¥å¿—æ¡†æ¶å®ç°çš„ç›¸å…³ä»£ç ç”Ÿæˆå…¶å†…éƒ¨çš„Logger(æ­¤Loggerä¸org.slf4j.Logger)ä¸å…¼å®¹,å†é€šè¿‡é€‚é…å™¨åŒ…è£…æ—¥å¿—æ¡†æ¶å®ç°å†…éƒ¨çš„Logger.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;SLF4jæ¦‚è¿°&quot;&gt;1 SLF4jæ¦‚è¿°&lt;/h1&gt;&lt;p&gt;ä¸Šç¯‡æ–‡ç« å†™äº†&lt;a href=&quot;../æ—¥å¿—é—¨é¢ä»‹ç»å’ŒJCLä½¿ç”¨&quot;&gt;æ—¥å¿—é—¨é¢ä»‹ç»å’ŒJCLä½¿ç”¨&lt;/a&gt;ï¼Œä½œä¸ºä¸€ä¸ªæ›¾ç»çš„ä¸»æµæ—¥å¿—é—¨é¢æŠ€æœ¯ï¼ŒJCLç»ˆç©¶å› ä¸ºè®¾è®¡æ—¶çš„äº§ç”Ÿé—®é¢˜æ‰€é™ï¼Œå¯¼è‡´è‡³ä»Šå·²æ²¡ä»€ä¹ˆäººä½¿ç”¨ï¼Œè€Œä¸€æ¬¾ä¼˜ç§€çš„æ—¥å¿—é—¨é¢æŠ€
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="java" scheme="https://www.codetool.top/tags/java/"/>
    
      <category term="æ—¥å¿—" scheme="https://www.codetool.top/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>æ—¥å¿—é—¨é¢ä»‹ç»å’ŒJCLä½¿ç”¨</title>
    <link href="https://www.codetool.top/article/%E6%97%A5%E5%BF%97%E9%97%A8%E9%9D%A2%E4%BB%8B%E7%BB%8D%E5%92%8CJCL%E4%BD%BF%E7%94%A8/"/>
    <id>https://www.codetool.top/article/æ—¥å¿—é—¨é¢ä»‹ç»å’ŒJCLä½¿ç”¨/</id>
    <published>2020-03-09T09:45:50.000Z</published>
    <updated>2020-03-09T10:59:29.223Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ—¥å¿—é—¨é¢æ¦‚è¿°">1 æ—¥å¿—é—¨é¢æ¦‚è¿°</h1><p>ä¹‹å‰æœ‰å†™è¿‡<a href="../Javaæ—¥å¿—æ¡†æ¶JULå’ŒLog4jä»‹ç»/">Javaæ—¥å¿—æ¡†æ¶JULå’ŒLog4jä»‹ç»</a>ï¼Œå¯ä»¥å¯¹æ¯”å‘ç°å®ƒä»¬ä¹‹é—´çš„ä½¿ç”¨è¿˜æ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„ï¼Œæ¯”å¦‚æœ‰ä¸€äº›ç±»åæ˜¯ä¸åŒçš„ã€æ—¥å¿—çš„è¾“å‡ºçº§åˆ«ä¹Ÿä¸å®Œå…¨ä¸€è‡´ã€‚</p><p>é‚£ä¹ˆå®é™…ä¸Šæ˜¯å¢å¤§äº†æ—¥å¿—æ¡†æ¶ä¸ç¨‹åºçš„è€¦åˆæ€§ï¼Œä½¿å¾—éš¾ä»¥æ›´æ¢æ—¥å¿—æ¡†æ¶ã€‚<br>ç”šè‡³ä¼šé€ æˆä¸€äº›ä¼˜ç§€çš„æ¡†æ¶å¼ºåˆ¶æ€§ä¾èµ–æŸä¸€ä¸ªå…·ä½“çš„æ—¥å¿—å®ç°ç±»ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ—¥å¿—é—¨é¢æŠ€æœ¯å°±è¯ç”Ÿäº†ã€‚</p><p>æ—¥å¿—é—¨é¢å®è´¨ä¸Šå°±æ˜¯æä¾›äº†ä¸€å¥—é€šç”¨çš„æ—¥å¿—APIæŠ€æœ¯ï¼Œå’ŒJDBCçš„æ€æƒ³ç±»ä¼¼ï¼Œä½¿ç”¨æ—¥å¿—é—¨é¢ï¼Œå°±å¯ä»¥è½»æ¾åœ°æ›´æ¢æ—¥å¿—å®ç°ã€‚</p><p>æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ—¥å¿—é—¨é¢ï¼š</p><ol><li>é¢å‘æ¥å£å¼€å‘,ä¸å†ä¾èµ–å…·ä½“çš„å®ç°ç±»å‡å°‘ä»£ç çš„è€¦åˆ</li><li>é¡¹ç›®é€šè¿‡å¯¼å…¥ä¸åŒçš„æ—¥å¿—å®ç°ç±»,å¯ä»¥çµæ´»çš„åˆ‡æ¢æ—¥å¿—æ¡†æ¶</li><li>ç»Ÿä¸€API,æ–¹ä¾¿å¼€å‘è€…å­¦ä¹ å’Œä½¿ç”¨</li><li>ç»Ÿä¸€é…ç½®ä¾¿äºé¡¹ç›®æ—¥å¿—çš„ç®¡ç†</li></ol><p>å¸¸è§çš„æ—¥å¿—é—¨é¢ï¼šJCLã€slf4j</p><h1 id="JCL">2 JCL</h1><h2 id="JCLä»‹ç»">2.1 JCLä»‹ç»</h2><p>JCLå…¨ç§°ä¸º<code>Jakarta Commons Logging</code>ï¼Œæ˜¯ Apacheæä¾›çš„ä¸€ä¸ª<strong>é€šç”¨æ—¥å¿—API</strong></p><p>å®ƒæ˜¯ä¸ºâ€œæ‰€æœ‰çš„Javaæ—¥å¿—å®ç°â€æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£,å®ƒè‡ªèº«ä¹Ÿæä¾›ä¸€ä¸ªæ—¥å¿—çš„å®ç°,ä½†æ˜¯åŠŸèƒ½éå¸¸å¸¸å¼±<br>(SimpleLog)ã€‚æ‰€ä»¥ä¸€èˆ¬ä¸ä¼šå•ç‹¬ä½¿ç”¨å®ƒã€‚ä»–å…è®¸å¼€å‘äººå‘˜ä½¿ç”¨ä¸åŒçš„å…·ä½“æ—¥å¿—å®ç°å·¥å…·:Log4jã€jdkè‡ªå¸¦çš„æ—¥å¿—(JUL)ã€‚</p><h2 id="JCLä½¿ç”¨">2.2 JCLä½¿ç”¨</h2><p>mavenä¾èµ–ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>commons-logging<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>commons-logging<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><p>å¦‚æœè¦ä½¿ç”¨log4jè¿˜éœ€åŠ ä¸Šlog4jçš„ä¾èµ–</p><p>æ ¸å¿ƒç±»ï¼š</p><ul><li>Logï¼šæ—¥å¿—è®°å½•å™¨ï¼Œç”¨äºå†™æ—¥å¿—</li><li>LogFactoryï¼šæ—¥å¿—è®°å½•å™¨çš„å·¥å‚ç±»ï¼Œç”¨äºè·å–æ—¥å¿—è®°å½•å™¨ã€‚</li></ul><p>JCLçš„æ—¥å¿—çº§åˆ«ï¼š</p><ul><li>trace</li><li>debug</li><li>info</li><li>warn</li><li>error</li><li>fatal</li></ul><p>å¯ä»¥çœ‹å‡ºå’Œlog4jçš„æ—¥å¿—çº§åˆ«ä¸€è‡´ï¼Œä½†å®ƒæŠŠJULçš„æ—¥å¿—çº§åˆ«ä¹Ÿé€‚é…åˆ°äº†è¿™å¥—æ—¥å¿—çº§åˆ«ä¸Šã€‚</p><p>å¯¹äºé…ç½®æ–‡ä»¶ï¼Œå¦‚æœä½¿ç”¨JULå°±æ·»åŠ JULçš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœä½¿ç”¨log4jå°±æ·»åŠ Log4jçš„é…ç½®æ–‡ä»¶ã€‚</p><p>JCLé»˜è®¤ä¼šæ ¹æ®å¦‚ä¸‹é¡ºåºæŸ¥æ‰¾æ—¥å¿—çš„å®ç°ç±»ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> classesToDiscover <span class="token operator">=</span> <span class="token punctuation">{</span>        LOGGING_IMPL_LOG4J_LOGGER<span class="token punctuation">,</span>        <span class="token string">"org.apache.commons.logging.impl.Jdk14Logger"</span><span class="token punctuation">,</span>        <span class="token string">"org.apache.commons.logging.impl.Jdk13LumberjackLogger"</span><span class="token punctuation">,</span>        <span class="token string">"org.apache.commons.logging.impl.SimpleLog"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>classesToDiscover<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> result <span class="token operator">==</span> null<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>    result <span class="token operator">=</span> <span class="token function">createLogFromClass</span><span class="token punctuation">(</span>classesToDiscover<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> logCategory<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>å…¶ä¸­<code>LOGGING_IMPL_LOG4J_LOGGER</code>ä»£è¡¨çš„æ˜¯log4jçš„<code>org.apache.commons.logging.impl.Log4JLogger</code>ï¼Œå¯ä»¥çœ‹åˆ°JCLæ”¯æŒçš„æ—¥å¿—å®ç°æœ‰ï¼š</p><ul><li>log4j</li><li>jdk1.4çš„æ—¥å¿—ï¼ˆJULï¼‰</li><li>jdk1.3å‰çš„LumberjackLoggerï¼ˆå·²ç»æ·˜æ±°ï¼‰</li><li>JCLè‡ªå¸¦çš„SimpleLog</li></ul><p>å¦‚æœç”¨æˆ·ä¸æŒ‡å®šä½¿ç”¨å“ªä¸ªæ—¥å¿—å®ç°ç±»ï¼ŒJCLä¼šæŒ‰è¿™ä¸ªé¡ºåºæŸ¥æ‰¾ï¼Œä½¿ç”¨æœ€å…ˆæ‰¾åˆ°çš„å®ç°ç±»ã€‚</p><p>å¦‚æœéœ€è¦æŒ‡å®šï¼Œè¿˜éœ€è¦æ·»åŠ ä¸€ä¸ªé…ç½®æ–‡ä»¶<code>commons-logging.properties</code>åœ¨ç±»è·¯å¾„ä¸‹ï¼š</p><pre class=" language-properties"><code class="language-properties"><span class="token attr-name">org.apache.commons.logging.Log</span><span class="token punctuation">=</span><span class="token attr-value">org.apache.commons.logging.impl.SimpleLog</span></code></pre><p>æ­¤åå°±å¯ä»¥ä½¿ç”¨äº†ï¼š</p><pre class=" language-java"><code class="language-java">Log log <span class="token operator">=</span> LogFactory<span class="token punctuation">.</span><span class="token function">getLog</span><span class="token punctuation">(</span>JCLTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"hello JCL"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="JCLçš„é—®é¢˜">2.3 JCLçš„é—®é¢˜</h2><p>JCLçš„é—®é¢˜æ˜¯ï¼Œå½“åˆè®¾è®¡çš„æ—¶å€™åªè€ƒè™‘åˆ°äº†åœ¨å½“æ—¶æ¯”è¾ƒä¸»æµçš„æ—¥å¿—æ¡†æ¶log4jã€JULï¼Œä¹Ÿåªæ”¯æŒè¿™å‡ ä¸ªæ—¥å¿—æ¡†æ¶ï¼Œå¯¼è‡´åé¢å¦‚æœå‡ºç°äº†æ›´å¼ºå¤§çš„æ—¥å¿—æ¡†æ¶ï¼Œæ¯”å¦‚è¯´logbackå‡ºç°åï¼Œå¦‚æœéœ€è¦ä½¿ç”¨logbackï¼ŒJCLéœ€è¦é€šè¿‡ä¿®æ”¹ä»£ç çš„æ–¹å¼æ¥é€‚é…ï¼Œå½“ç„¶è¿™ä¼šé€ æˆå¾ˆå¤§çš„éº»çƒ¦ã€‚</p><p>JCLè·å–æ—¥å¿—å·¥å‚çš„è¿‡ç¨‹ä¸­ä½¿ç”¨äº†classLoaderæ¥å¯»æ‰¾æ—¥å¿—å·¥å‚å®ç°ï¼Œè¿›è€Œå¯¼è‡´äº†å…¶ä»–ç»„ä»¶ï¼Œå¦‚è‹¥ä½¿ç”¨è‡ªå·±çš„classloaderï¼Œåˆ™ä¸èƒ½è·å–å…·ä½“çš„æ—¥å¿—å·¥å‚å¯¹è±¡ï¼Œåˆ™å¯¼è‡´å¯åŠ¨å¤±è´¥ã€‚ï¼ˆå³æ— æ³•åŠ¨æ€æŸ¥æ‰¾ï¼‰</p><p>äºæ˜¯ä¸ä¹…commons-loggingå°±é€€å‡ºäº†äººä»¬çš„è§†çº¿ï¼Œæ›´å¥½çš„æ—¥å¿—é—¨é¢æŠ€æœ¯slf4jè¯ç”Ÿä»¥å–ä»£å®ƒçš„ä½ç½®ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æ—¥å¿—é—¨é¢æ¦‚è¿°&quot;&gt;1 æ—¥å¿—é—¨é¢æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;ä¹‹å‰æœ‰å†™è¿‡&lt;a href=&quot;../Javaæ—¥å¿—æ¡†æ¶JULå’ŒLog4jä»‹ç»/&quot;&gt;Javaæ—¥å¿—æ¡†æ¶JULå’ŒLog4jä»‹ç»&lt;/a&gt;ï¼Œå¯ä»¥å¯¹æ¯”å‘ç°å®ƒä»¬ä¹‹é—´çš„ä½¿ç”¨è¿˜æ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„ï¼Œæ¯”å¦‚æœ‰ä¸€äº›ç±»åæ˜¯ä¸åŒçš„ã€æ—¥å¿—çš„è¾“å‡ºçº§åˆ«ä¹Ÿä¸å®Œå…¨
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="java" scheme="https://www.codetool.top/tags/java/"/>
    
      <category term="æ—¥å¿—" scheme="https://www.codetool.top/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>leetcode121-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº</title>
    <link href="https://www.codetool.top/article/leetcode121-%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BA/"/>
    <id>https://www.codetool.top/article/leetcode121-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº/</id>
    <published>2020-03-08T16:12:45.000Z</published>
    <updated>2020-03-08T16:22:43.537Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸé¢˜">1 åŸé¢˜</h1><p>ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚</p><p>å¦‚æœä½ æœ€å¤šåªå…è®¸å®Œæˆä¸€ç¬”äº¤æ˜“ï¼ˆå³ä¹°å…¥å’Œå–å‡ºä¸€æ”¯è‚¡ç¥¨ï¼‰ï¼Œè®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚</p><p>æ³¨æ„ä½ ä¸èƒ½åœ¨ä¹°å…¥è‚¡ç¥¨å‰å–å‡ºè‚¡ç¥¨ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p><strong>è¾“å…¥:</strong> [7,1,5,3,6,4]<br><strong>è¾“å‡º:</strong> 5<br><strong>è§£é‡Š:</strong> åœ¨ç¬¬ 2 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 6ï¼‰çš„æ—¶å€™å–å‡ºï¼Œæœ€å¤§åˆ©æ¶¦ = 6-1 = 5 ã€‚<br>     æ³¨æ„åˆ©æ¶¦ä¸èƒ½æ˜¯ 7-1 = 6, å› ä¸ºå–å‡ºä»·æ ¼éœ€è¦å¤§äºä¹°å…¥ä»·æ ¼ã€‚  </p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p><strong>è¾“å…¥:</strong> [7,6,4,3,1]<br><strong>è¾“å‡º:</strong> 0<br><strong>è§£é‡Š:</strong> åœ¨è¿™ç§æƒ…å†µä¸‹, æ²¡æœ‰äº¤æ˜“å®Œæˆ, æ‰€ä»¥æœ€å¤§åˆ©æ¶¦ä¸º 0ã€‚  </p></blockquote><h1 id="è§£æ³•">2 è§£æ³•</h1><h2 id="æ€æƒ³">2.1 æ€æƒ³</h2><p>ä»å·¦å¾€å³è®°å½•æœ€ä½ç‚¹ï¼Œè®°å½•ä¸‹å½“å‰ä»·æ ¼ä¸æœ€ä½ç‚¹çš„å·®å€¼çš„æœ€å¤§å€¼ã€‚</p><h2 id="ä»£ç ">2.2 ä»£ç </h2><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxProfit</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prices<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> minprice <span class="token operator">=</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>        <span class="token keyword">int</span> maxprofit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> prices<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> minprice<span class="token punctuation">)</span>                minprice <span class="token operator">=</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> minprice <span class="token operator">></span> maxprofit<span class="token punctuation">)</span>                maxprofit <span class="token operator">=</span> prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> minprice<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> maxprofit<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åŸé¢˜&quot;&gt;1 åŸé¢˜&lt;/h1&gt;&lt;p&gt;ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æœ€å¤šåªå…è®¸å®Œæˆä¸€ç¬”äº¤æ˜“ï¼ˆå³ä¹°å…¥å’Œå–å‡ºä¸€æ”¯è‚¡ç¥¨ï¼‰ï¼Œè®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ä½ ä¸èƒ½åœ¨ä¹°å…¥è‚¡ç¥¨å‰å–å‡ºè‚¡ç¥¨ã€‚&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="leetcode" scheme="https://www.codetool.top/tags/leetcode/"/>
    
      <category term="ç®—æ³•" scheme="https://www.codetool.top/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootè‡ªåŠ¨é…ç½®åŸç†ä¸è‡ªå®šä¹‰é…ç½®ä»‹ç»</title>
    <link href="https://www.codetool.top/article/SpringBoot%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86%E4%B8%8E%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D/"/>
    <id>https://www.codetool.top/article/SpringBootè‡ªåŠ¨é…ç½®åŸç†ä¸è‡ªå®šä¹‰é…ç½®ä»‹ç»/</id>
    <published>2020-03-08T13:34:46.000Z</published>
    <updated>2020-03-08T13:36:31.395Z</updated>
    
    <content type="html"><![CDATA[<p>SpringBooté…ç½®ä¸è‡ªåŠ¨é…ç½®åŸç†</p><h1 id="è‡ªåŠ¨é…ç½®åŸç†">1 è‡ªåŠ¨é…ç½®åŸç†</h1><p>SpringBootå¯åŠ¨çš„æ—¶å€™åŠ è½½ä¸»é…ç½®ç±»ï¼Œå¼€å¯äº†è‡ªåŠ¨é…ç½®åŠŸèƒ½ <code>@EnableAutoConfiguration</code>ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span><span class="token annotation punctuation">@Documented</span><span class="token annotation punctuation">@Inherited</span><span class="token annotation punctuation">@SpringBootConfiguration</span> <span class="token annotation punctuation">@EnableAutoConfiguration</span> <span class="token comment" spellcheck="true">//!!!</span><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> FilterType<span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> TypeExcludeFilter<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> FilterType<span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> AutoConfigurationExcludeFilter<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">SpringBootApplication</span></code></pre><p><code>@EnableAutoConfiguration</code> çš„ä½œç”¨ï¼š</p><ul><li>åˆ©ç”¨<code>EnableAutoConfigurationImportSelector</code>ç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€äº›ç»„ä»¶</li></ul><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span><span class="token annotation punctuation">@Documented</span><span class="token annotation punctuation">@Inherited</span><span class="token annotation punctuation">@AutoConfigurationPackage</span><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span>AutoConfigurationImportSelector<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//!!!</span><span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">EnableAutoConfiguration</span></code></pre><ul><li>å¯ä»¥æŸ¥çœ‹<code>AutoConfigurationImportSelector.selectImports()</code>æ–¹æ³•çš„å†…å®¹ï¼›</li></ul><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">selectImports</span><span class="token punctuation">(</span>AnnotationMetadata annotationMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isEnabled</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> NO_IMPORTS<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    AutoConfigurationMetadata autoConfigurationMetadata <span class="token operator">=</span> AutoConfigurationMetadataLoader            <span class="token punctuation">.</span><span class="token function">loadMetadata</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>beanClassLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>    AutoConfigurationEntry autoConfigurationEntry <span class="token operator">=</span> <span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span>autoConfigurationMetadata<span class="token punctuation">,</span>            annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//!!!</span>    <span class="token keyword">return</span> StringUtils<span class="token punctuation">.</span><span class="token function">toStringArray</span><span class="token punctuation">(</span>autoConfigurationEntry<span class="token punctuation">.</span><span class="token function">getConfigurations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><ul><li><code>getAutoConfigurationEntry()</code>æ–¹æ³•ï¼š</li></ul><pre class=" language-java"><code class="language-java"><span class="token keyword">protected</span> AutoConfigurationEntry <span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span>AutoConfigurationMetadata autoConfigurationMetadata<span class="token punctuation">,</span>        AnnotationMetadata annotationMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isEnabled</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> EMPTY_ENTRY<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    AnnotationAttributes attributes <span class="token operator">=</span> <span class="token function">getAttributes</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>String<span class="token operator">></span> configurations <span class="token operator">=</span> <span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//!!!</span>    configurations <span class="token operator">=</span> <span class="token function">removeDuplicates</span><span class="token punctuation">(</span>configurations<span class="token punctuation">)</span><span class="token punctuation">;</span>    Set<span class="token operator">&lt;</span>String<span class="token operator">></span> exclusions <span class="token operator">=</span> <span class="token function">getExclusions</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">checkExcludedClasses</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>    configurations<span class="token punctuation">.</span><span class="token function">removeAll</span><span class="token punctuation">(</span>exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>    configurations <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> autoConfigurationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fireAutoConfigurationImportEvents</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AutoConfigurationEntry</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><ul><li><code>getCandidateConfigurations()</code>æ–¹æ³•ï¼š</li></ul><pre class=" language-java"><code class="language-java"><span class="token keyword">protected</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span>AnnotationMetadata metadata<span class="token punctuation">,</span> AnnotationAttributes attributes<span class="token punctuation">)</span> <span class="token punctuation">{</span>    List<span class="token operator">&lt;</span>String<span class="token operator">></span> configurations <span class="token operator">=</span> SpringFactoriesLoader<span class="token punctuation">.</span><span class="token function">loadFactoryNames</span><span class="token punctuation">(</span><span class="token function">getSpringFactoriesLoaderFactoryClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token function">getBeanClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Assert<span class="token punctuation">.</span><span class="token function">notEmpty</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> <span class="token string">"No auto configuration classes found in META-INF/spring.factories. If you "</span>            <span class="token operator">+</span> <span class="token string">"are using a custom packaging, make sure that file is correct."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> configurations<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ä»META-INFä¸‹é¢æ‰¾<code>spring.factories</code>æ–‡ä»¶ï¼Œå°†é‡Œé¢é…ç½®çš„æ‰€æœ‰EnableAutoConfigurationçš„å€¼åŠ å…¥åˆ°äº†å®¹å™¨ä¸­</p><p><img src="https://api.codetool.top/img/15836660223144.png" alt></p><p>æ¯ä¸€ä¸ªè¿™æ ·çš„<code>xxxAutoConfiguration</code>ç±»éƒ½æ˜¯å®¹å™¨ä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œéƒ½åŠ å…¥åˆ°å®¹å™¨ä¸­ï¼›ç”¨ä»–ä»¬æ¥åšè‡ªåŠ¨é…ç½®ã€‚</p><p>ä¾‹å¦‚ï¼šè‡ªåŠ¨é…ç½®ç±»<code>DispatcherServletAutoConfiguration</code></p><p>ï¼ˆèŠ‚é€‰å†…éƒ¨ç±»DispatcherServletConfigurationï¼‰</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//é…ç½®æ–‡ä»¶</span><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//é…ç½®æ¡ä»¶æ»¡è¶³ç±»DefaultDispatcherServletConditionçš„éªŒè¯</span><span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span>DefaultDispatcherServletCondition<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//å¦‚æœå­˜åœ¨ServletRegistrationç±»åˆ™è¿›è¡Œé…ç½®</span><span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span>ServletRegistration<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//å¦‚æœå­˜åœ¨å¯¹åº”çš„å±æ€§é…ç½®ï¼ˆWebMvcPropertieså¯¹åº”çš„æ˜¯spring.mvc.*ï¼‰åˆ™å¯ç”¨é…ç½®</span><span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token punctuation">{</span> HttpProperties<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> WebMvcProperties<span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">DispatcherServletConfiguration</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> DEFAULT_DISPATCHER_SERVLET_BEAN_NAME<span class="token punctuation">)</span>    <span class="token keyword">public</span> DispatcherServlet <span class="token function">dispatcherServlet</span><span class="token punctuation">(</span>HttpProperties httpProperties<span class="token punctuation">,</span> WebMvcProperties webMvcProperties<span class="token punctuation">)</span> <span class="token punctuation">{</span>        DispatcherServlet dispatcherServlet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DispatcherServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dispatcherServlet<span class="token punctuation">.</span><span class="token function">setDispatchOptionsRequest</span><span class="token punctuation">(</span>webMvcProperties<span class="token punctuation">.</span><span class="token function">isDispatchOptionsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dispatcherServlet<span class="token punctuation">.</span><span class="token function">setDispatchTraceRequest</span><span class="token punctuation">(</span>webMvcProperties<span class="token punctuation">.</span><span class="token function">isDispatchTraceRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dispatcherServlet<span class="token punctuation">.</span><span class="token function">setThrowExceptionIfNoHandlerFound</span><span class="token punctuation">(</span>webMvcProperties<span class="token punctuation">.</span><span class="token function">isThrowExceptionIfNoHandlerFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dispatcherServlet<span class="token punctuation">.</span><span class="token function">setPublishEvents</span><span class="token punctuation">(</span>webMvcProperties<span class="token punctuation">.</span><span class="token function">isPublishRequestHandledEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dispatcherServlet<span class="token punctuation">.</span><span class="token function">setEnableLoggingRequestDetails</span><span class="token punctuation">(</span>httpProperties<span class="token punctuation">.</span><span class="token function">isLogRequestDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> dispatcherServlet<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token comment" spellcheck="true">//å¦‚æœå­˜åœ¨ç±»å®šä¹‰åˆ™é…ç½®</span>    <span class="token annotation punctuation">@ConditionalOnBean</span><span class="token punctuation">(</span>MultipartResolver<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//åˆ¤æ–­å¦‚æœä¸å­˜åœ¨beanåç§°ä¸ºDispatcherServlet.MULTIPART_RESOLVER_BEAN_NAMEï¼Œåˆ™é…ç½® bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> DispatcherServlet<span class="token punctuation">.</span>MULTIPART_RESOLVER_BEAN_NAME<span class="token punctuation">)</span>    <span class="token keyword">public</span> MultipartResolver <span class="token function">multipartResolver</span><span class="token punctuation">(</span>MultipartResolver resolver<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// Detect if the user has created a MultipartResolver but named it incorrectly</span>        <span class="token keyword">return</span> resolver<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>é€šè¿‡ä¸Šé¢çš„ä»£ç ,å¯ä»¥çœ‹åˆ°Spring Bootå†…éƒ¨å·²ç»è‡ªåŠ¨ä¸ºæˆ‘ä»¬åšäº†å¾ˆå¤šå…³äºDispatcherServletçš„é…ç½®,å…¶ä¸­çš„<code>@EnableConfigurationProperties</code>è¿˜èƒ½å¤Ÿåœ¨è¯»å–é…ç½®å†…å®¹çš„æƒ…å†µä¸‹è‡ªåŠ¨ç”ŸæˆSpring MVCæ‰€éœ€çš„ç±»ã€‚åˆ°è¿™é‡Œ,åº”è¯¥æ˜ç™½ä¸ºä»€ä¹ˆå‡ ä¹åœ¨æ²¡æœ‰ä»»ä½•é…ç½®ä¸‹å°±èƒ½ç”¨Spring Bootå¯åŠ¨ Spring MVCé¡¹ç›®,è¿™äº›éƒ½æ˜¯<strong>Spring Booté€šè¿‡Mavenä¾èµ–æ‰¾åˆ°å¯¹åº”çš„jaråŒ…å’ŒåµŒå…¥çš„æœåŠ¡å™¨,ç„¶åä½¿ç”¨é»˜è®¤è‡ªåŠ¨é…ç½®ç±»æ¥åˆ›å»ºé»˜è®¤çš„å¼€å‘ç¯å¢ƒã€‚</strong>ä½†æ˜¯æœ‰æ—¶å€™,æˆ‘ä»¬éœ€è¦å¯¹è¿™äº›é»˜è®¤çš„ç¯å¢ƒè¿›è¡Œä¿®æ”¹ä»¥é€‚åº”ä¸ªæ€§åŒ–çš„è¦æ±‚,è¿™äº›åœ¨ Spring Bootä¸­ä¹Ÿæ˜¯éå¸¸ç®€å•çš„,æ­£å¦‚<code>@EnableConfigurationProperties</code>æ³¨è§£é‚£æ ·ï¼Œå®ƒå…è®¸è¯»å…¥é…ç½®æ–‡ä»¶çš„å†…å®¹æ¥è‡ªå®šä¹‰è‡ªåŠ¨åˆå§‹åŒ–æ‰€éœ€çš„å†…å®¹ã€‚</p><h1 id="Spring-Booté…ç½®æ–‡ä»¶">2 Spring Booté…ç½®æ–‡ä»¶</h1><p>Spring Bootçš„æ‰€æœ‰çš„AutoConfigurationå±æ€§é¡¹å¯ä»¥åœ¨ <a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#common-application-properties" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#common-application-properties</a> çœ‹åˆ°ã€‚è¿™ä¸€èŠ‚æˆ‘ä»¬ä¸»è¦ä»‹ç»è‡ªå®šä¹‰é…ç½®ã€‚</p><h2 id="yamlè¯­æ³•">2.1 yamlè¯­æ³•</h2><p>é…ç½®æ–‡ä»¶æ¨èä½¿ç”¨yamlè¯­æ³•æ¥å†™ï¼Œé€šè¿‡ç¼©è¿›æ¥è¡¨è¾¾æ•°æ®å…³ç³»ã€‚</p><h2 id="å­—ç¬¦ä¸²">2.2 å­—ç¬¦ä¸²</h2><p>å­—ç¬¦ä¸²â€‹å¯ä»¥ä¸åŠ å¼•å·ï¼Œå¦‚æœåŠ å¼•å·ï¼š</p><ul><li><code>&quot;&quot;</code>ï¼šåŒå¼•å·ï¼›ä¸ä¼šè½¬ä¹‰å­—ç¬¦ä¸²é‡Œé¢çš„ç‰¹æ®Šå­—ç¬¦ï¼›ç‰¹æ®Šå­—ç¬¦ä¼šä½œä¸ºæœ¬èº«æƒ³è¡¨ç¤ºçš„æ„æ€<ul><li><code>name: &quot;zhangsan \n lisi&quot;</code>ï¼š<code>\n</code>ä¼šè§£æä¸ºå›è½¦</li></ul></li><li><code>&#39;&#39;</code>ï¼šå•å¼•å·ï¼›ä¼šè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼Œç‰¹æ®Šå­—ç¬¦æœ€ç»ˆåªæ˜¯ä¸€ä¸ªæ™®é€šçš„å­—ç¬¦ä¸²æ•°æ®<ul><li><code>name: &#39;zhangsan \n lisi&#39;</code>ï¼š<code>\n</code>ä¸ä¼šè§£æä¸ºå›è½¦</li></ul></li></ul><h2 id="å¯¹è±¡ã€Map">2.3 å¯¹è±¡ã€Map</h2><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">friends</span><span class="token punctuation">:</span>    <span class="token key atrule">lastName</span><span class="token punctuation">:</span> zhangsan    <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">20</span></code></pre><p>è¡Œå†…å†™æ³•ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">friends</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">lastName</span><span class="token punctuation">:</span> zhangsan<span class="token punctuation">,</span><span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span></code></pre><h3 id="æ•°ç»„ï¼ˆListã€Setï¼‰">2.3.1 æ•°ç»„ï¼ˆListã€Setï¼‰</h3><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">pets</span><span class="token punctuation">:</span>    <span class="token punctuation">-</span> cat    <span class="token punctuation">-</span> dog    <span class="token punctuation">-</span> pig</code></pre><p>è¡Œå†…å†™æ³•ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">pets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>cat<span class="token punctuation">,</span>dog<span class="token punctuation">,</span>pig<span class="token punctuation">]</span></code></pre><h2 id="è‡ªå®šä¹‰å±æ€§é…ç½®">2.4 è‡ªå®šä¹‰å±æ€§é…ç½®</h2><p>å¯ä»¥åœ¨ç±»ä¸ŠåŠ ä¸Š<code>@ConfigurationProperties(prefix=&quot;&quot;)</code>æ³¨è§£ï¼ŒæŠŠæœ¬ç±»ä¸­æ‰€æœ‰å±æ€§å’Œé…ç½®æ–‡ä»¶ä¸­ç›¸å…³çš„é…ç½®è¿›è¡Œç»‘å®šã€‚</p><p>åªæœ‰è¿™ä¸ªç»„ä»¶æ˜¯å®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œæ‰èƒ½å®¹å™¨æä¾›çš„@ConfigurationPropertiesåŠŸèƒ½ã€‚</p><p>ä¾‹ï¼š</p><p>JavaBean</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"person"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String lastName<span class="token punctuation">;</span>    <span class="token keyword">private</span> Integer age<span class="token punctuation">;</span>    <span class="token keyword">private</span> Boolean boss<span class="token punctuation">;</span>    <span class="token keyword">private</span> Date birth<span class="token punctuation">;</span>    <span class="token keyword">private</span> Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span>Object<span class="token operator">></span> maps<span class="token punctuation">;</span>    <span class="token keyword">private</span> List<span class="token operator">&lt;</span>Object<span class="token operator">></span> lists<span class="token punctuation">;</span>    <span class="token keyword">private</span> Dog dog<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//getter and setter...</span><span class="token punctuation">}</span></code></pre><p>é…ç½®ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">person</span><span class="token punctuation">:</span>    <span class="token key atrule">lastName</span><span class="token punctuation">:</span> hello    <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">18</span>    <span class="token key atrule">boss</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>    <span class="token key atrule">birth</span><span class="token punctuation">:</span> 2000/01/01    <span class="token key atrule">maps</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">k1</span><span class="token punctuation">:</span> v1<span class="token punctuation">,</span><span class="token key atrule">k2</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">}</span>    <span class="token key atrule">lists</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> lisi      <span class="token punctuation">-</span> zhaoliu    <span class="token key atrule">dog</span><span class="token punctuation">:</span>      <span class="token key atrule">name</span><span class="token punctuation">:</span> å°ç‹—      <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">7</span></code></pre><p>å®ƒé»˜è®¤ä»å…¨å±€é…ç½®ä¸­è·å–å€¼ï¼Œå¯ä»¥ä½¿ç”¨<code>@PropertySource(value={})</code>æ¥æŒ‡å®šé…ç½®æ–‡ä»¶ã€‚</p><h2 id="é…ç½®æ–‡ä»¶å ä½ç¬¦">2.5 é…ç½®æ–‡ä»¶å ä½ç¬¦</h2><h3 id="éšæœºæ•°">2.5.1 éšæœºæ•°</h3><ul><li><code>${random.value}</code></li><li><code>${random.int}</code></li><li><code>${random.long}</code></li><li><code>${random.int(10)}</code></li><li><code>${random.int[1024,65536]}</code></li></ul><h3 id="å ä½ç¬¦è·å–ä¹‹å‰é…ç½®çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥æ˜¯ç”¨-æŒ‡å®šé»˜è®¤å€¼">2.5.2 å ä½ç¬¦è·å–ä¹‹å‰é…ç½®çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥æ˜¯ç”¨:æŒ‡å®šé»˜è®¤å€¼</h3><pre class=" language-properties"><code class="language-properties"><span class="token attr-name">person.last-name</span><span class="token punctuation">=</span><span class="token attr-value">å¼ ä¸‰${random.uuid}</span><span class="token attr-name">person.age</span><span class="token punctuation">=</span><span class="token attr-value">${random.int}</span><span class="token attr-name">person.birth</span><span class="token punctuation">=</span><span class="token attr-value">2017/12/15</span><span class="token attr-name">person.boss</span><span class="token punctuation">=</span><span class="token attr-value">false</span><span class="token attr-name">person.maps.k1</span><span class="token punctuation">=</span><span class="token attr-value">v1</span><span class="token attr-name">person.maps.k2</span><span class="token punctuation">=</span><span class="token attr-value">14</span><span class="token attr-name">person.lists</span><span class="token punctuation">=</span><span class="token attr-value">a,b,c</span><span class="token attr-name">person.dog.name</span><span class="token punctuation">=</span><span class="token attr-value">${person.hello:hello}_dog</span><span class="token attr-name">person.dog.age</span><span class="token punctuation">=</span><span class="token attr-value">15</span></code></pre><h2 id="é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®">2.6 é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®</h2><p>springboot å¯åŠ¨ä¼šæ‰«æä»¥ä¸‹ä½ç½®çš„application.propertiesæˆ–è€…application.ymlæ–‡ä»¶ä½œä¸ºSpring bootçš„é»˜è®¤é…ç½®æ–‡ä»¶</p><ul><li><code>file:./config/</code></li><li><code>file:./</code></li><li><code>classpath:/config/</code></li><li><code>classpath:/</code></li></ul><p>ä¼˜å…ˆçº§ç”±é«˜åˆ°åº•ï¼Œé«˜ä¼˜å…ˆçº§çš„é…ç½®ä¼šè¦†ç›–ä½ä¼˜å…ˆçº§çš„é…ç½®</p><p>SpringBootä¼šä»è¿™å››ä¸ªä½ç½®å…¨éƒ¨åŠ è½½ä¸»é…ç½®æ–‡ä»¶ï¼Œ<strong>äº’è¡¥é…ç½®</strong></p><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<code>spring.config.location</code>æ¥æ”¹å˜é»˜è®¤çš„é…ç½®æ–‡ä»¶ä½ç½®ã€‚</p><p><strong>é¡¹ç›®æ‰“åŒ…å¥½ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°çš„å½¢å¼ï¼Œå¯åŠ¨é¡¹ç›®çš„æ—¶å€™æ¥æŒ‡å®šé…ç½®æ–‡ä»¶çš„æ–°ä½ç½®ï¼›æŒ‡å®šé…ç½®æ–‡ä»¶å’Œé»˜è®¤åŠ è½½çš„è¿™äº›é…ç½®æ–‡ä»¶å…±åŒèµ·ä½œç”¨å½¢æˆäº’è¡¥é…ç½®ï¼›</strong></p><pre class=" language-shell"><code class="language-shell">java -jar spring-boot-02-config-02-0.0.1-SNAPSHOT.jar --spring.config.location=G:/application.properties</code></pre><p>SpringBootæ”¯æŒçš„æ‰€æœ‰çš„å¤–éƒ¨é…ç½®æ–‡ä»¶åŠ è½½æ–¹æ³•è§ï¼š</p><p><a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config</a></p><h2 id="ImportResourceæ³¨è§£">2.7 @ImportResourceæ³¨è§£</h2><p><code>@ImportResource</code>å¯ä»¥å¸®åŠ©å¯¼å…¥ä¼ ç»Ÿxmlç±»å‹çš„é…ç½®ï¼Œä¾‹å¦‚springcontexté…ç½®ï¼Œç›´æ¥å°†å®ƒå†™åœ¨å¯åŠ¨ç±»ä¸Šå°±è¡Œäº†ã€‚</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//å¯¼å…¥Springçš„é…ç½®æ–‡ä»¶è®©å…¶ç”Ÿæ•ˆ</span><span class="token annotation punctuation">@ImportResource</span><span class="token punctuation">(</span>locations <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"classpath:beans.xml"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BootHelloworldApplication</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        SpringApplication<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>BootHelloworldApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h2 id="å¤šç¯å¢ƒåŒ–é…ç½®Profile">2.8 å¤šç¯å¢ƒåŒ–é…ç½®Profile</h2><h3 id="properties">2.8.1 properties</h3><p>åœ¨çœŸå®çš„åº”ç”¨ä¸­ï¼Œå¸¸å¸¸ä¼šæœ‰å¤šä¸ªç¯å¢ƒï¼ˆå¦‚ï¼šå¼€å‘ï¼Œæµ‹è¯•ï¼Œç”Ÿäº§ç­‰ï¼‰ï¼Œä¸åŒçš„ç¯å¢ƒæ•°æ®åº“è¿æ¥éƒ½ä¸ä¸€æ ·ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°spring.profile.activeçš„å¼ºå¤§åŠŸèƒ½äº†ï¼Œå®ƒçš„æ ¼å¼ä¸º <code>application-{profile}.properties</code>ï¼Œè¿™é‡Œçš„ application ä¸ºå‰ç¼€ä¸èƒ½æ”¹ï¼Œ<code>{profile}</code>æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ã€‚</p><p>application.propertieså°±æ˜¯é»˜è®¤çš„é…ç½®æ–‡ä»¶ã€‚</p><p>åœ¨ <code>application.properties</code> é…ç½®æ–‡ä»¶ä¸­å†™å…¥ <code>spring.profiles.active=dev</code>ï¼Œå°±å¯ä»¥æŒ‡å®šä½¿ç”¨profileä¸ºdevçš„é…ç½®æ–‡ä»¶ã€‚</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨è™šæ‹Ÿæœºå‚æ•°<code>-Dspring.profiles.active=dev</code>æŒ‡å®š</p><h3 id="yamlæ–‡æ¡£å—">2.8.2 yamlæ–‡æ¡£å—</h3><pre class=" language-yaml"><code class="language-yaml"><span class="token comment" spellcheck="true"># document 1</span><span class="token key atrule">server</span><span class="token punctuation">:</span>  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8081</span><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">profiles</span><span class="token punctuation">:</span>    <span class="token key atrule">active</span><span class="token punctuation">:</span> prod<span class="token punctuation">---</span><span class="token comment" spellcheck="true"># document 2</span><span class="token key atrule">server</span><span class="token punctuation">:</span>  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8083</span><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">profiles</span><span class="token punctuation">:</span> dev<span class="token punctuation">---</span><span class="token comment" spellcheck="true"># document 3</span><span class="token key atrule">server</span><span class="token punctuation">:</span>  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8084</span><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">profiles</span><span class="token punctuation">:</span> prod  <span class="token comment" spellcheck="true">#æŒ‡å®šå±äºå“ªä¸ªç¯å¢ƒ</span></code></pre><p>æ–‡æ¡£å—ä¹‹é—´ä½¿ç”¨<code>---</code>åˆ†éš”ï¼Œç¬¬ä¸€ä¸ªæ–‡æ¡£å—ä¸ºé»˜è®¤ä½¿ç”¨çš„é…ç½®ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;SpringBooté…ç½®ä¸è‡ªåŠ¨é…ç½®åŸç†&lt;/p&gt;
&lt;h1 id=&quot;è‡ªåŠ¨é…ç½®åŸç†&quot;&gt;1 è‡ªåŠ¨é…ç½®åŸç†&lt;/h1&gt;&lt;p&gt;SpringBootå¯åŠ¨çš„æ—¶å€™åŠ è½½ä¸»é…ç½®ç±»ï¼Œå¼€å¯äº†è‡ªåŠ¨é…ç½®åŠŸèƒ½ &lt;code&gt;@EnableAutoConfiguration&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre c
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="SpringBoot" scheme="https://www.codetool.top/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>leetcode322-é›¶é’±å…‘æ¢</title>
    <link href="https://www.codetool.top/article/leetcode322-%E9%9B%B6%E9%92%B1%E5%85%91%E6%8D%A2/"/>
    <id>https://www.codetool.top/article/leetcode322-é›¶é’±å…‘æ¢/</id>
    <published>2020-03-08T09:53:09.000Z</published>
    <updated>2020-03-08T09:55:34.373Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸé¢˜">1 åŸé¢˜</h1><p>ç»™å®šä¸åŒé¢é¢çš„ç¡¬å¸ coins å’Œä¸€ä¸ªæ€»é‡‘é¢ amountã€‚ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—å¯ä»¥å‡‘æˆæ€»é‡‘é¢æ‰€éœ€çš„æœ€å°‘çš„ç¡¬å¸ä¸ªæ•°ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•ä¸€ç§ç¡¬å¸ç»„åˆèƒ½ç»„æˆæ€»é‡‘é¢ï¼Œè¿”å› <code>-1</code>ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p><strong>è¾“å…¥:</strong> coins = [1, 2, 5], amount = 11<br><strong>è¾“å‡º:</strong> 3<br><strong>è§£é‡Š:</strong> 11 = 5 + 5 + 1</p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p><strong>è¾“å…¥:</strong> coins = [1, 2, 5], amount = 11<br><strong>è¾“å‡º:</strong> 3<br><strong>è§£é‡Š:</strong> 11 = 5 + 5 + 1</p></blockquote><p><strong>è¯´æ˜:</strong></p><p>ä½ å¯ä»¥è®¤ä¸ºæ¯ç§ç¡¬å¸çš„æ•°é‡æ˜¯æ— é™çš„ã€‚</p><h1 id="è§£æ³•">2 è§£æ³•</h1><h2 id="æ€æƒ³">2.1 æ€æƒ³</h2><p>è¿™é“é¢˜å’Œ<a href="../leetcode279-å®Œå…¨å¹³æ–¹æ•°">leetcode279-å®Œå…¨å¹³æ–¹æ•°</a>ç±»ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨BFS+å‰ªæçš„æ–¹æ³•æ¥åšã€‚</p><h2 id="ä»£ç ">2.2 ä»£ç </h2><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> visited<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">coinChange</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coins<span class="token punctuation">,</span> <span class="token keyword">int</span> amount<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>amount <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        visited <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">boolean</span><span class="token punctuation">[</span>amount<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        Queue<span class="token operator">&lt;</span>Integer<span class="token operator">></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span>        queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> depth <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            Integer num <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>                depth<span class="token operator">++</span><span class="token punctuation">;</span>                queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>coins<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">int</span> left <span class="token operator">=</span> num<span class="token operator">-</span>coins<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>left <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>left <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>visited<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>                visited<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åŸé¢˜&quot;&gt;1 åŸé¢˜&lt;/h1&gt;&lt;p&gt;ç»™å®šä¸åŒé¢é¢çš„ç¡¬å¸ coins å’Œä¸€ä¸ªæ€»é‡‘é¢ amountã€‚ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—å¯ä»¥å‡‘æˆæ€»é‡‘é¢æ‰€éœ€çš„æœ€å°‘çš„ç¡¬å¸ä¸ªæ•°ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•ä¸€ç§ç¡¬å¸ç»„åˆèƒ½ç»„æˆæ€»é‡‘é¢ï¼Œè¿”å› &lt;code&gt;-1&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹ 1:
      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="æœç´¢æ ‘" scheme="https://www.codetool.top/tags/%E6%90%9C%E7%B4%A2%E6%A0%91/"/>
    
      <category term="leetcode" scheme="https://www.codetool.top/tags/leetcode/"/>
    
      <category term="ç®—æ³•" scheme="https://www.codetool.top/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootä»‹ç»å’ŒHelloWorldå…¥é—¨ç¨‹åº</title>
    <link href="https://www.codetool.top/article/SpringBoot%E4%BB%8B%E7%BB%8D%E5%92%8CHelloWorld%E5%85%A5%E9%97%A8%E7%A8%8B%E5%BA%8F/"/>
    <id>https://www.codetool.top/article/SpringBootä»‹ç»å’ŒHelloWorldå…¥é—¨ç¨‹åº/</id>
    <published>2020-03-08T08:47:27.000Z</published>
    <updated>2020-03-08T13:35:14.467Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Spring-Boot-ç®€ä»‹">1 Spring Boot ç®€ä»‹</h1><ul><li>ç®€åŒ–Springåº”ç”¨å¼€å‘çš„ä¸€ä¸ªæ¡†æ¶ï¼›</li><li>æ•´ä¸ªSpringæŠ€æœ¯æ ˆçš„ä¸€ä¸ªå¤§æ•´åˆï¼›</li><li>J2EEå¼€å‘çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼›</li></ul><p>Spring Bootç”¨æ¥ç®€åŒ–Springåº”ç”¨å¼€å‘ï¼Œçº¦å®šå¤§äºé…ç½®ï¼Œå»ç¹ä»ç®€ï¼Œjust runå°±èƒ½åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ï¼Œäº§å“çº§åˆ«çš„åº”ç”¨</p><h2 id="ä¼˜ç‚¹">1.1 ä¼˜ç‚¹</h2><ul><li>å¿«é€Ÿåˆ›å»ºç‹¬ç«‹è¿è¡Œçš„Springé¡¹ç›®ä»¥åŠä¸ä¸»æµæ¡†æ¶é›†æˆ</li><li>ä½¿ç”¨åµŒå…¥å¼çš„Servletå®¹å™¨ï¼Œåº”ç”¨æ— éœ€æ‰“æˆWARåŒ…</li><li>startersè‡ªåŠ¨ä¾èµ–ä¸ç‰ˆæœ¬æ§åˆ¶</li><li>å¤§é‡çš„è‡ªåŠ¨é…ç½®ï¼Œç®€åŒ–å¼€å‘ï¼Œä¹Ÿå¯ä¿®æ”¹é»˜è®¤å€¼</li><li>æ— éœ€é…ç½®XMLï¼Œæ— ä»£ç ç”Ÿæˆï¼Œå¼€ç®±å³ç”¨</li><li>å‡†ç”Ÿäº§ç¯å¢ƒçš„è¿è¡Œæ—¶åº”ç”¨ç›‘æ§</li><li>ä¸äº‘è®¡ç®—çš„å¤©ç„¶é›†æˆ</li></ul><h2 id="starteræ¦‚å¿µ">1.2 starteræ¦‚å¿µ</h2><p>Spring Boot Starteræ˜¯ä¸€ç»„è¢«ä¾èµ–ç¬¬ä¸‰æ–¹ç±»åº“çš„é›†åˆã€‚</p><p>å¦‚æœä½ è¦å¼€å‘ä¸€ä¸ªwebåº”ç”¨ç¨‹åºï¼Œå°±é€šè¿‡åŒ…ç®¡ç†å·¥å…·(å¦‚maven)å¼•å…¥<code>spring-boot-starter-web</code>å°±å¯ä»¥äº†ï¼Œè€Œä¸ç”¨åˆ†åˆ«å¼•å…¥ä¸‹é¢è¿™ä¹ˆå¤šä¾èµ–ç±»åº“ï¼Œspring-boot-starter-webä¸€æ¬¡æ€§å¸®ä½ å¼•å…¥ä¸‹é¢çš„è¿™äº›å¸¸ç”¨ç±»åº“ã€‚</p><ul><li>Spring â€” spring æ ¸å¿ƒ, beans, contextä¸Šä¸‹æ–‡, AOPé¢å‘åˆ‡é¢</li><li>Web MVC â€” Spring MVC</li><li>Jackson â€” JSONæ•°æ®çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</li><li>Validation â€” Hibernateå‚æ•°æ ¡éªŒåŠæ ¡éªŒAPI</li><li>åµŒå…¥å¼ Servlet Container â€” Tomcat</li><li>æ—¥å¿—æ¡†æ¶Logging â€” logback, slf4j</li></ul><p>Spring Boot é»˜è®¤æ”¯æŒçš„starterè§ <a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#using-boot-starter" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#using-boot-starter</a></p><h2 id="Spring-Boot-Starter-Parent">1.3 Spring Boot Starter Parent</h2><p>æ‰€æœ‰çš„Spring Booté¡¹ç›®é»˜è®¤ä½¿ç”¨spring-boot-starter-parentä½œä¸ºåº”ç”¨ç¨‹åºçš„çˆ¶é¡¹ç›®ã€‚</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.0.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span></code></pre><p>ç»§æ‰¿çˆ¶é¡¹ç›®çš„å¥½å¤„åœ¨äºï¼š ç»Ÿä¸€javaç‰ˆæœ¬é…ç½®å’Œå…¶ä»–çš„ä¸€äº›ä¾èµ–ç±»åº“çš„ç‰ˆæœ¬ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¼•å…¥çš„ç¬¬ä¸‰æ–¹ç±»åº“ä¸è¦åŠ ç‰ˆæœ¬å·ï¼Œçˆ¶é¡¹ç›®æ›¿ä½ ç®¡ç†ç‰ˆæœ¬ï¼Œè€Œä¸”æ˜¯ç»è¿‡å…¼å®¹æ€§æµ‹è¯•çš„ã€‚æ¯”ä½ è‡ªå·±éšä¾¿å¼•å…¥ä¸€ä¸ªç‰ˆæœ¬å…¼å®¹æ€§æ›´å¥½ã€‚</p><h2 id="Spring-Booté›†æˆç¬¬ä¸‰æ–¹ç±»åº“çš„æ­¥éª¤">1.4 Spring Booté›†æˆç¬¬ä¸‰æ–¹ç±»åº“çš„æ­¥éª¤</h2><ol><li>é€šè¿‡mavenå¼•å…¥springboot-XXXX-starter</li><li>ä¿®æ”¹ymalæˆ–propertieså…¨å±€ç»Ÿä¸€é…ç½®æ–‡ä»¶</li><li>åŠ å…¥ä¸€ä¸ªJava Configã€‚è¿™ä¸ªå±äºä¸ªæ€§åŒ–é…ç½®ï¼Œå¦‚æœä½¿ç”¨é€šç”¨é…ç½®ï¼Œè¿™ä¸€æ­¥ä¸éœ€è¦ã€‚</li></ol><h2 id="Spring-Boot2-xæ–°ç‰¹æ€§">1.5 Spring Boot2.xæ–°ç‰¹æ€§</h2><h3 id="åŸºç¡€ç¯å¢ƒå‡çº§">1.5.1 åŸºç¡€ç¯å¢ƒå‡çº§</h3><ul><li><p>æœ€ä½ JDK 8ï¼Œæ”¯æŒ JDK 9ï¼Œä¸å†æ”¯æŒ Java 6 å’Œ 7ã€‚Spring Boot 2.0 è¦æ±‚ Java 8 ä½œä¸ºæœ€ä½ç‰ˆæœ¬ï¼Œè®¸å¤šç°æœ‰çš„ API å·²æ›´æ–°ï¼Œä»¥åˆ©ç”¨ Java 8 çš„ç‰¹æ€§ã€‚<br>ä¾‹å¦‚ï¼Œæ¥å£ä¸Šçš„é»˜è®¤æ–¹æ³•ï¼Œå‡½æ•°å›è°ƒä»¥åŠæ–°çš„ APIï¼Œå¦‚ javax.timeã€‚</p></li><li><p>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ Java 7 æˆ–æ›´æ—©ç‰ˆæœ¬ï¼Œåˆ™åœ¨å¼€å‘ Spring Boot 2.0 åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œéœ€è¦å‡çº§ä½ çš„ JDKã€‚</p></li></ul><h3 id="ä¾èµ–ç»„ä»¶å‡çº§">1.5.2 ä¾èµ–ç»„ä»¶å‡çº§</h3><ul><li>Jetty 9.4ï¼ŒJetty æ˜¯ä¸€ä¸ªå¼€æºçš„ Servlet å®¹å™¨ï¼Œå®ƒä¸ºåŸºäº Java çš„ Web å†…å®¹ï¼Œä¾‹å¦‚ JSP å’Œ Servlet æä¾›è¿è¡Œç¯å¢ƒã€‚Jetty æ˜¯ä½¿ç”¨ Java è¯­è¨€ç¼–å†™çš„ï¼Œå®ƒçš„ API ä»¥ä¸€ç»„ JAR åŒ…çš„å½¢å¼å‘å¸ƒã€‚</li><li>Tomcat 8.5ï¼ŒApache Tomcat 8.5.x æ—¨åœ¨å–ä»£ 8.0.xï¼Œå®Œå…¨æ”¯æŒ Java 9ã€‚</li><li>Flyway 5ï¼ŒFlyway æ˜¯ç‹¬ç«‹äºæ•°æ®åº“çš„åº”ç”¨ã€ç®¡ç†å¹¶è·Ÿè¸ªæ•°æ®åº“å˜æ›´çš„æ•°æ®åº“ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚ç”¨é€šä¿—çš„è¯è®²ï¼ŒFlyway å¯ä»¥åƒ SVN ç®¡ç†ä¸åŒäººçš„ä»£ç é‚£æ ·ï¼Œç®¡ç†ä¸åŒäººçš„ SQL è„šæœ¬ï¼Œä»è€Œåšåˆ°æ•°æ®åº“åŒæ­¥ã€‚</li><li>Hibernate 5.2ï¼ŒHibernate æ˜¯ä¸€æ¬¾éå¸¸æµè¡Œçš„ ORM æ¡†æ¶ã€‚</li><li>Gradle 3.4ï¼ŒSpring Boot çš„ Gradle æ’ä»¶åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå·²è¢«é‡å†™ï¼Œæœ‰äº†é‡å¤§çš„æ”¹è¿›ã€‚</li><li>Thymeleaf 3.0ï¼ŒThymeleaf 3 ç›¸å¯¹äº Thymeleaf 2 æœ‰éå¸¸å¤§çš„æ€§èƒ½æå‡</li></ul><h3 id="é»˜è®¤è½¯ä»¶æ›¿æ¢">1.5.3 é»˜è®¤è½¯ä»¶æ›¿æ¢</h3><ul><li>é»˜è®¤æ•°æ®åº“è¿æ¥æ± å·²ä» Tomcat åˆ‡æ¢åˆ° HikariCPï¼ŒHikariCP æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ JDBC è¿æ¥æ± ï¼ŒHikari æ˜¯æ—¥è¯­â€œå…‰â€çš„æ„æ€ã€‚</li><li>Rediså®¢æˆ·ç«¯é»˜è®¤ä½¿ç”¨ Lettuceï¼Œæ›¿æ¢æ‰Jedisã€‚Lettuce æ˜¯ä¸€ä¸ªå¯ä¼¸ç¼©çš„çº¿ç¨‹å®‰å…¨çš„ Redis å®¢æˆ·ç«¯ï¼Œç”¨äºåŒæ­¥ã€å¼‚æ­¥å’Œååº”ä½¿ç”¨ã€‚å¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«åŒä¸€ä¸ª RedisConnectionï¼Œå®ƒåˆ©ç”¨ä¼˜ç§€ Netty NIO æ¡†æ¶æ¥é«˜æ•ˆåœ°ç®¡ç†å¤šä¸ªè¿æ¥ï¼Œæ”¯æŒå…ˆè¿›çš„ Redis åŠŸèƒ½ï¼Œå¦‚ Sentinelã€é›†ç¾¤ã€æµæ°´çº¿ã€è‡ªåŠ¨é‡æ–°è¿æ¥å’Œ Redis æ•°æ®æ¨¡å‹ã€‚</li></ul><h3 id="æ–°æŠ€æœ¯çš„å¼•å…¥">1.5.4 æ–°æŠ€æœ¯çš„å¼•å…¥</h3><ul><li>å“åº”å¼ç¼–ç¨‹WebFluxï¼Œé‡è¦çš„å˜é©</li><li>æ”¯æŒ <code>Quartz</code>,Spring Boot 1.0 å¹¶æ²¡æœ‰æä¾›å¯¹ Quartz çš„æ”¯æŒï¼Œä¹‹å‰å‡ºç°äº†å„ç§é›†æˆæ–¹æ¡ˆï¼ŒSpring Boot 2.0 ç»™å‡ºäº†æœ€ç®€å•çš„é›†æˆæ–¹å¼ã€‚</li><li>å¯¹Kotlin çš„æ”¯æŒ</li><li>JOOQ çš„æ”¯æŒ,JOOQ æ˜¯åŸºäº Java è®¿é—®å…³ç³»å‹æ•°æ®åº“çš„å·¥å…·åŒ…ã€‚JOOQ æ—¢å¸å–äº†ä¼ ç»Ÿ ORM æ“ä½œæ•°æ®çš„ç®€å•æ€§å’Œå®‰å…¨æ€§ï¼Œåˆä¿ç•™äº†åŸç”Ÿ SQL çš„çµæ´»æ€§ï¼Œå®ƒæ›´åƒæ˜¯ä»‹äº ORMS å’Œ JDBC çš„ä¸­é—´å±‚ã€‚</li></ul><h1 id="Spring-Boot-HelloWorld">2 Spring Boot HelloWorld</h1><p>ä½¿ç”¨Spring Bootæ¥åšä¸€ä¸ªHello Worldå…¥é—¨ç¨‹åºï¼š</p><p>1) åœ¨ideaä¸­åˆ›å»ºSpring Initializré¡¹ç›®</p><p><img src="https://api.codetool.top/img/15836538134655.png" alt></p><p>2) æ·»åŠ mavenä¾èµ–</p><p>Ideaä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬ç”Ÿæˆå¦‚ä¸‹pomæ–‡ä»¶ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.2.5.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/></span></span> <span class="token comment" spellcheck="true">&lt;!-- lookup parent from repository --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.rhett<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>boot-helloworld<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>boot-helloworld<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">></span></span>Demo project for Spring Boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.junit.vintage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>junit-vintage-engine<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span></code></pre><p>æ·»åŠ web-starterè¿›å»ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><p>å¯ä»¥ç§»é™¤ç›¸å…³mavenç®¡ç†çš„æ–‡ä»¶ï¼Œä½¿ç”¨ideaç®¡ç†ï¼š</p><p><img src="https://api.codetool.top/img/15836538608240.png" alt></p><p>resourcesæ–‡ä»¶å¤¹ä¸­ç›®å½•ç»“æ„</p><ul><li><code>static</code>ï¼šä¿å­˜æ‰€æœ‰çš„é™æ€èµ„æºï¼› js css  imagesï¼›</li><li><code>templates</code>ï¼šä¿å­˜æ‰€æœ‰çš„æ¨¡æ¿é¡µé¢ï¼›ï¼ˆSpring Booté»˜è®¤jaråŒ…ä½¿ç”¨åµŒå…¥å¼çš„Tomcatï¼Œé»˜è®¤ä¸æ”¯æŒJSPé¡µé¢ï¼‰ï¼›å¯ä»¥ä½¿ç”¨æ¨¡æ¿å¼•æ“ï¼ˆfreemarkerã€thymeleafï¼‰ï¼›</li><li><code>application.properties</code>ï¼šSpring Bootåº”ç”¨çš„é…ç½®æ–‡ä»¶ï¼›å¯ä»¥ä¿®æ”¹ä¸€äº›é»˜è®¤è®¾ç½®ï¼Œå¯ä»¥ä½¿ç”¨ymlè¯­æ³•è¿›è¡Œé…ç½®ã€‚</li></ul><p>3) æŸ¥çœ‹å¯åŠ¨ç±»</p><p>ideaé»˜è®¤ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†å¯åŠ¨ç±»ï¼š</p><p><img src="https://api.codetool.top/img/15836540733254.png" alt></p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** * @SpringBootApplicationæ¥æ ‡è®°ä¸€ä¸ªä¸»ç¨‹åºç±»ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªSpring Bootåº”ç”¨ */</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BootHelloworldApplication</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        SpringApplication<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>BootHelloworldApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>4) ç¼–å†™Controller</p><p>springbootåªä¼šæ‰«æå¯åŠ¨ç±»å½“å‰åŒ…å’Œä»¥ä¸‹çš„åŒ…ï¼Œåˆ›å»ºä»¥ä¸‹åŒ…å±‚æ¬¡ï¼Œç¼–å†™ä¸€ä¸ªHelloControllerï¼š</p><p><img src="https://api.codetool.top/img/15836542358252.png" alt></p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloController</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> String <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"hello world"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p><code>@RestController</code>ç›¸å½“äº<code>@ResponseBody</code>+<code>@Controller</code>ï¼Œè¿”å›çš„å†…å®¹ç›´æ¥å†™å…¥å“åº”ä½“ï¼Œä¸ä¼šè§£æåˆ°è§†å›¾ã€‚</p><p>5) å¯åŠ¨ç¨‹åº</p><p>è¿è¡Œå¯åŠ¨ç±»ä¸­çš„mainæ–¹æ³•ï¼Œç¨‹åºå°±å¯åŠ¨èµ·æ¥äº†ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥<code>localhost:8080/hello</code>æ¥è§‚å¯Ÿè¿è¡Œç»“æœï¼š</p><p><img src="https://api.codetool.top/img/1583654442364.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Spring-Boot-ç®€ä»‹&quot;&gt;1 Spring Boot ç®€ä»‹&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;ç®€åŒ–Springåº”ç”¨å¼€å‘çš„ä¸€ä¸ªæ¡†æ¶ï¼›&lt;/li&gt;
&lt;li&gt;æ•´ä¸ªSpringæŠ€æœ¯æ ˆçš„ä¸€ä¸ªå¤§æ•´åˆï¼›&lt;/li&gt;
&lt;li&gt;J2EEå¼€å‘çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="SpringBoot" scheme="https://www.codetool.top/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>MySQLä¹‹åˆ†åŒºè¡¨ä»‹ç»</title>
    <link href="https://www.codetool.top/article/MySQL%E4%B9%8B%E5%88%86%E5%8C%BA%E8%A1%A8%E4%BB%8B%E7%BB%8D/"/>
    <id>https://www.codetool.top/article/MySQLä¹‹åˆ†åŒºè¡¨ä»‹ç»/</id>
    <published>2020-03-07T14:10:45.000Z</published>
    <updated>2020-03-07T14:22:04.547Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡å¤§éƒ¨åˆ†å‚è€ƒè‡ªã€ŠMySQLæŠ€æœ¯å†…å¹•ï¼šInnoDBå­˜å‚¨å¼•æ“ã€‹</p><h1 id="æ¦‚è¿°">1 æ¦‚è¿°</h1><p>å¯¹äºInnoDBï¼Œåˆ†åŒºå°±æ˜¯æŠŠä¸€ä¸ªæ•°æ®è¡¨çš„ç‰©ç†å­˜å‚¨æ‹†åˆ†ä¸ºå¤šä¸ªibdæ–‡ä»¶ï¼ˆç›¸å½“äºç‹¬ç«‹è¡¨ç©ºé—´å†æ‹†åˆ†æˆäº†å¤šä¸ªè¡¨ç©ºé—´ï¼‰ã€‚åˆ†åŒºåçš„MyISAMï¼Œåˆ™æ˜¯æ¯ä¸ªåˆ†åŒºæœ‰ä¸€ä¸ªmyiæ–‡ä»¶ï¼ˆè¡¨çš„ç´¢å¼•ä¿¡æ¯ï¼‰å’Œä¸€ä¸ªmydæ–‡ä»¶ï¼ˆè¡¨çš„æ•°æ®ä¿¡æ¯ï¼‰ã€‚æ¯ä¸€ä¸ªåˆ†åŒºï¼Œåœ¨MySQLçœ‹æ¥éƒ½æ˜¯ä¸€å¼ ç‹¬ç«‹çš„è¡¨ã€‚</p><h1 id="åˆ†åŒºç±»å‹">2 åˆ†åŒºç±»å‹</h1><h2 id="æ°´å¹³åˆ†åŒº">2.1 æ°´å¹³åˆ†åŒº</h2><p>è¿™ç§å½¢å¼åˆ†åŒºæ˜¯å¯¹è¡¨çš„è¡Œè¿›è¡Œåˆ†åŒºï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼ä¸åŒåˆ†ç»„é‡Œé¢çš„ç‰©ç†åˆ—åˆ†å‰²çš„æ•°æ®é›†å¾—ä»¥ç»„åˆï¼Œä»è€Œè¿›è¡Œä¸ªä½“åˆ†å‰²ï¼ˆå•åˆ†åŒºï¼‰æˆ–é›†ä½“åˆ†å‰²ï¼ˆ1ä¸ªæˆ–å¤šä¸ªåˆ†åŒºï¼‰ã€‚æ‰€æœ‰åœ¨è¡¨ä¸­å®šä¹‰çš„åˆ—åœ¨æ¯ä¸ªæ•°æ®é›†ä¸­éƒ½èƒ½æ‰¾åˆ°ï¼Œæ‰€ä»¥è¡¨çš„ç‰¹æ€§ä¾ç„¶å¾—ä»¥ä¿æŒã€‚</p><h2 id="å‚ç›´åˆ†åŒº">2.2 å‚ç›´åˆ†åŒº</h2><p>è¿™ç§åˆ†åŒºæ–¹å¼ä¸€èˆ¬æ¥è¯´æ˜¯é€šè¿‡å¯¹è¡¨çš„å‚ç›´åˆ’åˆ†æ¥å‡å°‘ç›®æ ‡è¡¨çš„å®½åº¦ï¼Œä½¿æŸäº›ç‰¹å®šçš„åˆ—è¢«åˆ’åˆ†åˆ°ç‰¹å®šçš„åˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºéƒ½åŒ…å«äº†å…¶ä¸­çš„åˆ—æ‰€å¯¹åº”çš„è¡Œã€‚</p><p><strong>MySQLåœ¨5.1æ—¶æ·»åŠ äº†å¯¹æ°´å¹³åˆ†åŒºçš„æ”¯æŒã€‚å¹¶ä¸æ”¯æŒå‚ç›´åˆ†åŒºã€‚</strong></p><p>MySQLæ•°æ®åº“çš„åˆ†åŒºæ˜¯å±€éƒ¨åˆ†åŒºç´¢å¼•ï¼Œä¸€ä¸ªåˆ†åŒºä¸­æ—¢å­˜äº†æ•°æ®ï¼Œåˆæ”¾äº†ç´¢å¼•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>æ¯ä¸ªåŒºçš„èšé›†ç´¢å¼•å’Œéèšé›†ç´¢å¼•éƒ½æ”¾åœ¨å„è‡ªåŒºçš„</strong>ï¼ˆä¸åŒçš„ç‰©ç†æ–‡ä»¶ï¼‰ã€‚ç›®å‰MySQLæ•°æ®åº“è¿˜ä¸æ”¯æŒå…¨å±€åˆ†åŒºï¼ˆæ•°æ®å­˜æ”¾åœ¨å„ä¸ªåˆ†åŒºä¸­ï¼Œä½†æ˜¯æ‰€æœ‰æ•°æ®çš„ç´¢å¼•æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼‰ã€‚</p><h1 id="åˆ†åŒºç®—æ³•">3 åˆ†åŒºç®—æ³•</h1><p>å½“å‰MySQLæ”¯æŒä»¥ä¸‹å‡ ç§ç±»å‹çš„åˆ†åŒºï¼š</p><ul><li>RANGEåˆ†åŒºï¼šè¡Œæ•°æ®åŸºäºå±äºä¸€ä¸ªç»™å®šè¿ç»­åŒºé—´çš„åˆ—å€¼è¢«æ”¾å…¥åˆ†åŒºï¼ŒMySQL5.5å¼€å§‹æ”¯æŒã€‚</li><li>LISTåˆ†åŒºï¼šå’ŒRANGEç±»ä¼¼ï¼Œåªæ˜¯LISTåˆ†åŒºé¢å‘çš„æ˜¯ç¦»æ•£çš„å€¼ã€‚MySQL5.5å¼€å§‹æ”¯æŒã€‚</li><li>HASHåˆ†åŒºï¼šæ ¹æ®ç”¨æˆ·è‡ªå®šä¹‰çš„è¡¨è¾¾å¼çš„è¿”å›å€¼æ¥è¿›è¡Œåˆ†åŒºï¼Œè¿”å›å€¼ä¸èƒ½ä¸ºè´Ÿæ•°ã€‚</li><li>KEYåˆ†åŒºï¼šæ ¹æ®MySQLæ•°æ®åº“æä¾›çš„å“ˆå¸Œå‡½æ•°æ¥è¿›è¡Œåˆ†åŒºã€‚</li></ul><p>æ— è®ºå“ªç§ç±»å‹çš„åˆ†åŒºï¼Œå¦‚æœè¡¨ä¸­å­˜åœ¨ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ—¶ï¼Œåˆ†åŒºåˆ—ï¼ˆç”¨æ¥åˆ¤æ–­è¯¥åˆ†å¾€å“ªä¸ªåˆ†åŒºï¼‰å¿…é¡»æ˜¯å”¯ä¸€ç´¢å¼•çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ã€‚</p><h2 id="RANGEåˆ†åŒº">3.1 RANGEåˆ†åŒº</h2><p>ç¤ºä¾‹</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tbl_new<span class="token punctuation">(</span>    id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>    title <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> RANGE<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">(</span>    <span class="token keyword">PARTITION</span> t0 <span class="token keyword">VALUES</span> LESS THAN<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">PARTITION</span> t1 <span class="token keyword">VALUES</span> LESS THAN<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">PARTITION</span> t2 <span class="token keyword">VALUES</span> LESS THAN<span class="token punctuation">(</span>MAXVALUE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¿™ä¸ªè¡¨ä¼šæŠŠä»¥idåˆ—ä½œä¸ºåˆ†åŒºä¾æ®ï¼Œå½“idï¼š</p><ul><li>0~10 æ”¾åœ¨ t0</li><li>10~20 æ”¾åœ¨ t1</li><li>&gt;20 æ”¾åœ¨ t2</li></ul><p>å½“æ’å…¥ä¸€ä¸ªä¸åœ¨åˆ†åŒºèŒƒå›´å†…çš„å€¼çš„æ—¶å€™ï¼ŒMySQLä¼šæŠ¥å¼‚å¸¸ã€‚</p><h2 id="LISTåˆ†åŒº">3.2 LISTåˆ†åŒº</h2><p>ç¤ºä¾‹</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">user</span> <span class="token punctuation">(</span>    uid <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>    userName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    gender <span class="token keyword">tinyint</span><span class="token punctuation">)</span><span class="token keyword">partition</span> <span class="token keyword">by</span> list<span class="token punctuation">(</span>gender<span class="token punctuation">)</span> <span class="token punctuation">(</span>    <span class="token keyword">partition</span> male <span class="token keyword">values</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">partition</span> female <span class="token keyword">values</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">partition</span> unknown <span class="token keyword">values</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¿™ä¸ªè¡¨ä¼šæŠŠä»¥genderåˆ—ï¼ˆæ€§åˆ«ï¼‰ä½œä¸ºåˆ†åŒºä¾æ®ï¼Œå½“genderï¼š</p><ul><li>= 1 æ”¾åœ¨ male</li><li>= 2 æ”¾åœ¨ female</li><li>= 3 æ”¾åœ¨ unknown</li></ul><p>å½“æ’å…¥ä¸€ä¸ªä¸åœ¨åˆ†åŒºèŒƒå›´å†…çš„å€¼çš„æ—¶å€™ï¼ŒMySQLåŒæ ·ä¼šæŠ¥å¼‚å¸¸ã€‚</p><p>å½“ä¸€æ¡Insertè¯­å¥æ’å…¥å¤šä¸ªå€¼çš„æ—¶å€™ï¼Œè€Œå…¶ä¸­æœ‰ä¸€äº›å€¼æ˜¯åœ¨åˆ†åŒºèŒƒå›´å†…çš„ï¼ŒMyISAMå¼•æ“ä¼šæŠŠç¬¬ä¸€ä¸ªä¸æ»¡è¶³èŒƒå›´çš„æ•°æ®å‰é¢çš„æ•°æ®å…¨éƒ¨æ’å…¥ï¼Œè€Œåé¢çš„ä¸å¤„ç†ã€‚è€ŒInnoDBåˆ™æŠŠå®ƒå½“æˆä¸€ä¸ªäº‹åŠ¡ï¼Œéƒ½ä¸ä¼šå¤„ç†ã€‚</p><h2 id="HASHåˆ†åŒº">3.3 HASHåˆ†åŒº</h2><p>ç¤ºä¾‹ï¼š</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t_hash<span class="token punctuation">(</span>    <span class="token number">a</span> <span class="token keyword">INT</span><span class="token punctuation">,</span>    <span class="token number">b</span> <span class="token keyword">DATETIME</span><span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> <span class="token keyword">HASH</span><span class="token punctuation">(</span>YEAR<span class="token punctuation">(</span><span class="token number">b</span><span class="token punctuation">)</span><span class="token punctuation">)</span>PARTITIONS <span class="token number">4</span><span class="token punctuation">;</span></code></pre><p>ç”¨æˆ·ç»™æ•°æ®åº“æä¾›åˆ†åŒºçš„ä¾æ®ï¼Œ<code>YEAR(b)</code>ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œç„¶åéœ€è¦é€šè¿‡<code>PARTITIONS num</code>å‘ŠçŸ¥æ•°æ®åº“åˆ†åŒºçš„æ•°é‡ï¼Œç„¶åæ•°æ®åº“è‡ªåŠ¨æ ¹æ®<code>YEAR(b)</code>å°†æ•°æ®å‡åŒ€åˆ†åˆ°è¿™äº›åˆ†åŒºä¸­ã€‚å¦‚æœæ²¡æœ‰<code>PARTITIONS num</code>è¯­å¥ï¼Œåˆ†åŒºçš„æ•°é‡é»˜è®¤ä¸º1ã€‚</p><h2 id="KEYåˆ†åŒº">3.4 KEYåˆ†åŒº</h2><p>KEYåˆ†åŒºå’ŒHASHåˆ†åŒºç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºHASHåˆ†åŒºä½¿ç”¨ç”¨æˆ·å®šä¹‰çš„å‡½æ•°è¿›è¡Œåˆ†åŒºï¼ŒKEYåˆ†åŒºä½¿ç”¨MySQLæ•°æ®åº“æä¾›çš„å‡½æ•°è¿›è¡Œåˆ†åŒºã€‚å¯¹äºå¤§å¤šæ•°å­˜å‚¨å¼•æ“ï¼ŒMySQLæ•°æ®åº“ä½¿ç”¨å…¶å†…éƒ¨çš„å“ˆå¸Œå‡½æ•°ï¼Œè¿™äº›å‡½æ•°åŸºäºä¸PASSWORD()ä¸€æ ·çš„è¿ç®—æ³•åˆ™ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t_key<span class="token punctuation">(</span>    <span class="token number">a</span> <span class="token keyword">INT</span><span class="token punctuation">,</span>    <span class="token number">b</span> <span class="token keyword">DATETIME</span><span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token number">b</span><span class="token punctuation">)</span>PARTITIONS <span class="token number">4</span><span class="token punctuation">;</span></code></pre><h2 id="å…¶ä»–">3.5 å…¶ä»–</h2><p>COLUMNSåˆ†åŒºã€å­åˆ†åŒº</p><h1 id="åˆ†åŒºçš„åº”ç”¨åœºæ™¯">4 åˆ†åŒºçš„åº”ç”¨åœºæ™¯</h1><ol><li>è¡¨éå¸¸å¤§ä»¥è‡³äºæ— æ³•å…¨éƒ¨æ”¾åœ¨å†…å­˜ä¸­ï¼Œæˆ–è€…åªåœ¨è¡¨çš„æœ€åéƒ¨åˆ†æœ‰çƒ­ç‚¹æ•°æ®ï¼Œå…¶ä»–å‡ä¸ºå†å²æ•°æ®ï¼ˆå¯ä»¥å°†çƒ­ç‚¹æ•°æ®æå–å‡ºæ¥ï¼ŒåŠ å¿«çƒ­ç‚¹æ•°æ®çš„æŸ¥è¯¢ã€è®¿é—®æ•ˆç‡ï¼‰</li><li>åˆ†åŒºè¡¨çš„æ•°æ®æ›´å®¹æ˜“ç»´æŠ¤ã€‚ï¼ˆæ‰¹é‡åˆ é™¤æ•°æ®-&gt;æ¸…é™¤æ•´ä¸ªåˆ†åŒºï¼‰</li><li>åˆ†åŒºè¡¨çš„æ•°æ®å¯ä»¥åˆ†å¸ƒåœ¨ä¸åŒçš„ç‰©ç†è®¾å¤‡ä¸Šï¼Œä»è€Œé«˜æ•ˆåœ°åˆ©ç”¨å¤šä¸ªç¡¬ä»¶è®¾å¤‡</li><li>å¯ä»¥ä½¿ç”¨åˆ†åŒºè¡¨æ¥é¿å…æŸäº›ç‰¹æ®Šçš„ç“¶é¢ˆã€‚æ¯”å¦‚ InnoDB çš„å•ä¸ªç´¢å¼•çš„äº’æ–¥è®¿é—®ï¼Œext3 æ–‡ä»¶ç³»ç»Ÿçš„ inode é”ç«äº‰ã€‚</li><li>è¿˜å¯ä»¥å¤‡ä»½å’Œæ¢å¤ç‹¬ç«‹çš„åˆ†åŒº</li></ol><h1 id="åˆ†åŒºçš„é™åˆ¶">5 åˆ†åŒºçš„é™åˆ¶</h1><ol><li>ä¸€ä¸ªè¡¨æœ€å¤šåªèƒ½æœ‰ 1024 ä¸ªåˆ†åŒº</li><li>å¦‚æœè¡¨ä¸­å­˜åœ¨ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ—¶ï¼Œåˆ†åŒºåˆ—å¿…é¡»æ˜¯å”¯ä¸€ç´¢å¼•çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ã€‚</li><li>åˆ†åŒºè¡¨ä¸­æ— æ³•ä½¿ç”¨å¤–é”®ç´¢å¼•</li></ol><h1 id="åˆ†åŒºçš„é™·é˜±">6 åˆ†åŒºçš„é™·é˜±</h1><h2 id="NULLå€¼ä¼šä½¿åˆ†åŒºè¿‡æ»¤æ— æ•ˆ">6.1 NULLå€¼ä¼šä½¿åˆ†åŒºè¿‡æ»¤æ— æ•ˆ</h2><p>åˆ†åŒºçš„è¡¨è¾¾å¼çš„å€¼å¯ä»¥æ˜¯ NULLï¼›ç¬¬ä¸€ä¸ªåˆ†åŒºæ˜¯ä¸€ä¸ªç‰¹æ®Šåˆ†åŒºï¼Œå¦‚æœè¡¨è¾¾å¼çš„å€¼ä¸º NULL æˆ–éæ³•å€¼ï¼Œè®°å½•éƒ½ä¼šè¢«å­˜æ”¾åˆ°ç¬¬ä¸€ä¸ªåˆ†åŒºã€‚WHERE æŸ¥è¯¢æ—¶å³ä½¿çœ‹èµ·æ¥å¯ä»¥è¿‡æ»¤åˆ°åªæœ‰ä¸€ä¸ªåˆ†åŒºï¼Œä½†å®é™…ä¼šæ£€æŸ¥ä¸¤ä¸ªåˆ†åŒºï¼Œå³ç¬¬ä¸€ä¸ªåˆ†åŒºã€‚æœ€å¥½æ˜¯è®¾ç½®åˆ†åŒºçš„åˆ—ä¸ºNOT NULLã€‚</p><h2 id="åˆ†åŒºåˆ—å’Œç´¢å¼•åˆ—ä¸åŒ¹é…">6.2 åˆ†åŒºåˆ—å’Œç´¢å¼•åˆ—ä¸åŒ¹é…</h2><p>å¦‚æœå®šä¹‰çš„ç´¢å¼•åˆ—å’Œåˆ†åŒºåˆ—ä¸åŒ¹é…ï¼Œä¼šå¯¼è‡´ç´¢å¼•æ— æ³•è¿›è¡Œåˆ†åŒºè¿‡æ»¤ã€‚</p><p>å‡è®¾åœ¨åˆ— a ä¸Šå®šä¹‰äº†ç´¢å¼•ï¼Œè€Œåœ¨åˆ— b ä¸Šè¿›è¡Œåˆ†åŒºã€‚å› ä¸ºæ¯ä¸ªåˆ†åŒºéƒ½æœ‰å…¶ç‹¬ç«‹çš„ç´¢å¼•ï¼Œæ‰€ä»¥æ‰«æ b ä¸Šçš„ç´¢å¼•å°±éœ€è¦æ‰«ææ¯ä¸€ä¸ªåˆ†åŒºå†…å¯¹åº”çš„ç´¢å¼•ã€‚</p><h2 id="é€‰æ‹©åˆ†åŒºçš„æˆæœ¬å¯èƒ½å¾ˆé«˜">6.3 é€‰æ‹©åˆ†åŒºçš„æˆæœ¬å¯èƒ½å¾ˆé«˜</h2><p>å°¤å…¶æ˜¯èŒƒå›´åˆ†åŒºï¼Œå¯¹äºå›ç­”â€œè¿™ä¸€è¡Œå±äºå“ªä¸ªåˆ†åŒºâ€ã€â€œè¿™äº›ç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„è¡Œåœ¨å“ªäº›åˆ†åŒºâ€è¿™æ ·çš„é—®é¢˜çš„æˆæœ¬å¯èƒ½ä¼šéå¸¸é«˜ã€‚å…¶ä»–çš„åˆ†åŒºç±»å‹ï¼Œæ¯”å¦‚KEYåˆ†åŒºå’ŒHASHåˆ†åŒºï¼Œå°±æ²¡æœ‰è¿™æ ·çš„é—®é¢˜ã€‚åœ¨æ‰¹é‡æ’å…¥æ—¶é—®é¢˜å°¤å…¶ä¸¥é‡ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ¬æ–‡å¤§éƒ¨åˆ†å‚è€ƒè‡ªã€ŠMySQLæŠ€æœ¯å†…å¹•ï¼šInnoDBå­˜å‚¨å¼•æ“ã€‹&lt;/p&gt;
&lt;h1 id=&quot;æ¦‚è¿°&quot;&gt;1 æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;å¯¹äºInnoDBï¼Œåˆ†åŒºå°±æ˜¯æŠŠä¸€ä¸ªæ•°æ®è¡¨çš„ç‰©ç†å­˜å‚¨æ‹†åˆ†ä¸ºå¤šä¸ªibdæ–‡ä»¶ï¼ˆç›¸å½“äºç‹¬ç«‹è¡¨ç©ºé—´å†æ‹†åˆ†æˆäº†å¤šä¸ªè¡¨ç©ºé—´ï¼‰ã€‚åˆ†åŒºåçš„MyISAMï¼Œåˆ™æ˜¯æ¯ä¸ªåˆ†åŒºæœ‰ä¸€ä¸ªmyi
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="ä¼˜åŒ–" scheme="https://www.codetool.top/tags/%E4%BC%98%E5%8C%96/"/>
    
      <category term="æ•°æ®åº“" scheme="https://www.codetool.top/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="MySQL" scheme="https://www.codetool.top/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQLä¸»ä»å¤åˆ¶ç®€ä»‹</title>
    <link href="https://www.codetool.top/article/MySQL%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E7%AE%80%E4%BB%8B/"/>
    <id>https://www.codetool.top/article/MySQLä¸»ä»å¤åˆ¶ç®€ä»‹/</id>
    <published>2020-03-07T11:30:48.000Z</published>
    <updated>2020-03-07T11:34:26.870Z</updated>
    
    <content type="html"><![CDATA[<p>è¯¥æ–‡ä¸è°ˆåŠè‰¯å¥½çš„ä¸»ä»å¤åˆ¶æ‹“æ‰‘ç»“æ„å’Œä¸»ä»å¤åˆ¶ä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼Œä»¥åæœ‰æ—¶é—´å†å†™ã€‚</p><h1 id="æ¦‚è¿°">1 æ¦‚è¿°</h1><p>å¤åˆ¶è§£å†³çš„åŸºæœ¬é—®é¢˜æ˜¯è®©ä¸€å°æœåŠ¡å™¨çš„æ•°æ®ä¸å…¶ä»–æœåŠ¡å™¨ä¿æŒåŒæ­¥ã€‚ä¸€å°ä¸»åº“çš„æ•°æ®å¯ä»¥åŒæ­¥åˆ°å¤šå°å¤‡åº“ä¸Šï¼Œå¤‡åº“æœ¬èº«ä¹Ÿå¯ä»¥è¢«é…ç½®æˆå¦å¤–ä¸€å°æœåŠ¡å™¨çš„ä¸»åº“ã€‚</p><p>MySQL æ”¯æŒä¸¤ç§å¤åˆ¶æ–¹å¼ï¼šåŸºäºè¡Œçš„å¤åˆ¶å’ŒåŸºäºè¯­å¥çš„å¤åˆ¶ã€‚è¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯é€šè¿‡åœ¨ä¸»åº“ä¸Šè®°å½• binlogï¼Œåœ¨å¤‡åº“é‡æ”¾æ—¥å¿—çš„æ–¹å¼æ¥å®ç°å¼‚æ­¥çš„æ•°æ®å¤åˆ¶ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨åŒä¸€æ—¶é—´ç‚¹å¤‡åº“ä¸Šçš„æ•°æ®å¯èƒ½ä¸ä¸»åº“å­˜åœ¨ä¸ä¸€è‡´ï¼Œå¹¶ä¸”ä¿è¯ä¸»å¤‡ä¹‹é—´çš„å»¶è¿Ÿã€‚</p><p>å¤åˆ¶é€šå¸¸ä¸ä¼šå¢åŠ ä¸»åº“çš„å¼€é”€ï¼Œä¸»è¦æ˜¯å¯ç”¨ binlog å¸¦æ¥çš„å¼€é”€ï¼Œä½†å‡ºäºå¤‡ä»½æˆ–åŠæ—¶ä»å´©æºƒä¸­æ¢å¤çš„ç›®çš„ï¼Œè¿™ç‚¹å¼€é”€ä¹Ÿæ˜¯å¿…è¦çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸ªå¤‡åº“ä¹Ÿä¼šå¯¹ä¸»åº“å¢åŠ ä¸€äº›è´Ÿè½½ï¼ˆç½‘ç»œIOï¼‰ï¼Œå°¤å…¶å½“å¤‡åº“è¯·æ±‚ä»ä¸»åº“è¯»å–æ—§çš„ binlog æ—¶ï¼Œå¯èƒ½ä¼šé€ æˆæ›´é«˜çš„ IO å¼€é”€ã€‚</p><p>é€šè¿‡å¤åˆ¶å¯ä»¥å°†è¯»æ“ä½œæŒ‡å‘å¤‡åº“æ¥è·å¾—æ›´å¥½çš„è¯»æ‰©å±•ï¼Œä½†å¯¹äºå†™æ“ä½œï¼Œé™¤éè®¾è®¡å¾—å½“ï¼Œå¦åˆ™å¹¶ä¸é€‚åˆé€šè¿‡å¤åˆ¶æ¥æ‰©å±•å†™æ“ä½œã€‚</p><h2 id="å¤åˆ¶è§£å†³çš„é—®é¢˜">1.1 å¤åˆ¶è§£å†³çš„é—®é¢˜</h2><ul><li>æ•°æ®åˆ†å¸ƒ</li><li>è´Ÿè½½å‡è¡¡ï¼Œè¯»å†™åˆ†ç¦»</li><li>å¤‡ä»½</li><li>é«˜å¯ç”¨å’Œæ•…éšœåˆ‡æ¢</li></ul><h1 id="å¤åˆ¶åŸç†">2 å¤åˆ¶åŸç†</h1><h2 id="å¤åˆ¶å¦‚ä½•å·¥ä½œ">2.1 å¤åˆ¶å¦‚ä½•å·¥ä½œ</h2><p><img src="https://api.codetool.top/img/15835759827402.png" alt></p><ol><li>åœ¨ä¸»åº“ä¸ŠæŠŠæ•°æ®æ›´æ”¹è®°å½•åœ¨ <code>binlog</code> ä¸­ï¼ˆè¿™äº›è®°å½•ç§°ä¸ºäºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶ï¼‰</li><li>å¤‡åº“å°†ä¸»åº“ä¸Šçš„æ—¥å¿—<strong>å¤åˆ¶åˆ°è‡ªå·±çš„ä¸­ç»§æ—¥å¿—ä¸­</strong></li><li>å¤‡åº“è¯»å–ä¸­ç»§æ—¥å¿—ä¸­çš„äº‹ä»¶ï¼Œå°†å…¶é‡æ”¾åˆ°å¤‡åº“æ•°æ®ä¹‹ä¸Š</li></ol><h2 id="åŸºäºè¯­å¥çš„å¤åˆ¶">2.2 åŸºäºè¯­å¥çš„å¤åˆ¶</h2><p>ä¸»åº“ä¼šè®°å½•é‚£äº›é€ æˆæ•°æ®æ›´æ”¹çš„æŸ¥è¯¢ï¼Œå½“å¤‡åº“è¯»å–å¹¶é‡æ”¾è¿™äº›äº‹ä»¶æ—¶ï¼Œå®é™…ä¸Šåªæ˜¯<strong>æŠŠä¸»åº“ä¸Šæ‰§è¡Œè¿‡çš„ SQL å†æ‰§è¡Œä¸€éã€‚</strong> å³binlogçš„statementæ¨¡å¼</p><p>ä¼˜ç‚¹ï¼š</p><ol><li>å®ç°ç®€å• </li><li>binlog ä¸­çš„äº‹ä»¶æ›´åŠ ç´§å‡‘</li></ol><p>é—®é¢˜ï¼š</p><ol><li>åŒä¸€æ¡ SQL åœ¨ä¸»åº“å’Œå¤‡åº“ä¸Šæ‰§è¡Œçš„æ—¶é—´å¯èƒ½ç¨å¾®æˆ–å¾ˆä¸ç›¸åŒï¼Œå› æ­¤åœ¨ä¼ è¾“çš„ binlog ä¸­ï¼Œ<br>é™¤äº† SQLï¼Œè¿˜æœ‰ä¸€äº›å…ƒæ•°æ®ï¼Œæ¯”å¦‚æ—¶é—´æˆ³</li><li>ä¸€äº›æ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„ SQLï¼Œå­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨</li><li>æ›´æ–°å¿…é¡»æ˜¯ä¸²è¡Œçš„ï¼Œè¿™éœ€è¦æ›´å¤šçš„é”</li></ol><h2 id="åŸºäºè¡Œçš„å¤åˆ¶">2.3 åŸºäºè¡Œçš„å¤åˆ¶</h2><p>ä¼šå°†å®é™…æ•°æ®è®°å½•åœ¨ binlog ä¸­ã€‚å³binlogçš„rowæ¨¡å¼</p><p>å¥½å¤„ï¼š</p><ol><li>å¯ä»¥æ­£ç¡®åœ°å¤åˆ¶æ¯ä¸€è¡Œï¼Œä¸€äº›è¯­å¥å¯ä»¥è¢«æ›´åŠ æœ‰æ•ˆåœ°å¤åˆ¶</li><li>å¤åˆ¶æ›´åŠ é«˜æ•ˆï¼ˆä½†ä¹Ÿè§†æƒ…å†µè€Œå®šï¼‰</li></ol><h1 id="æ­å»ºæ­¥éª¤">3 æ­å»ºæ­¥éª¤</h1><h2 id="master">3.1 master</h2><ol><li>åœ¨masterçš„é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®å¦‚ä¸‹å†…å®¹ï¼š</li></ol><pre class=" language-conf"><code class="language-conf">#mysql æœåŠ¡ID,ä¿è¯æ•´ä¸ªé›†ç¾¤ç¯å¢ƒä¸­å”¯ä¸€server-id=1#mysql binlog æ—¥å¿—çš„å­˜å‚¨è·¯å¾„å’Œæ–‡ä»¶åï¼Œä¸»ä»å¤åˆ¶æ˜¯åŸºäºbinlogçš„log-bin=/var/lib/mysql/mysqlbin#é”™è¯¯æ—¥å¿—,é»˜è®¤å·²ç»å¼€å¯#log-err#mysqlçš„å®‰è£…ç›®å½•#basedir#mysqlçš„ä¸´æ—¶ç›®å½•#tmpdir#mysqlçš„æ•°æ®å­˜æ”¾ç›®å½•#datadir#æ˜¯å¦åªè¯»,1 ä»£è¡¨åªè¯», 0 ä»£è¡¨è¯»å†™read-only=0#å¿½ç•¥çš„æ•°æ®, æŒ‡ä¸éœ€è¦åŒæ­¥çš„æ•°æ®åº“binlog-ignore-db=mysql#æŒ‡å®šåŒæ­¥çš„æ•°æ®åº“#binlog-do-db=db01</code></pre><ol start="2"><li>åœ¨å®¢æˆ·ç«¯ä¸­å»ºåŒæ­¥æ•°æ®çš„è´¦æˆ·ï¼Œå¹¶ä¸”è¿›è¡Œæˆæƒæ“ä½œï¼š</li></ol><pre class=" language-sql"><code class="language-sql"><span class="token keyword">grant</span> <span class="token keyword">replication</span> slave <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'slave1'</span>@'slave_host<span class="token string">' identified by '</span>password'<span class="token punctuation">;</span>    flush <span class="token keyword">privileges</span><span class="token punctuation">;</span></code></pre><p>å¦‚æœéœ€è¦é…ç½®å¤šä¸ªä»æœºå°±åˆ›å»ºå¤šä¸ªè´¦æˆ·ï¼Œ<code>&#39;slave_host&#39;</code>ä»£è¡¨ä»æœºçš„ipåœ°å€ã€‚</p><ol start="3"><li>æŸ¥çœ‹masterçŠ¶æ€ï¼š</li></ol><pre class=" language-sql"><code class="language-sql"><span class="token keyword">show</span> master <span class="token keyword">status</span><span class="token punctuation">;</span></code></pre><ul><li>File : ä»å“ªä¸ªæ—¥å¿—æ–‡ä»¶å¼€å§‹æ¨é€æ—¥å¿—æ–‡ä»¶ </li><li>Position ï¼š ä»å“ªä¸ªä½ç½®å¼€å§‹æ¨é€æ—¥å¿—</li><li>Binlog_Ignore_DB : æŒ‡å®šä¸éœ€è¦åŒæ­¥çš„æ•°æ®åº“</li></ul><h2 id="slave">3.2 slave</h2><ol><li>åœ¨ slave ç«¯é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®å¦‚ä¸‹å†…å®¹ï¼š</li></ol><pre class=" language-conf"><code class="language-conf">#mysqlæœåŠ¡ç«¯ID,å”¯ä¸€server-id=2#æŒ‡å®šbinlogæ—¥å¿—log-bin=/var/lib/mysql/mysqlbin</code></pre><ol start="2"><li>åœ¨å®¢æˆ·ç«¯å†…æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ ï¼š</li></ol><pre class=" language-sql"><code class="language-sql">change master <span class="token keyword">to</span> master_host<span class="token operator">=</span> <span class="token string">'master_host'</span><span class="token punctuation">,</span> master_user<span class="token operator">=</span><span class="token string">'slave1'</span><span class="token punctuation">,</span> master_password<span class="token operator">=</span><span class="token string">'password'</span><span class="token punctuation">,</span> master_log_file<span class="token operator">=</span><span class="token string">'mysqlbin.000001'</span><span class="token punctuation">,</span> master_log_pos<span class="token operator">=</span><span class="token number">413</span><span class="token punctuation">;</span></code></pre><p>æŒ‡å®šå½“å‰ä»åº“å¯¹åº”çš„ä¸»åº“çš„IPåœ°å€ï¼Œç”¨æˆ·åï¼Œå¯†ç ï¼Œä»å“ªä¸ªæ—¥å¿—æ–‡ä»¶å¼€å§‹çš„é‚£ä¸ªä½ç½®å¼€å§‹åŒæ­¥æ¨é€æ—¥å¿—ã€‚ï¼ˆè¿™äº›éƒ½æ˜¯åœ¨master statusä¸­çœ‹åˆ°çš„ï¼‰</p><ol start="3"><li>å¼€å¯åŒæ­¥æ“ä½œ</li></ol><pre class=" language-sql"><code class="language-sql"><span class="token keyword">start</span> slave<span class="token punctuation">;</span><span class="token keyword">show</span> slave <span class="token keyword">status</span><span class="token punctuation">;</span></code></pre><ol start="4"><li>åœæ­¢åŒæ­¥æ“ä½œ</li></ol><pre class=" language-sql"><code class="language-sql">stop slave<span class="token punctuation">;</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è¯¥æ–‡ä¸è°ˆåŠè‰¯å¥½çš„ä¸»ä»å¤åˆ¶æ‹“æ‰‘ç»“æ„å’Œä¸»ä»å¤åˆ¶ä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼Œä»¥åæœ‰æ—¶é—´å†å†™ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ¦‚è¿°&quot;&gt;1 æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;å¤åˆ¶è§£å†³çš„åŸºæœ¬é—®é¢˜æ˜¯è®©ä¸€å°æœåŠ¡å™¨çš„æ•°æ®ä¸å…¶ä»–æœåŠ¡å™¨ä¿æŒåŒæ­¥ã€‚ä¸€å°ä¸»åº“çš„æ•°æ®å¯ä»¥åŒæ­¥åˆ°å¤šå°å¤‡åº“ä¸Šï¼Œå¤‡åº“æœ¬èº«ä¹Ÿå¯ä»¥è¢«é…ç½®æˆå¦å¤–ä¸€å°æœåŠ¡å™¨çš„ä¸»åº“ã€‚
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="æ•°æ®åº“" scheme="https://www.codetool.top/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="MySQL" scheme="https://www.codetool.top/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQLä¹‹æ—¥å¿—é…ç½®å…¨è§£</title>
    <link href="https://www.codetool.top/article/MySQL%E4%B9%8B%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E5%85%A8%E8%A7%A3/"/>
    <id>https://www.codetool.top/article/MySQLä¹‹æ—¥å¿—é…ç½®å…¨è§£/</id>
    <published>2020-03-07T09:43:59.000Z</published>
    <updated>2020-03-07T09:44:31.028Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é”™è¯¯æ—¥å¿—">1 é”™è¯¯æ—¥å¿—</h1><p>é”™è¯¯æ—¥å¿—æ˜¯ MySQL ä¸­æœ€é‡è¦çš„æ—¥å¿—ä¹‹ä¸€ï¼Œå®ƒè®°å½•äº†å½“ mysqld å¯åŠ¨å’Œåœæ­¢æ—¶ï¼Œä»¥åŠæœåŠ¡å™¨åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿä»»ä½•ä¸¥é‡é”™è¯¯æ—¶çš„ç›¸å…³ä¿¡æ¯ã€‚å½“æ•°æ®åº“å‡ºç°ä»»ä½•æ•…éšœå¯¼è‡´æ— æ³•æ­£å¸¸ä½¿ç”¨æ—¶ï¼Œå¯ä»¥é¦–å…ˆæŸ¥çœ‹æ­¤æ—¥å¿—ã€‚</p><p>è¯¥æ—¥å¿—æ˜¯é»˜è®¤å¼€å¯çš„ ï¼Œ é»˜è®¤å­˜æ”¾ç›®å½•ä¸º mysql çš„æ•°æ®ç›®å½•ï¼ˆvar/lib/mysqlï¼‰, é»˜è®¤çš„æ—¥å¿—æ–‡ä»¶åä¸º <code>hostname.err</code>ï¼ˆhostnameæ˜¯ä¸»æœºåï¼‰ã€‚</p><h2 id="ç›¸å…³é…ç½®">1.1 ç›¸å…³é…ç½®</h2><ul><li><code>log-error</code>ï¼šé”™è¯¯æ—¥å¿—å­˜æ”¾è·¯å¾„</li><li><code>log-warnings</code>ï¼šæ˜¯å¦å°†è­¦å‘Šä¿¡æ¯ä¹Ÿè¾“å…¥é”™è¯¯æ—¥å¿—ï¼Œ1ä»£è¡¨æ˜¯ï¼ˆ5.7ååºŸå¼ƒï¼‰</li><li><code>log_error_verbosity</code>ï¼šï¼ˆä»£æ›¿log-warningsï¼‰é”™è¯¯æ—¥å¿—çº§åˆ«<ul><li>1ï¼šerrors only</li><li>2ï¼šerrors and warnings</li><li>3ï¼šerrorsï¼Œwarnings and notes</li></ul></li></ul><h1 id="äºŒè¿›åˆ¶æ—¥å¿—">2 äºŒè¿›åˆ¶æ—¥å¿—</h1><p>äºŒè¿›åˆ¶æ—¥å¿—åŒ…å«äº†æ‰€æœ‰çš„ DDLï¼ˆæ•°æ®å®šä¹‰è¯­è¨€ï¼‰è¯­å¥å’Œ DMLï¼ˆæ•°æ®æ“çºµè¯­è¨€ï¼‰è¯­å¥çš„äº‹ä»¶ä¿¡æ¯ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬æ•°æ®æŸ¥è¯¢è¯­å¥ã€‚è¯­å¥ä»¥â€äº‹ä»¶â€çš„å½¢å¼ä¿å­˜ï¼Œæ‰€ä»¥åŒ…å«äº†æ—¶é—´ã€äº‹ä»¶å¼€å§‹å’Œç»“æŸä½ç½®ç­‰ä¿¡æ¯ã€‚æ­¤æ—¥å¿—å¯¹äºç¾éš¾æ—¶çš„æ•°æ®æ¢å¤èµ·ç€æå…¶é‡è¦çš„ä½œç”¨ï¼ŒMySQLçš„ä¸»ä»å¤åˆ¶ï¼Œ å°±æ˜¯é€šè¿‡è¯¥binlogå®ç°çš„ã€‚</p><p>äºŒè¿›åˆ¶æ—¥å¿—ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œéœ€è¦åˆ°MySQLçš„é…ç½®æ–‡ä»¶ä¸­å¼€å¯ï¼Œå¹¶é…ç½®MySQLæ—¥å¿—çš„æ ¼å¼ã€‚ </p><p>mysqldè¿˜åˆ›å»ºä¸€ä¸ªäºŒè¿›åˆ¶æ—¥å¿—<strong>ç´¢å¼•æ–‡ä»¶</strong>ï¼Œå½“äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶æ»šåŠ¨çš„æ—¶å€™ä¼šå‘è¯¥æ–‡ä»¶ä¸­å†™å…¥å¯¹åº”çš„ä¿¡æ¯ã€‚æ‰€ä»¥è¯¥æ–‡ä»¶<strong>åŒ…å«æ‰€æœ‰ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶çš„æ–‡ä»¶å</strong>ã€‚é»˜è®¤æƒ…å†µä¸‹è¯¥æ–‡ä»¶ä¸äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶çš„æ–‡ä»¶åç›¸åŒï¼Œæ‰©å±•åä¸ºâ€™.indexâ€™ã€‚</p><h2 id="ç›¸å…³é…ç½®-1">2.1 ç›¸å…³é…ç½®</h2><ul><li><code>log_bin=[on|off|file_name]</code>ï¼šå¼€å¯binlogï¼Œå¦‚æœæ²¡æœ‰ç»™å®šfile_nameï¼Œåˆ™é»˜è®¤ä¸ºdatadirä¸‹çš„ä¸»æœºååŠ â€-binâ€ï¼Œå¹¶åœ¨åé¢è·Ÿä¸Šä¸€ä¸²æ•°å­—è¡¨ç¤ºæ—¥å¿—åºåˆ—å·ã€‚</li><li><code>binlog_format=[STATEMENT|ROW|MIXED]</code>ï¼šæŒ‡å®šäºŒè¿›åˆ¶æ—¥å¿—çš„æ ¼å¼ã€‚<ul><li>STATEMENTï¼šè¯¥æ—¥å¿—æ ¼å¼åœ¨æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•çš„éƒ½æ˜¯SQLè¯­å¥ï¼ˆstatementï¼‰ï¼Œæ¯ä¸€æ¡å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹çš„SQLéƒ½ä¼šè®°å½•åœ¨æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œé€šè¿‡Mysqlæä¾›çš„mysqlbinlogå·¥å…·ï¼Œå¯ä»¥æ¸…æ™°çš„æŸ¥çœ‹åˆ°æ¯æ¡è¯­å¥çš„æ–‡æœ¬ã€‚ä¸»ä»å¤åˆ¶çš„æ—¶å€™ï¼Œä»åº“ï¼ˆslaveï¼‰ä¼šå°†æ—¥å¿—è§£æä¸ºåŸæ–‡æœ¬ï¼Œå¹¶åœ¨ä»åº“é‡æ–°æ‰§è¡Œä¸€æ¬¡ã€‚</li><li>ROWï¼šè¯¥æ—¥å¿—æ ¼å¼åœ¨æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•çš„æ˜¯æ¯ä¸€è¡Œçš„æ•°æ®å˜æ›´ï¼Œè€Œä¸æ˜¯è®°å½•SQLè¯­å¥ã€‚æ¯”å¦‚ï¼Œæ‰§è¡ŒSQLè¯­å¥ ï¼š update tb_book set status=â€™1â€™ , å¦‚æœæ˜¯STATEMENT æ—¥å¿—æ ¼å¼ï¼Œåœ¨æ—¥å¿—ä¸­ä¼šè®°å½•ä¸€è¡ŒSQLæ–‡ä»¶ï¼› å¦‚æœæ˜¯ROWï¼Œç”±äºæ˜¯å¯¹å…¨è¡¨è¿›è¡Œæ›´æ–°ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€è¡Œè®°å½•éƒ½ä¼šå‘ç”Ÿå˜æ›´ï¼ŒROW æ ¼å¼çš„æ—¥å¿—ä¸­ä¼šè®°å½•æ¯ä¸€è¡Œçš„æ•°æ®å˜æ›´ã€‚</li><li>MIXEDï¼šè¿™æ˜¯ç›®å‰MySQLé»˜è®¤çš„æ—¥å¿—æ ¼å¼ï¼Œå³æ··åˆäº†STATEMENT å’Œ ROWä¸¤ç§æ ¼å¼ã€‚é»˜è®¤æƒ…å†µä¸‹é‡‡ç”¨STATEMENTï¼Œä½†æ˜¯åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹é‡‡ç”¨ROWæ¥è¿›è¡Œè®°å½•ã€‚MIXED æ ¼å¼èƒ½å°½é‡åˆ©ç”¨ä¸¤ç§æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œè€Œé¿å¼€ä»–ä»¬çš„ç¼ºç‚¹ã€‚</li></ul></li><li><code>log_bin_index = file_name</code>ï¼šé…ç½®ç´¢å¼•æ–‡ä»¶çš„åå­—</li><li><code>expire_logs_days</code>ï¼šæŒ‡å®šè‡ªåŠ¨åˆ é™¤äºŒè¿›åˆ¶æ—¥å¿—çš„æ—¶é—´ï¼Œå³æ—¥å¿—è¿‡æœŸæ—¶é—´</li><li><code>binlog_do_db</code> ï¼šæ˜ç¡®æŒ‡å®šè¦è®°å½•æ—¥å¿—çš„æ•°æ®åº“</li><li><code>binlog_ignore_db</code> ï¼šæŒ‡å®šä¸è®°å½•äºŒè¿›åˆ¶æ—¥å¿—çš„æ•°æ®åº“</li><li><code>binlog_cache_size = 32768</code> : åŸºäºäº‹åŠ¡ç±»å‹çš„æ—¥å¿—ä¼šå…ˆè®°å½•åœ¨ç¼“å†²åŒºï¼Œå½“è¾¾åˆ°è¯¥ç¼“å†²å¤§å°æ—¶è¿™äº›æ—¥å¿—ä¼šå†™å…¥ç£ç›˜</li><li><code>max_binlog_size</code> ï¼šæŒ‡å®šäºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶æœ€å¤§å€¼ï¼Œè¶…å‡ºæŒ‡å®šå€¼å°†è‡ªåŠ¨æ»šåŠ¨ã€‚ä½†ç”±äºäº‹åŠ¡ä¸ä¼šè·¨æ–‡ä»¶ï¼Œæ‰€ä»¥å¹¶ä¸ä¸€å®šæ€»æ˜¯ç²¾ç¡®ã€‚</li><li><code>sync_binlog = { 0 | n }</code> ï¼šæ—¥å¿—ä½•æ—¶åˆ·åˆ°ç£ç›˜<ul><li>0:ä¸åŒæ­¥ï¼Œæ—¥å¿—ä½•æ—¶åˆ·åˆ°ç£ç›˜ç”±FileSystemå†³å®šï¼Œè¿™ä¸ªæ€§èƒ½æœ€å¥½ã€‚</li><li>n:æ¯å†™næ¬¡äºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶(ä¸æ˜¯äº‹åŠ¡)ï¼ŒMySQLå°†æ‰§è¡Œä¸€æ¬¡ç£ç›˜åŒæ­¥æŒ‡ä»¤fdatasync()å°†ç¼“å­˜æ—¥å¿—åˆ·æ–°åˆ°ç£ç›˜æ—¥å¿—æ–‡ä»¶ä¸­ã€‚Mysqlä¸­é»˜è®¤çš„è®¾ç½®æ˜¯sync_binlog=0ï¼Œå³ä¸åŒæ­¥ï¼Œè¿™æ—¶æ€§èƒ½æœ€å¥½ï¼Œä½†é£é™©æœ€å¤§ã€‚ä¸€æ—¦ç³»ç»Ÿå¥”æºƒï¼Œç¼“å­˜ä¸­çš„æ—¥å¿—éƒ½ä¼šä¸¢å¤±ã€‚</li><li>åœ¨Innodbçš„ä¸»ä»å¤åˆ¶ç»“æ„ä¸­ï¼Œå¦‚æœå¯ç”¨äº†äºŒè¿›åˆ¶æ—¥å¿—(å‡ ä¹éƒ½ä¼šå¯ç”¨)ï¼Œè¦ä¿è¯äº‹åŠ¡çš„ä¸€è‡´æ€§å’ŒæŒä¹…æ€§çš„æ—¶å€™ï¼Œå¿…é¡»å°†sync_binlogçš„å€¼è®¾ç½®ä¸º1ï¼Œå› ä¸ºæ¯æ¬¡äº‹åŠ¡æäº¤éƒ½ä¼šå†™å…¥äºŒè¿›åˆ¶æ—¥å¿—ï¼Œè®¾ç½®ä¸º1å°±ä¿è¯äº†æ¯æ¬¡äº‹åŠ¡æäº¤æ—¶äºŒè¿›åˆ¶æ—¥å¿—éƒ½ä¼šå†™å…¥åˆ°ç£ç›˜ä¸­ï¼Œä»è€Œç«‹å³è¢«ä»æœåŠ¡å™¨å¤åˆ¶è¿‡å»ã€‚</li></ul></li></ul><h2 id="æ—¥å¿—æŸ¥çœ‹">2.2 æ—¥å¿—æŸ¥çœ‹</h2><p>ç”±äºæ—¥å¿—ä»¥äºŒè¿›åˆ¶æ–¹å¼å­˜å‚¨ï¼Œä¸èƒ½ç›´æ¥è¯»å–ï¼Œéœ€è¦ç”¨mysqlbinlogå·¥å…·æ¥æŸ¥çœ‹ï¼Œè¯­æ³•å¦‚ä¸‹ ï¼š</p><p><code>mysqlbinlog log-file</code></p><h2 id="æ—¥å¿—åˆ é™¤">2.3 æ—¥å¿—åˆ é™¤</h2><p>å¯¹äºæ¯”è¾ƒç¹å¿™çš„ç³»ç»Ÿï¼Œç”±äºæ¯å¤©ç”Ÿæˆæ—¥å¿—é‡å¤§ ï¼Œè¿™äº›æ—¥å¿—å¦‚æœé•¿æ—¶é—´ä¸æ¸…é™¤ï¼Œå°†ä¼šå ç”¨å¤§é‡çš„ç£ç›˜ç©ºé—´ã€‚ä¸‹é¢ä»‹ç»å‡ ç§åˆ é™¤æ—¥å¿—çš„å¸¸è§æ–¹æ³• ï¼š</p><p>1) é€šè¿‡ <code>Reset Master</code> æŒ‡ä»¤åˆ é™¤å…¨éƒ¨ binlog æ—¥å¿—ï¼Œåˆ é™¤ä¹‹åï¼Œæ—¥å¿—ç¼–å·å°†ä» xxxx.000001é‡æ–°å¼€å§‹ã€‚</p><p>2) æ‰§è¡ŒæŒ‡ä»¤ <code>purge master logs to &#39;mysqlbin.******&#39;</code> ï¼Œè¯¥å‘½ä»¤å°†åˆ é™¤ <code>******</code> ç¼–å·ä¹‹å‰çš„æ‰€æœ‰æ—¥å¿—ã€‚ </p><p>3) æ‰§è¡ŒæŒ‡ä»¤ <code>purge master logs before &#39;yyyy-mm-dd hh24:mi:ss&#39;</code> ï¼Œè¯¥å‘½ä»¤å°†åˆ é™¤æ—¥å¿—ä¸º â€œyyyy-mm-dd hh24:mi:ssâ€ ä¹‹å‰äº§ç”Ÿçš„æ‰€æœ‰æ—¥å¿—ã€‚</p><p>4) è®¾ç½®å‚æ•° <code>--expire_logs_days=#</code> ï¼Œæ­¤å‚æ•°çš„å«ä¹‰æ˜¯è®¾ç½®æ—¥å¿—çš„è¿‡æœŸå¤©æ•°ï¼Œ è¿‡äº†æŒ‡å®šçš„å¤©æ•°åæ—¥å¿—å°†ä¼šè¢«è‡ªåŠ¨åˆ é™¤ï¼Œè¿™æ ·å°†æœ‰åˆ©äºå‡å°‘DBA ç®¡ç†æ—¥å¿—çš„å·¥ä½œé‡ã€‚</p><h1 id="æŸ¥è¯¢æ—¥å¿—">3 æŸ¥è¯¢æ—¥å¿—</h1><p>æŸ¥è¯¢æ—¥å¿—ä¸­è®°å½•äº†å®¢æˆ·ç«¯çš„æ‰€æœ‰æ“ä½œè¯­å¥ï¼Œè€ŒäºŒè¿›åˆ¶æ—¥å¿—ä¸åŒ…å«æŸ¥è¯¢æ•°æ®çš„SQLè¯­å¥ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ æŸ¥è¯¢æ—¥å¿—æ˜¯æœªå¼€å¯çš„ã€‚å¦‚æœéœ€è¦å¼€å¯æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦æ‰‹åŠ¨é…ç½®ã€‚é€šå¸¸ä¸éœ€è¦å¼€å¯æ­¤æ—¥å¿—ã€‚</p><h2 id="ç›¸å…³é…ç½®-2">3.1 ç›¸å…³é…ç½®</h2><ul><li><code>general_log = {0 | 1}</code> ï¼š æ˜¯å¦å¼€å¯æŸ¥è¯¢æ—¥å¿—</li><li><code>general_log_file</code> ï¼š æŸ¥è¯¢æ—¥å¿—å­˜æ”¾è·¯å¾„ï¼Œä¸ç»™å®šè·¯å¾„æ—¶é»˜è®¤çš„æ–‡ä»¶åä»¥ <code>hostname.log</code> å‘½åã€‚</li></ul><h1 id="æ…¢æŸ¥è¯¢æ—¥å¿—">4 æ…¢æŸ¥è¯¢æ—¥å¿—</h1><p>MySQL çš„æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯ MySQL æä¾›çš„ä¸€ç§æ—¥å¿—è®°å½•ï¼Œå®ƒç”¨æ¥è®°å½•åœ¨ MySQL ä¸­å“åº”æ—¶é—´è¶…è¿‡é˜ˆå€¼çš„è¯­å¥ï¼Œå…·ä½“æŒ‡è¿è¡Œæ—¶é—´è¶…è¿‡ <code>long_query_time</code> å€¼çš„ SQLï¼Œåˆ™ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚</p><p><code>long_query_time</code> çš„é»˜è®¤å€¼ä¸º 10ï¼Œæ„æ€æ˜¯è¿è¡Œ 10s ä»¥ä¸Šçš„è¯­å¥ã€‚<strong>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMysql æ•°æ®åº“å¹¶ä¸å¯åŠ¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ¥è®¾ç½®è¿™ä¸ªå‚æ•°</strong>ï¼Œå½“ç„¶ï¼Œå¦‚æœä¸æ˜¯è°ƒä¼˜éœ€è¦çš„è¯ï¼Œä¸€èˆ¬ä¸å»ºè®®å¯åŠ¨è¯¥å‚æ•°ï¼Œå› ä¸ºå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ä¼šæˆ–å¤šæˆ–å°‘å¸¦æ¥ä¸€å®šçš„æ€§èƒ½å½±å“ã€‚æ…¢æŸ¥è¯¢æ—¥å¿—æ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ–‡ä»¶ï¼Œä¹Ÿæ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ•°æ®åº“è¡¨ã€‚</p><p>æ ¼å¼å¤§è‡´å¦‚ä¸‹ï¼š</p><pre><code># Time: 180118 14:58:37# User@Host: root[root] @ localhost []  Id:   150# Query_time: 0.000270  Lock_time: 0.000109 Rows_sent: 0  Rows_examined: 6SET timestamp=1516258717;delete from user where User=&#39;app&#39;;</code></pre><p>æ˜¯å“ªæ¡è¯­å¥å¯¼è‡´æ…¢æŸ¥è¯¢ï¼ˆsql_textï¼‰ï¼Œè¯¥æ…¢æŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢æ—¶é—´ï¼ˆquery_timeï¼‰ï¼Œé”è¡¨æ—¶é—´ï¼ˆLock_timeï¼‰ï¼Œä»¥åŠæ‰«æè¿‡çš„è¡Œæ•°ï¼ˆrows_examinedï¼‰</p><h2 id="ç›¸å…³é…ç½®-3">4.1 ç›¸å…³é…ç½®</h2><ul><li><code>slow_query_log</code> ï¼šæ˜¯å¦å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œ1 è¡¨ç¤ºå¼€å¯ï¼Œ0 è¡¨ç¤ºå…³é—­ã€‚</li><li><code>slow-query-log-file</code>ï¼šæ–°ç‰ˆï¼ˆ5.6 åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰ï¼šMySQL æ•°æ®åº“æ…¢æŸ¥è¯¢æ—¥å¿—å­˜å‚¨è·¯å¾„ã€‚å¯ä»¥ä¸è®¾ç½®è¯¥å‚æ•°ï¼Œç³»ç»Ÿåˆ™ä¼šé»˜è®¤ç»™ä¸€ä¸ªç¼ºçœçš„æ–‡ä»¶ host_name-slow.log</li><li><code>long_query_time</code> ï¼šæ…¢æŸ¥è¯¢é˜ˆå€¼ï¼Œå½“æŸ¥è¯¢æ—¶é—´å¤šäºè®¾å®šçš„é˜ˆå€¼æ—¶ï¼Œè®°å½•æ—¥å¿—ã€‚</li><li><code>log_queries_not_using_indexes</code>ï¼šæœªä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢ä¹Ÿè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ï¼ˆå¯é€‰é¡¹ï¼‰ã€‚</li><li><code>log_output</code>ï¼šæ—¥å¿—å­˜å‚¨æ–¹å¼ã€‚é»˜è®¤å€¼æ˜¯<code>&#39;FILE&#39;</code>ï¼Œè¡¨ç¤ºå°†æ—¥å¿—å­˜å…¥æ–‡ä»¶ã€‚<code>&#39;TABLE&#39;</code>è¡¨ç¤ºå°†æ—¥å¿—å­˜å…¥æ•°æ®åº“ï¼Œè¿™æ ·æ—¥å¿—ä¿¡æ¯å°±ä¼šè¢«å†™å…¥åˆ° <code>mysql.slow_log</code> è¡¨ä¸­ï¼Œæ”¯æŒåŒæ—¶è®°å½•åˆ°æ–‡ä»¶å’Œæ•°æ®åº“ï¼Œé…ç½®çš„æ—¶å€™ä»¥é€—å·éš”å¼€å³å¯ã€‚</li></ul><h2 id="æ…¢æ—¥å¿—åˆ†æå·¥å…·-mysqldumpslow">4.2 æ…¢æ—¥å¿—åˆ†æå·¥å…· mysqldumpslow</h2><p>åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¦‚æœè¦æ‰‹å·¥åˆ†ææ—¥å¿—ï¼ŒæŸ¥æ‰¾ã€åˆ†æ SQLï¼Œæ˜¾ç„¶æ˜¯ä¸ªä½“åŠ›æ´»ï¼ŒMySQL æä¾›äº†æ—¥å¿—åˆ†æå·¥å…· mysqldumpslowã€‚</p><p>å‚æ•°ï¼š</p><ul><li><code>-s</code> æŒ‰ç…§é‚£ç§æ–¹å¼æ’åº<ul><li><code>c</code>ï¼šè®¿é—®è®¡æ•°</li><li><code>l</code>ï¼šé”å®šæ—¶é—´</li><li><code>r</code>:è¿”å›è®°å½•</li><li><code>al</code>ï¼šå¹³å‡é”å®šæ—¶é—´</li><li><code>ar</code>ï¼šå¹³å‡è®¿é—®è®°å½•æ•°</li><li><code>at</code>ï¼šå¹³å‡æŸ¥è¯¢æ—¶é—´</li></ul></li><li><code>-t</code> æ˜¯top nçš„æ„æ€ï¼Œè¿”å›å¤šå°‘æ¡æ•°æ®ã€‚</li><li><code>-g</code> å¯ä»¥è·Ÿä¸Šæ­£åˆ™åŒ¹é…æ¨¡å¼ï¼Œå¤§å°å†™ä¸æ•æ„Ÿã€‚</li></ul><p><strong>ä¾‹ï¼š</strong></p><p>å¾—åˆ°è¿”å›è®°å½•é›†æœ€å¤šçš„ 10 ä¸ª SQLã€‚</p><p><code>mysqldumpslow -s r -t 10 /database/mysql/mysql06_slow.log</code></p><p>å¾—åˆ°è®¿é—®æ¬¡æ•°æœ€å¤šçš„ 10 ä¸ª SQL</p><p><code>mysqldumpslow -s c -t 10 /database/mysql/mysql06_slow.log</code></p><p>å¾—åˆ°æŒ‰ç…§æ—¶é—´æ’åºçš„å‰ 10 æ¡é‡Œé¢å«æœ‰å·¦è¿æ¥çš„æŸ¥è¯¢è¯­å¥ã€‚</p><p><code>mysqldumpslow -s t -t 10 -g â€œleft joinâ€ /database/mysql/mysql06_slow.log</code></p><p>å¦å¤–å»ºè®®åœ¨ä½¿ç”¨è¿™äº›å‘½ä»¤æ—¶ç»“åˆ | å’Œ more ä½¿ç”¨ ï¼Œå¦åˆ™æœ‰å¯èƒ½å‡ºç°åˆ·å±çš„æƒ…å†µã€‚</p><p><code>mysqldumpslow -s r -t 20 /mysqldata/mysql/mysql06-slow.log | more</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;é”™è¯¯æ—¥å¿—&quot;&gt;1 é”™è¯¯æ—¥å¿—&lt;/h1&gt;&lt;p&gt;é”™è¯¯æ—¥å¿—æ˜¯ MySQL ä¸­æœ€é‡è¦çš„æ—¥å¿—ä¹‹ä¸€ï¼Œå®ƒè®°å½•äº†å½“ mysqld å¯åŠ¨å’Œåœæ­¢æ—¶ï¼Œä»¥åŠæœåŠ¡å™¨åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿä»»ä½•ä¸¥é‡é”™è¯¯æ—¶çš„ç›¸å…³ä¿¡æ¯ã€‚å½“æ•°æ®åº“å‡ºç°ä»»ä½•æ•…éšœå¯¼è‡´æ— æ³•æ­£å¸¸ä½¿ç”¨æ—¶ï¼Œå¯ä»¥é¦–å…ˆæŸ¥çœ‹æ­¤æ—¥å¿—ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥æ—¥å¿—æ˜¯é»˜è®¤
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="æ•°æ®åº“" scheme="https://www.codetool.top/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="MySQL" scheme="https://www.codetool.top/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>å¤§å‹ç½‘ç«™æ¶æ„çš„æ¼”å˜è¿‡ç¨‹</title>
    <link href="https://www.codetool.top/article/%E5%A4%A7%E5%9E%8B%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84%E7%9A%84%E6%BC%94%E5%8F%98%E8%BF%87%E7%A8%8B/"/>
    <id>https://www.codetool.top/article/å¤§å‹ç½‘ç«™æ¶æ„çš„æ¼”å˜è¿‡ç¨‹/</id>
    <published>2020-03-07T02:41:31.000Z</published>
    <updated>2020-03-07T02:45:15.871Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å•æœºæ—¶ä»£">1 å•æœºæ—¶ä»£</h1><p>å¤§å‹ç½‘ç«™éƒ½æ˜¯ä»å°å‹ç½‘ç«™å‘å±•è€Œæ¥,ç½‘ç«™æ¶æ„ä¹Ÿæ˜¯ä¸€æ ·,æ˜¯ä»å°å‹ç½‘ç«™æ¶æ„é€æ­¥æ¼”åŒ–è€Œæ¥ã€‚å°å‹ç½‘ç«™æœ€å¼€å§‹æ—¶æ²¡æœ‰å¤ªå¤šäººè®¿é—®,åªéœ€è¦ä¸€å°æœåŠ¡å™¨å°±ç»°ç»°æœ‰ä½™,æœ€å…¸å‹çš„æ˜¯åœ¨å°å‹ç½‘ç«™ä¸Šç§°éœ¸çš„LAMPï¼ˆLinux+Apache+MySQL+PHPï¼‰ã€‚æ­¤æ—¶çš„ç½‘ç«™æ¶æ„å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://api.codetool.top/img/15835099733096.png" alt></p><h1 id="åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»">2 åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»</h1><p>éšç€ç½‘ç«™ä¸šåŠ¡çš„å‘å±•,ä¸€å°æœåŠ¡å™¨é€æ¸ä¸èƒ½æ»¡è¶³éœ€æ±‚:è¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·è®¿é—®å¯¼è‡´æ€§èƒ½è¶Šæ¥è¶Šå·®,è¶Šæ¥è¶Šå¤šçš„æ•°æ®å¯¼è‡´å­˜å‚¨ç©ºé—´ä¸è¶³ã€‚è¿™æ—¶å°±éœ€è¦å°†åº”ç”¨å’Œæ•°æ®åˆ†ç¦»ã€‚åº”ç”¨å’Œæ•°æ®åˆ†ç¦»åæ•´ä¸ªç½‘ç«™ä½¿ç”¨ä¸‰å°æœåŠ¡å™¨:åº”ç”¨æœåŠ¡å™¨ã€æ–‡ä»¶æœåŠ¡å™¨å’Œæ•°æ®åº“æœåŠ¡å™¨ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://api.codetool.top/img/15835100957354.png" alt></p><p>è¿™ä¸‰å°æœåŠ¡å™¨å¯¹ç¡¬ä»¶èµ„æºçš„è¦æ±‚å„ä¸ç›¸åŒ,åº”ç”¨æœåŠ¡å™¨éœ€è¦å¤„ç†å¤§é‡çš„ä¸šåŠ¡é€»è¾‘,å› æ­¤éœ€è¦æ›´å¿«æ›´å¼ºå¤§çš„CPU;æ•°æ®åº“æœåŠ¡å™¨éœ€è¦å¿«é€Ÿç£ç›˜æ£€ç´¢å’Œæ•°æ®ç¼“å­˜,å› æ­¤éœ€è¦æ›´å¿«çš„ç¡¬ç›˜å’Œæ›´å¤§çš„å†…å­˜;æ–‡ä»¶æœåŠ¡å™¨éœ€è¦å­˜å‚¨å¤§é‡ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶,å› æ­¤éœ€è¦æ›´å¤§çš„ç¡¬ç›˜ã€‚</p><p>éšç€ç”¨æˆ·æ•°å¢å¤šï¼Œç½‘ç«™åˆä¸€æ¬¡é¢ä¸´æŒ‘æˆ˜ï¼šæ•°æ®åº“å‹åŠ›å¤ªå¤§å¯¼è‡´è®¿é—®å»¶è¿Ÿï¼Œè¿›è€Œå½±å“æ•´ä¸ªç½‘ç«™çš„æ€§èƒ½ã€‚</p><h1 id="ä½¿ç”¨ç¼“å­˜æ”¹å–„ç½‘ç«™æ€§èƒ½">3 ä½¿ç”¨ç¼“å­˜æ”¹å–„ç½‘ç«™æ€§èƒ½</h1><p>ç½‘ç«™è®¿é—®ç‰¹ç‚¹å’Œç°å®ä¸–ç•Œçš„è´¢å¯Œåˆ†é…ä¸€æ ·éµå¾ªäºŒå…«å®šå¾‹:80%çš„ä¸šåŠ¡è®¿é—®é›†ä¸­åœ¨20%çš„æ•°æ®ä¸Šã€‚æ·˜å®ä¹°å®¶æµè§ˆçš„å•†å“é›†ä¸­åœ¨å°‘éƒ¨åˆ†æˆäº¤æ•°å¤šã€è¯„ä»·è‰¯å¥½çš„å•†å“ä¸Š;ç™¾åº¦æœç´¢å…³é”®è¯é›†ä¸­åœ¨å°‘éƒ¨åˆ†çƒ­é—¨è¯æ±‡ä¸Š;åªæœ‰ç»å¸¸ç™»å½•çš„ç”¨æˆ·æ‰ä¼šå‘å¾®åšã€çœ‹å¾®åš,è€Œè¿™éƒ¨åˆ†ç”¨æˆ·ä¹Ÿåªå æ€»ç”¨æˆ·æ•°ç›®çš„ä¸€å°éƒ¨åˆ†ã€‚</p><p>æ—¢ç„¶å¤§éƒ¨åˆ†çš„ä¸šåŠ¡è®¿é—®é›†ä¸­åœ¨ä¸€å°éƒ¨åˆ†æ•°æ®ä¸Š,é‚£ä¹ˆå¦‚æœæŠŠè¿™ä¸€å°éƒ¨åˆ†æ•°æ®ç¼“å­˜åœ¨å†…å­˜ä¸­,æ˜¯ä¸æ˜¯å°±å¯ä»¥å‡å°‘æ•°æ®åº“çš„è®¿é—®å‹åŠ›,æé«˜æ•´ä¸ªç½‘ç«™çš„æ•°æ®è®¿é—®é€Ÿåº¦,æ”¹å–„æ•°æ®åº“çš„å†™å…¥æ€§èƒ½äº†å‘¢?</p><p>ç½‘ç«™ä½¿ç”¨çš„ç¼“å­˜å¯ä»¥åˆ†ä¸ºä¸¤ç§:ç¼“å­˜åœ¨åº”ç”¨æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°ç¼“å­˜å’Œç¼“å­˜åœ¨ä¸“é—¨çš„åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨ä¸Šçš„è¿œç¨‹ç¼“å­˜ã€‚<strong>æœ¬åœ°ç¼“å­˜çš„è®¿é—®é€Ÿåº¦æ›´å¿«ä¸€äº›,ä½†æ˜¯å—åº”ç”¨æœåŠ¡å™¨å†…å­˜é™åˆ¶</strong>,å…¶ç¼“å­˜æ•°æ®é‡æœ‰é™,è€Œä¸”ä¼šå‡ºç°å’Œåº”ç”¨ç¨‹åºäº‰ç”¨å†…å­˜çš„æƒ…å†µã€‚è¿œç¨‹åˆ†å¸ƒå¼ç¼“å­˜å¯ä»¥ä½¿ç”¨é›†ç¾¤çš„æ–¹å¼,éƒ¨ç½²å¤§å†…å­˜çš„æœåŠ¡å™¨ä½œä¸ºä¸“é—¨çš„ç¼“å­˜æœåŠ¡å™¨,å¯ä»¥åœ¨ç†è®ºä¸Šåšåˆ°ä¸å—å†…å­˜å®¹é‡é™åˆ¶çš„ç¼“å­˜æœåŠ¡,å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://api.codetool.top/img/15835104734486.png" alt></p><p>ä½¿ç”¨ç¼“å­˜å,æ•°æ®è®¿é—®å‹åŠ›å¾—åˆ°æœ‰æ•ˆç¼“è§£,ä½†æ˜¯å•ä¸€åº”ç”¨æœåŠ¡å™¨èƒ½å¤Ÿå¤„ç†çš„è¯·æ±‚è¿æ¥æœ‰é™,åœ¨ç½‘ç«™è®¿é—®é«˜å³°æœŸ,åº”ç”¨æœåŠ¡å™¨æˆä¸ºæ•´ä¸ªç½‘ç«™çš„ç“¶é¢ˆã€‚</p><h1 id="ä½¿ç”¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤æ”¹å–„ç½‘ç«™çš„å¹¶å‘å¤„ç†èƒ½åŠ›">4 ä½¿ç”¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤æ”¹å–„ç½‘ç«™çš„å¹¶å‘å¤„ç†èƒ½åŠ›</h1><p>è¿™ä¹Ÿè¢«ç§°ä¸ºè´Ÿè½½å‡è¡¡ï¼š</p><p><img src="https://api.codetool.top/img/15835105892447.png" alt></p><h1 id="æ•°æ®åº“è¯»å†™åˆ†ç¦»">5 æ•°æ®åº“è¯»å†™åˆ†ç¦»</h1><p>ç½‘ç«™åœ¨ä½¿ç”¨ç¼“å­˜å,ä½¿ç»å¤§éƒ¨åˆ†æ•°æ®è¯»æ“ä½œè®¿é—®éƒ½å¯ä»¥ä¸é€šè¿‡æ•°æ®åº“å°±èƒ½å®Œæˆ,ä½†æ˜¯ä»æœ‰ä¸€éƒ¨åˆ†è¯»æ“ä½œ(ç¼“å­˜è®¿é—®ä¸å‘½ä¸­ã€ç¼“å­˜è¿‡æœŸ)å’Œå…¨éƒ¨çš„å†™æ“ä½œéœ€è¦è®¿é—®æ•°æ®åº“,åœ¨ç½‘ç«™çš„ç”¨æˆ·è¾¾åˆ°ä¸€å®šè§„æ¨¡å,æ•°æ®åº“å› ä¸ºè´Ÿè½½å‹åŠ›è¿‡é«˜è€Œæˆä¸ºç½‘ç«™çš„ç“¶é¢ˆã€‚</p><p>é€šå¸¸ä½¿ç”¨ä¸»ä»å¤åˆ¶æŠ€æœ¯ï¼Œåª<strong>åœ¨ä¸»æœºä¸Šå†™æ•°æ®ï¼Œåœ¨ä»æœºä¸Šè¯»æ•°æ®</strong>ã€‚</p><p><img src="https://api.codetool.top/img/15835107374315.png" alt></p><h1 id="ä½¿ç”¨åå‘ä»£ç†å’ŒCDNåŠ é€Ÿç½‘ç«™å“åº”">6 ä½¿ç”¨åå‘ä»£ç†å’ŒCDNåŠ é€Ÿç½‘ç«™å“åº”</h1><p>éšç€ç½‘ç«™ä¸šåŠ¡ä¸æ–­å‘å±•,ç”¨æˆ·è§„æ¨¡è¶Šæ¥è¶Šå¤§,ç”±äºä¸­å›½å¤æ‚çš„ç½‘ç»œç¯å¢ƒ,ä¸åŒåœ°åŒºçš„ç”¨æˆ·è®¿é—®ç½‘ç«™æ—¶,é€Ÿåº¦å·®åˆ«ä¹Ÿæå¤§ã€‚æœ‰ç ”ç©¶è¡¨æ˜,ç½‘ç«™è®¿é—®å»¶è¿Ÿå’Œç”¨æˆ·æµå¤±ç‡æ­£ç›¸å…³,</p><p>ç½‘ç«™è®¿é—®è¶Šæ…¢,ç”¨æˆ·è¶Šå®¹æ˜“å¤±å»è€å¿ƒè€Œç¦»å¼€ã€‚ä¸ºäº†æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ,ç•™ä½ç”¨æˆ·,ç½‘ç«™éœ€è¦åŠ é€Ÿç½‘ç«™è®¿é—®é€Ÿåº¦ã€‚ä¸»è¦æ‰‹æ®µæœ‰ä½¿ç”¨CDNå’Œåå‘ä»£ç†,å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://api.codetool.top/img/15835450828492.png" alt></p><p><strong>CDNå’Œåå‘ä»£ç†çš„åŸºæœ¬åŸç†éƒ½æ˜¯ç¼“å­˜</strong>,åŒºåˆ«åœ¨äºCDNéƒ¨ç½²åœ¨ç½‘ç»œæä¾›å•†çš„æœºæˆ¿,ä½¿ç”¨æˆ·åœ¨è¯·æ±‚ç½‘ç«™æœåŠ¡æ—¶,å¯ä»¥ä»è·ç¦»è‡ªå·±æœ€è¿‘çš„ç½‘ç»œæä¾›å•†æœºæˆ¿è·å–æ•°æ®;è€Œåå‘ä»£ç†åˆ™éƒ¨ç½²åœ¨ç½‘ç«™çš„ä¸­å¿ƒæœºæˆ¿,å½“ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ä¸­å¿ƒæœºæˆ¿å,é¦–å…ˆè®¿é—®çš„æœåŠ¡å™¨æ˜¯åå‘ä»£ç†æœåŠ¡å™¨,å¦‚æœåå‘ä»£ç†æœåŠ¡å™¨ä¸­ç¼“å­˜ç€ç”¨æˆ·è¯·æ±‚çš„èµ„æº,å°±å°†å…¶ç›´æ¥è¿”å›ç»™ç”¨æˆ·ã€‚</p><h1 id="ä½¿ç”¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå’Œåˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿ">7 ä½¿ç”¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå’Œåˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿ</h1><p>ä»»ä½•å¼ºå¤§çš„å•ä¸€æœåŠ¡å™¨éƒ½æ»¡è¶³ä¸äº†å¤§å‹ç½‘ç«™æŒç»­å¢é•¿çš„ä¸šåŠ¡éœ€æ±‚ã€‚æ•°æ®åº“ç»è¿‡è¯»å†™åˆ†ç¦»å,ä»ä¸€å°æœåŠ¡å™¨æ‹†åˆ†æˆä¸¤å°æœåŠ¡å™¨,ä½†æ˜¯éšç€ç½‘ç«™ä¸šåŠ¡çš„å‘å±•ä¾ç„¶ä¸èƒ½æ»¡è¶³éœ€æ±‚,è¿™æ—¶éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼æ•°æ®åº“ã€‚æ–‡ä»¶ç³»ç»Ÿä¹Ÿæ˜¯ä¸€æ ·,éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ,å¦‚å›¾æ‰€ç¤º:</p><p><img src="https://api.codetool.top/img/15835452178957.png" alt></p><p><strong>åˆ†å¸ƒå¼æ•°æ®åº“æ˜¯ç½‘ç«™æ•°æ®åº“æ‹†åˆ†çš„æœ€åæ‰‹æ®µ</strong>ï¼Œåªæœ‰åœ¨å•è¡¨æ•°æ®è§„æ¨¡éå¸¸åºå¤§çš„æ—¶å€™æ‰ä½¿ç”¨ã€‚ä¸åˆ°ä¸å¾—å·²æ—¶,ç½‘ç«™æ›´å¸¸ç”¨çš„æ•°æ®åº“æ‹†åˆ†æ‰‹æ®µæ˜¯<strong>ä¸šåŠ¡åˆ†åº“</strong>,å°†ä¸åŒä¸šåŠ¡çš„æ•°æ®åº“éƒ¨ç½²åœ¨ä¸åŒçš„ç‰©ç†æœåŠ¡å™¨ä¸Šã€‚</p><h1 id="ä½¿ç”¨NoSQLå’Œæœç´¢å¼•æ“">8 ä½¿ç”¨NoSQLå’Œæœç´¢å¼•æ“</h1><p>éšç€ç½‘ç«™ä¸šåŠ¡è¶Šæ¥è¶Šå¤æ‚,å¯¹æ•°æ®å­˜å‚¨å’Œæ£€ç´¢çš„éœ€æ±‚ä¹Ÿè¶Šæ¥è¶Šå¤æ‚,ç½‘ç«™éœ€è¦é‡‡ç”¨ä¸€äº›éå…³ç³»æ•°æ®åº“æŠ€æœ¯å¦‚ NoSQLå’Œéæ•°æ®åº“æŸ¥è¯¢æŠ€æœ¯å¦‚æœç´¢å¼•æ“,å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://api.codetool.top/img/15835453037260.png" alt></p><p>NoSQLå’Œæœç´¢å¼•æ“éƒ½æ˜¯æºè‡ªäº’è”ç½‘çš„æŠ€æœ¯æ‰‹æ®µ,å¯¹å¯ä¼¸ç¼©çš„åˆ†å¸ƒå¼ç‰¹æ€§å…·æœ‰æ›´å¥½çš„æ”¯æŒã€‚åº”ç”¨æœåŠ¡å™¨åˆ™é€šè¿‡ä¸€ä¸ªç»Ÿä¸€æ•°æ®è®¿é—®æ¨¡å—è®¿é—®å„ç§æ•°æ®,å‡è½»åº”ç”¨ç¨‹åºç®¡ç†è¯¸å¤šæ•°æ®æºçš„éº»çƒ¦ã€‚</p><h1 id="ä¸šåŠ¡æ‹†åˆ†">9 ä¸šåŠ¡æ‹†åˆ†</h1><p>å¤§å‹ç½‘ç«™ä¸ºäº†åº”å¯¹æ—¥ç›Šå¤æ‚çš„ä¸šåŠ¡åœºæ™¯,é€šè¿‡ä½¿ç”¨åˆ†è€Œæ²»ä¹‹çš„æ‰‹æ®µå°†æ•´ä¸ªç½‘ç«™ä¸šåŠ¡åˆ†æˆä¸åŒçš„äº§å“çº¿,å¦‚å¤§å‹è´­ç‰©äº¤æ˜“ç½‘ç«™å°±ä¼šå°†é¦–é¡µã€å•†é“ºã€è®¢å•ã€ä¹°å®¶ã€å–å®¶ç­‰æ‹†åˆ†æˆä¸åŒçš„äº§å“çº¿,åˆ†å½’ä¸åŒçš„ä¸šåŠ¡å›¢é˜Ÿè´Ÿè´£ã€‚</p><p>å…·ä½“åˆ°æŠ€æœ¯ä¸Š,ä¹Ÿä¼šæ ¹æ®äº§å“çº¿åˆ’åˆ†,<strong>å°†ä¸€ä¸ªç½‘ç«™æ‹†åˆ†æˆè®¸å¤šä¸åŒçš„åº”ç”¨,æ¯ä¸ªåº”ç”¨ç‹¬ç«‹éƒ¨ç½²ç»´æŠ¤ã€‚</strong>åº”ç”¨ä¹‹é—´å¯ä»¥é€šè¿‡ä¸€ä¸ªè¶…é“¾æ¥å»ºç«‹å…³ç³»(åœ¨é¦–é¡µä¸Šçš„å¯¼èˆªé“¾æ¥æ¯ä¸ªéƒ½æŒ‡å‘ä¸åŒçš„åº”ç”¨åœ°å€),ä¹Ÿå¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œæ•°æ®åˆ†å‘,å½“ç„¶æœ€å¤šçš„è¿˜æ˜¯é€šè¿‡è®¿é—®åŒä¸€ä¸ªæ•°æ®å­˜å‚¨ç³»ç»Ÿæ¥æ„æˆä¸€ä¸ªå…³è”çš„å®Œæ•´ç³»ç»Ÿ,å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://api.codetool.top/img/1583545568710.png" alt></p><h1 id="åˆ†å¸ƒå¼æœåŠ¡">10 åˆ†å¸ƒå¼æœåŠ¡</h1><p>éšç€ä¸šåŠ¡æ‹†åˆ†è¶Šæ¥è¶Šå°ï¼Œå­˜å‚¨ç³»ç»Ÿè¶Šæ¥è¶Šåºå¤§ï¼Œåº”ç”¨ç³»ç»Ÿçš„æ•´ä½“å¤æ‚åº¦å‘ˆæŒ‡æ•°çº§å¢åŠ ï¼Œéƒ¨ç½²ç»´æŠ¤è¶Šæ¥è¶Šå›°éš¾ã€‚ç”±äºæ‰€æœ‰åº”ç”¨è¦å’Œæ‰€æœ‰æ•°æ®åº“ç³»ç»Ÿè¿æ¥ï¼Œåœ¨æ•°ä¸‡å°æœåŠ¡å™¨è§„æ¨¡çš„ç½‘ç«™ä¸­,è¿™äº›è¿æ¥çš„æ•°ç›®æ˜¯æœåŠ¡å™¨è§„æ¨¡çš„å¹³æ–¹,å¯¼è‡´å­˜æ•°æ®åº“æ¥èµ„æºä¸è¶³,æ‹’ç»æœåŠ¡ã€‚</p><p>æ—¢ç„¶æ¯ä¸€ä¸ªåº”ç”¨ç³»ç»Ÿéƒ½éœ€è¦æ‰§è¡Œè®¸å¤šç›¸åŒçš„ä¸šåŠ¡æ“ä½œ,æ¯”å¦‚ç”¨æˆ·ç®¡ç†ã€å•†å“ç®¡ç†ç­‰,é‚£ä¹ˆå¯ä»¥å°†è¿™äº›å…±ç”¨çš„ä¸šåŠ¡æå–å‡ºæ¥,ç‹¬ç«‹éƒ¨ç½²ã€‚ç”±è¿™äº›å¯å¤ç”¨çš„ä¸šåŠ¡è¿æ¥æ•°æ®åº“,æä¾›å…±ç”¨ä¸šåŠ¡æœåŠ¡,è€Œåº”ç”¨ç³»ç»Ÿåªéœ€è¦ç®¡ç†ç”¨æˆ·ç•Œé¢,é€šè¿‡åˆ†å¸ƒå¼æœåŠ¡è°ƒç”¨å…±ç”¨ä¸šåŠ¡æœåŠ¡å®Œæˆå…·ä½“ä¸šåŠ¡æ“ä½œ,å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://api.codetool.top/img/15835457289108.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å•æœºæ—¶ä»£&quot;&gt;1 å•æœºæ—¶ä»£&lt;/h1&gt;&lt;p&gt;å¤§å‹ç½‘ç«™éƒ½æ˜¯ä»å°å‹ç½‘ç«™å‘å±•è€Œæ¥,ç½‘ç«™æ¶æ„ä¹Ÿæ˜¯ä¸€æ ·,æ˜¯ä»å°å‹ç½‘ç«™æ¶æ„é€æ­¥æ¼”åŒ–è€Œæ¥ã€‚å°å‹ç½‘ç«™æœ€å¼€å§‹æ—¶æ²¡æœ‰å¤ªå¤šäººè®¿é—®,åªéœ€è¦ä¸€å°æœåŠ¡å™¨å°±ç»°ç»°æœ‰ä½™,æœ€å…¸å‹çš„æ˜¯åœ¨å°å‹ç½‘ç«™ä¸Šç§°éœ¸çš„LAMPï¼ˆLinux+Apache+MySQL+PHPï¼‰
      
    
    </summary>
    
    
      <category term="è®¡ç®—æœºç›¸å…³" scheme="https://www.codetool.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9B%B8%E5%85%B3/"/>
    
    
      <category term="æ¶æ„" scheme="https://www.codetool.top/tags/%E6%9E%B6%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>å‰‘æŒ‡offer59-é˜Ÿåˆ—çš„æœ€å¤§å€¼</title>
    <link href="https://www.codetool.top/article/%E5%89%91%E6%8C%87offer59-%E9%98%9F%E5%88%97%E7%9A%84%E6%9C%80%E5%A4%A7%E5%80%BC/"/>
    <id>https://www.codetool.top/article/å‰‘æŒ‡offer59-é˜Ÿåˆ—çš„æœ€å¤§å€¼/</id>
    <published>2020-03-06T16:53:23.000Z</published>
    <updated>2020-03-06T16:58:05.641Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸé¢˜">1 åŸé¢˜</h1><p>è¯·å®šä¹‰ä¸€ä¸ªé˜Ÿåˆ—å¹¶å®ç°å‡½æ•° <code>max_value</code> å¾—åˆ°é˜Ÿåˆ—é‡Œçš„æœ€å¤§å€¼ï¼Œè¦æ±‚å‡½æ•°<code>max_value</code>ã€<code>push_back</code> å’Œ <code>pop_front</code> çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)ã€‚</p><p>è‹¥é˜Ÿåˆ—ä¸ºç©ºï¼Œ<code>pop_front</code> å’Œ <code>max_value</code> éœ€è¦è¿”å› -1</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p><strong>è¾“å…¥:</strong><br>[â€œMaxQueueâ€,â€push_backâ€,â€push_backâ€,â€max_valueâ€,â€pop_frontâ€,â€max_valueâ€]<br>[[],[1],[2],[],[],[]]<br><strong>è¾“å‡º:</strong> [null,null,null,2,1,2]</p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p><strong>è¾“å…¥:</strong><br>[â€œMaxQueueâ€,â€pop_frontâ€,â€max_valueâ€]<br>[[],[],[]]<br><strong>è¾“å‡º:</strong> [null,-1,-1] </p></blockquote><p><strong>é™åˆ¶ï¼š</strong></p><ul><li><code>1 &lt;= push_back,pop_front,max_valueçš„æ€»æ“ä½œæ•° &lt;= 10000</code></li><li><code>1 &lt;= value &lt;= 10^5</code></li></ul><h1 id="è§£æ³•">2 è§£æ³•</h1><h2 id="æ€æƒ³">2.1 æ€æƒ³</h2><p>æˆ‘ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯è¦æ‰‹å†™ä¸ªå †ã€‚ã€‚ã€‚å†™å®Œäº†ä¹‹åå‘ç°è‡ªå·±ç†è§£é”™äº†é¢˜æ„ : )</p><p>å°±æ˜¯å¦å¤–ä½¿ç”¨ä¸€ä¸ªåŒå‘é˜Ÿåˆ—ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å‡çš„é˜Ÿåˆ—ï¼Œå¦‚æœè¦å¼¹å‡ºçš„å…ƒç´ ä¹Ÿæ˜¯é€’å‡é˜Ÿåˆ—çš„å¤´å…ƒç´ ï¼Œå°±æŠŠå®ƒä¹Ÿå¼¹å‡ºã€‚</p><h2 id="ä»£ç ">2.2 ä»£ç </h2><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MaxQueue</span> <span class="token punctuation">{</span>    Queue<span class="token operator">&lt;</span>Integer<span class="token operator">></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Deque<span class="token operator">&lt;</span>Integer<span class="token operator">></span> deque <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">MaxQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">max_value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> deque<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>        queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>deque<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>deque<span class="token punctuation">.</span><span class="token function">peekLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>            deque<span class="token punctuation">.</span><span class="token function">pollLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        deque<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> pop <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>pop <span class="token operator">==</span> deque<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            deque<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> pop<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åŸé¢˜&quot;&gt;1 åŸé¢˜&lt;/h1&gt;&lt;p&gt;è¯·å®šä¹‰ä¸€ä¸ªé˜Ÿåˆ—å¹¶å®ç°å‡½æ•° &lt;code&gt;max_value&lt;/code&gt; å¾—åˆ°é˜Ÿåˆ—é‡Œçš„æœ€å¤§å€¼ï¼Œè¦æ±‚å‡½æ•°&lt;code&gt;max_value&lt;/code&gt;ã€&lt;code&gt;push_back&lt;/code&gt; å’Œ &lt;code&gt;pop_front&lt;/c
      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="ç®—æ³•" scheme="https://www.codetool.top/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="å‰‘æŒ‡offer" scheme="https://www.codetool.top/tags/%E5%89%91%E6%8C%87offer/"/>
    
  </entry>
  
  <entry>
    <title>MySQLä¹‹è¡¨é”ã€è¡Œé”ã€MVCCè¯¦è§£</title>
    <link href="https://www.codetool.top/article/MySQL%E4%B9%8B%E8%A1%A8%E9%94%81%E3%80%81%E8%A1%8C%E9%94%81%E3%80%81MVCC%E8%AF%A6%E8%A7%A3/"/>
    <id>https://www.codetool.top/article/MySQLä¹‹è¡¨é”ã€è¡Œé”ã€MVCCè¯¦è§£/</id>
    <published>2020-03-06T14:10:34.000Z</published>
    <updated>2020-03-06T14:24:03.550Z</updated>
    
    <content type="html"><![CDATA[<p>è¯¥æ–‡å»ºè®®é…åˆ<a href="../æ•°æ®åº“ç†è®ºä¹‹å¹¶å‘æ§åˆ¶/">æ•°æ®åº“ç†è®ºä¹‹å¹¶å‘æ§åˆ¶</a>é˜…è¯»ã€‚</p><h1 id="æ¦‚è¿°">1 æ¦‚è¿°</h1><p>é”æ˜¯è®¡ç®—æœºåè°ƒå¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹å¹¶å‘è®¿é—®æŸä¸€èµ„æºçš„æœºåˆ¶ï¼ˆé¿å…äº‰æŠ¢ï¼‰ã€‚</p><p>åœ¨æ•°æ®åº“ä¸­ï¼Œé™¤ä¼ ç»Ÿçš„è®¡ç®—èµ„æºï¼ˆå¦‚ CPUã€RAMã€I/O ç­‰ï¼‰çš„äº‰ç”¨ä»¥å¤–ï¼Œæ•°æ®ä¹Ÿæ˜¯ä¸€ç§ä¾›è®¸å¤šç”¨æˆ·å…±äº«çš„èµ„æºã€‚å¦‚ä½•ä¿è¯æ•°æ®å¹¶å‘è®¿é—®çš„ä¸€è‡´æ€§ã€æœ‰æ•ˆæ€§æ˜¯æ‰€æœ‰æ•°æ®åº“å¿…é¡»è§£å†³çš„ä¸€ä¸ªé—®é¢˜ï¼Œé”å†²çªä¹Ÿæ˜¯å½±å“æ•°æ®åº“å¹¶å‘è®¿é—®æ€§èƒ½çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚ä»è¿™ä¸ªè§’åº¦æ¥è¯´ï¼Œé”å¯¹æ•°æ®åº“è€Œè¨€æ˜¾å¾—å°¤å…¶é‡è¦ï¼Œä¹Ÿæ›´åŠ å¤æ‚ã€‚</p><h2 id="é”åˆ†ç±»">1.1 é”åˆ†ç±»</h2><p>ä»å¯¹æ•°æ®æ“ä½œçš„ç²’åº¦åˆ† ï¼š </p><ol><li>è¡¨é”ï¼šæ“ä½œæ—¶ï¼Œä¼šé”å®šæ•´ä¸ªè¡¨ã€‚</li><li>è¡Œé”ï¼šæ“ä½œæ—¶ï¼Œä¼šé”å®šå½“å‰æ“ä½œè¡Œã€‚</li></ol><p>ä»å¯¹æ•°æ®æ“ä½œçš„ç±»å‹åˆ†ï¼š</p><ol><li>è¯»é”ï¼ˆå…±äº«é”ï¼‰ï¼šé’ˆå¯¹åŒä¸€ä»½æ•°æ®ï¼Œå¤šä¸ªè¯»æ“ä½œå¯ä»¥åŒæ—¶è¿›è¡Œè€Œä¸ä¼šäº’ç›¸å½±å“ã€‚</li><li>å†™é”ï¼ˆæ’å®ƒé”ï¼‰ï¼šå½“å‰æ“ä½œæ²¡æœ‰å®Œæˆä¹‹å‰ï¼Œå®ƒä¼šé˜»æ–­å…¶ä»–å†™é”å’Œè¯»é”ã€‚</li></ol><h2 id="MySQLä¸­çš„é”">1.2 MySQLä¸­çš„é”</h2><p>ç›¸å¯¹å…¶ä»–æ•°æ®åº“è€Œè¨€ï¼ŒMySQLçš„é”æœºåˆ¶æ¯”è¾ƒç®€å•ï¼Œå…¶æœ€æ˜¾è‘—çš„ç‰¹ç‚¹æ˜¯ä¸åŒçš„å­˜å‚¨å¼•æ“æ”¯æŒä¸åŒçš„é”æœºåˆ¶ã€‚ä¸‹è¡¨ä¸­ç½—åˆ—å‡ºäº†å„å­˜å‚¨å¼•æ“å¯¹é”çš„æ”¯æŒæƒ…å†µï¼š</p><table><thead><tr><th>å­˜å‚¨å¼•æ“</th><th>è¡¨çº§é”</th><th>è¡Œçº§é”</th><th>é¡µé¢é”</th></tr></thead><tbody><tr><td>MyISAM</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>InnoDB</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>MEMORY</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>BDB</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr></tbody></table><p>MySQLè¿™3ç§é”çš„ç‰¹æ€§å¯å¤§è‡´å½’çº³å¦‚ä¸‹ ï¼š</p><table><thead><tr><th>é”ç±»å‹</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>è¡¨çº§é”</td><td>åå‘MyISAM å­˜å‚¨å¼•æ“ï¼Œå¼€é”€å°ï¼ŒåŠ é”å¿«ï¼›ä¸ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦å¤§ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜,å¹¶å‘åº¦æœ€ä½ã€‚</td></tr><tr><td>è¡Œçº§é”</td><td>åå‘InnoDB å­˜å‚¨å¼•æ“ï¼Œå¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½,å¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚</td></tr><tr><td>é¡µé¢é”</td><td>å¼€é”€å’ŒåŠ é”æ—¶é—´ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œå¹¶å‘åº¦ä¸€èˆ¬ã€‚</td></tr></tbody></table><p>ä»ä¸Šè¿°ç‰¹ç‚¹å¯è§ï¼Œå¾ˆéš¾ç¬¼ç»Ÿåœ°è¯´å“ªç§é”æ›´å¥½ï¼Œåªèƒ½å°±å…·ä½“åº”ç”¨çš„ç‰¹ç‚¹æ¥è¯´å“ªç§é”æ›´åˆé€‚ã€‚</p><p>ä»…ä»é”çš„è§’åº¦æ¥è¯´ï¼š</p><ul><li>è¡¨çº§é”æ›´é€‚åˆäºä»¥æŸ¥è¯¢ä¸ºä¸»ï¼Œåªæœ‰å°‘é‡æŒ‰ç´¢å¼•æ¡ä»¶æ›´æ–°æ•°æ®çš„åº”ç”¨ï¼Œå¦‚Web åº”ç”¨</li><li>è¡Œçº§é”åˆ™æ›´é€‚åˆäºæœ‰å¤§é‡æŒ‰ç´¢å¼•æ¡ä»¶å¹¶å‘æ›´æ–°å°‘é‡ä¸åŒæ•°æ®ï¼ŒåŒæ—¶åˆæœ‰å¹¶æŸ¥è¯¢çš„åº”ç”¨ï¼Œå¦‚ä¸€äº›åœ¨çº¿äº‹åŠ¡å¤„ç†ï¼ˆOLTPï¼‰ç³»ç»Ÿã€‚</li></ul><p><strong>æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½ä»¥è‡ªå·±çš„æ–¹å¼å®ç°äº†é”æœºåˆ¶</strong>ï¼ŒæœåŠ¡å™¨å±‚å®Œå…¨ä¸äº†è§£å­˜å‚¨å¼•æ“ä¸­çš„é”å®ç°ã€‚ä½†æœåŠ¡å™¨å±‚ä¹Ÿä¼šä½¿ç”¨å„ç§æœ‰æ•ˆçš„è¡¨é”æ¥å®ç°ä¸åŒçš„ç›®çš„ã€‚</p><p>å¯¹äº MySQL è€Œè¨€ï¼Œäº‹åŠ¡æœºåˆ¶æ›´å¤šæ˜¯é åº•å±‚çš„å­˜å‚¨å¼•æ“å®ç°çš„ï¼Œ<strong>åœ¨æœåŠ¡å™¨å±‚é¢åªæœ‰è¡¨é”ã€‚æ”¯æŒäº‹åŠ¡çš„ InnoDB å­˜å‚¨å¼•æ“å®ç°äº†è¡Œé”ã€‚</strong></p><h1 id="MyISAM-è¡¨é”">2 MyISAM è¡¨é”</h1><p>åå‘ MyISAM å­˜å‚¨å¼•æ“ï¼Œå¼€é”€å°ï¼ŒåŠ é”å¿«ï¼Œæ— æ­»é”ï¼›é”å®šç²’åº¦å¤§ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ã€‚</p><p>åœ¨ç‰¹å®šçš„åœºæ™¯ä¸­ï¼Œè¡¨é”ä¹Ÿå¯èƒ½æœ‰è‰¯å¥½çš„æ€§èƒ½ã€‚æ¯”å¦‚ï¼ŒREAD LOCAL è¡¨é”æ”¯æŒæŸäº›ç±»å‹çš„å¹¶å‘å†™æ“ä½œï¼›å¦å¤–ï¼Œå†™é”ä¹Ÿæ¯”è¯»é”æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œå› æ­¤ä¸€ä¸ªå†™é”è¯·æ±‚å¯ä»¥ä¼šè¢«æ’å…¥åˆ°è¯»é”é˜Ÿåˆ—çš„å‰é¢ã€‚</p><p>å°½ç®¡å­˜å‚¨å¼•æ“å¯ä»¥ç®¡ç†è‡ªå·±çš„é”ï¼ŒæœåŠ¡å™¨è¿˜æ˜¯ä¼šä½¿ç”¨å„ç§æœ‰æ•ˆçš„è¡¨é”æ¥å®ç°ä¸åŒçš„ç›®çš„ã€‚æ¯”å¦‚<strong>æœåŠ¡å™¨åœ¨ ALTER TABLE æ—¶ä½¿ç”¨è¡¨é”ï¼Œè€Œå¿½ç•¥å­˜å‚¨å¼•æ“çš„é”æœºåˆ¶ã€‚MyISAM åœ¨è¯»è¡¨å‰è‡ªåŠ¨å¯¹è¡¨åŠ è¯»é”ï¼Œåœ¨å†™è¡¨å‰è‡ªåŠ¨å¯¹è¡¨åŠ å†™é”ã€‚</strong></p><h2 id="SQLè¯­æ³•">2.1 SQLè¯­æ³•</h2><p>æ·»åŠ è¡¨é”ï¼š</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">lock</span> <span class="token keyword">table</span> table1 <span class="token keyword">read</span><span class="token operator">/</span><span class="token keyword">write</span> <span class="token punctuation">,</span> table2 <span class="token keyword">read</span><span class="token operator">/</span><span class="token keyword">write</span> <span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre><p>readä¸ºè¯»é”ï¼Œå…±äº«é”ï¼›writeä¸ºå†™é”ï¼Œç‹¬å é”ã€‚</p><p>æ˜¾ç¤ºåŠ è¿‡é”çš„è¡¨ï¼š</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">show</span> <span class="token keyword">open</span> <span class="token keyword">tables</span><span class="token punctuation">;</span></code></pre><ul><li><code>In_use</code> : è¡¨å½“å‰è¢«æŸ¥è¯¢ä½¿ç”¨çš„æ¬¡æ•°ã€‚å¦‚æœè¯¥æ•°ä¸ºé›¶ï¼Œåˆ™è¡¨æ˜¯æ‰“å¼€çš„ï¼Œä½†æ˜¯å½“å‰æ²¡æœ‰è¢«ä½¿ç”¨ã€‚ä¸º1ä»£è¡¨å·²åŠ é”ã€‚</li><li><code>Name_locked</code>ï¼šè¡¨åç§°æ˜¯å¦è¢«é”å®šã€‚åç§°é”å®šç”¨äºå–æ¶ˆè¡¨æˆ–å¯¹è¡¨è¿›è¡Œé‡å‘½åç­‰æ“ä½œã€‚</li></ul><p>é‡Šæ”¾è¡¨é”ï¼š</p><pre class=" language-sql"><code class="language-sql">unlock <span class="token keyword">tables</span><span class="token punctuation">;</span></code></pre><h2 id="æ€»ç»“">2.2 æ€»ç»“</h2><ol><li>å¯¹ MyISAM è¡¨çš„è¯»æ“ä½œï¼ˆåŠ è¯»é”ï¼‰ï¼Œä¸ä¼šé˜»å¡å…¶ä»–è¿›ç¨‹å¯¹åŒä¸€è¡¨çš„è¯»è¯·æ±‚ï¼Œä½†ä¼šé˜»å¡å¯¹åŒä¸€è¡¨çš„å†™è¯·æ±‚ã€‚åªæœ‰å½“è¯»é”é‡Šæ”¾åï¼Œæ‰ä¼šæ‰§è¡Œå…¶å®ƒè¿›ç¨‹çš„å†™æ“ä½œã€‚</li><li>å¯¹ MyISAM è¡¨çš„å†™æ“ä½œï¼ˆåŠ å†™é”ï¼‰ï¼Œä¼šé˜»å¡å…¶ä»–è¿›ç¨‹å¯¹åŒä¸€è¡¨çš„è¯»å’Œå†™æ“ä½œï¼Œåªæœ‰å½“å†™é”é‡Šæ”¾åï¼Œæ‰ä¼šæ‰§è¡Œå…¶å®ƒè¿›ç¨‹çš„è¯»å†™æ“ä½œã€‚</li></ol><p>ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯è¯»é”ä¼šé˜»å¡å†™ï¼Œä½†æ˜¯ä¸ä¼šå µå¡è¯»ã€‚è€Œå†™é”åˆ™ä¼šæŠŠè¯»å’Œå†™éƒ½å µå¡ã€‚è¿™ä¹Ÿæ˜¯MyISAMä¸é€‚åˆåšå†™ä¸ºä¸»è¡¨çš„å¼•æ“çš„åŸå› ã€‚å› ä¸ºå†™é”åï¼Œå…¶ä»–çº¿ç¨‹ä¸èƒ½åšä»»ä½•æ“ä½œï¼Œå¤§é‡çš„æ›´æ–°ä¼šä½¿æŸ¥è¯¢å¾ˆéš¾å¾—åˆ°é”ï¼Œä»è€Œé€ æˆæ°¸è¿œé˜»å¡ã€‚</p><h1 id="InnoDB-è¡Œé”">3 InnoDB è¡Œé”</h1><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li>é”ç²’åº¦å°ï¼Œå¹¶å‘åº¦é«˜ï¼›å¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼Œä¼šå‡ºç°æ­»é”</li><li>æ”¯æŒäº‹åŠ¡</li></ul><p>InnoDBä¹Ÿå®ç°äº†å…±äº«é”å’Œæ’ä»–é”ä¸¤ç§ç±»å‹çš„è¡Œé”ã€‚</p><p>InnoDBä¹Ÿæ”¯æŒæ„å‘é”ï¼Œå¯ä»¥å¯¹è¡¨çº§åˆ«ä¸Šæ„å‘é”ã€‚</p><p><strong>å¯¹äº<code>UPDATE</code>ã€<code>DELETE</code>å’Œ<code>INSERT</code>è¯­å¥ï¼ŒInnoDBä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„æ•°æ®é›†åŠ æ’ä»–é”</strong></p><p><strong>å¯¹äºæ™®é€š<code>SELECT</code>è¯­å¥ï¼ŒInnoDBä¸ä¼šåŠ ä»»ä½•é”ï¼Œä½¿ç”¨ä¸€è‡´æ€§éé”å®šè¯»</strong></p><h2 id="äº†è§£ï¼šä¸€è‡´æ€§éé”å®šè¯»">3.1 äº†è§£ï¼šä¸€è‡´æ€§éé”å®šè¯»</h2><p>ä¸€è‡´æ€§éé”å®šè¯»æ˜¯æŒ‡InnoDBå­˜å‚¨å¼•æ“é€šè¿‡è¡Œå¤šç‰ˆæœ¬æ§åˆ¶ï¼ˆMVCCï¼‰çš„æ–¹å¼æ¥è¯»å–å½“å‰æ‰§è¡Œæ—¶é—´æ•°æ®åº“ä¸­è¡Œçš„æ•°æ®ã€‚å¦‚æœè¯»å–çš„è¡Œæ­£åœ¨æ‰§è¡ŒDELETEæˆ–UPDATEï¼Œè¿™æ—¶è¯»å–æ“ä½œä¸ä¼šå› æ­¤å»ç­‰å¾…è¡Œä¸Šé”çš„é‡Šæ”¾ï¼Œè€Œæ˜¯å»è¯»å–è¡Œçš„ä¸€ä¸ªå¿«ç…§æ•°æ®ã€‚</p><p><img src="https://api.codetool.top/img/15835025427688.png" alt></p><p>å¿«ç…§æ•°æ®æ˜¯è¯¥è¡Œçš„ä¹‹å‰ç‰ˆæœ¬çš„æ•°æ®ï¼Œå®ç°æ˜¯é€šè¿‡undoæ®µæ¥å®Œæˆï¼ˆå³ä¸ºäº†å›æ»šäº‹åŠ¡è€Œäº§ç”Ÿçš„é‡åšæ—¥å¿—ï¼‰ã€‚</p><p>é€šè¿‡è¯»å–ä¸åŒçš„å¿«ç…§ç‰ˆæœ¬å®ç°ä¸åŒçš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š</p><ul><li>è¯»å·²æäº¤ï¼šä¸€è‡´æ€§éé”å®šè¯»æ€»æ˜¯è¯»å–è¢«é”å®šè¡Œçš„æœ€æ–°ä¸€ä»½å¿«ç…§æ•°æ®ã€‚äº§ç”Ÿäº†ä¸å¯é‡å¤è¯»çš„é—®é¢˜ã€‚</li><li>é‡å¤è¯»ï¼šä¸€è‡´æ€§éé”å®šè¯»æ€»æ˜¯è¯»å–äº‹åŠ¡å¼€å§‹æ—¶çš„è¡Œæ•°æ®ç‰ˆæœ¬. è§£å†³ä¸å¯é‡å¤è¯»çš„é—®é¢˜ã€‚</li></ul><p>ä¸€è‡´æ€§éé”å®šè¯»æ˜¯InnoDBé»˜è®¤çš„è¯»å–æ–¹å¼ï¼Œä¸ä¼šå ç”¨å’Œç­‰å¾…è¡¨ä¸Šçš„é”ã€‚</p><h2 id="ä¸€è‡´æ€§é”å®šè¯»">3.2 ä¸€è‡´æ€§é”å®šè¯»</h2><p>æŸäº›æƒ…å†µä¸‹ï¼Œç”¨æˆ·éœ€è¦æ˜¾å¼åœ°å¯¹æ•°æ®åº“è¯»å–æ“ä½œè¿›è¡ŒåŠ é”ä»¥ä¿è¯æ•°æ®é€»è¾‘çš„ä¸€è‡´æ€§ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹è¯­å¥æ˜¾ç¤ºç»™è®°å½•é›†åŠ å…±äº«é”æˆ–æ’ä»–é”ï¼ˆä¸€è‡´æ€§é”å®šè¯»ï¼‰ã€‚</p><pre class=" language-sql"><code class="language-sql">å…±äº«é”ï¼ˆSï¼‰ï¼š<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table_name <span class="token keyword">WHERE</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">LOCK</span> <span class="token operator">IN</span> <span class="token keyword">SHARE MODE</span>æ’ä»–é”ï¼ˆX<span class="token punctuation">)</span> ï¼š<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table_name <span class="token keyword">WHERE</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FOR</span> <span class="token keyword">UPDATE</span></code></pre><p>å½“äº‹åŠ¡æäº¤äº†ï¼Œé”å°±é‡Šæ”¾äº†ã€‚</p><p>å¯ä»¥ä½¿ç”¨<code>show status like &#39;innodb_row_lock%&#39;;</code>æŸ¥çœ‹innodbè¡Œé”çš„äº‰ç”¨æƒ…å†µ</p><ul><li><p><code>Innodb_row_lock_current_waits</code>: å½“å‰æ­£åœ¨ç­‰å¾…é”å®šçš„æ•°é‡</p></li><li><p><code>Innodb_row_lock_time</code>: ä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨é”å®šæ€»æ—¶é—´é•¿åº¦</p></li><li><p><code>Innodb_row_lock_time_avg</code>:æ¯æ¬¡ç­‰å¾…æ‰€èŠ±å¹³å‡æ—¶é•¿</p></li><li><p><code>Innodb_row_lock_time_max</code>:ä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨ç­‰å¾…æœ€é•¿çš„ä¸€æ¬¡æ‰€èŠ±çš„æ—¶é—´</p></li><li><p><code>Innodb_row_lock_waits</code>: ç³»ç»Ÿå¯åŠ¨ååˆ°ç°åœ¨æ€»å…±ç­‰å¾…çš„æ¬¡æ•°</p></li></ul><h2 id="è¡Œé”çš„ä¸‰ç§ç®—æ³•">3.3 è¡Œé”çš„ä¸‰ç§ç®—æ³•</h2><h3 id="record-lock">3.3.1 record lock</h3><p>InnoDB é‡Œçš„è¡Œé”ï¼ˆrecord lockï¼‰æ˜¯ç´¢å¼•è®°å½•çš„é”ã€‚</p><p>record lock é”ä½çš„æ˜¯ç´¢å¼•è®°å½•ï¼Œå³ä½¿è¯¥è¡¨ä¸Šæ²¡æœ‰ä»»ä½•ç´¢å¼•ï¼Œé‚£ä¹ˆ innodbä¼šåœ¨åå°åˆ›å»ºä¸€ä¸ªéšè—çš„èšé›†ä¸»é”®ç´¢å¼•ï¼Œé‚£ä¹ˆé”ä½çš„å°±æ˜¯è¿™ä¸ªéšè—çš„èšé›†ä¸»é”®ç´¢å¼•ã€‚æ‰€ä»¥è¯´<strong>å½“ä¸€æ¡ sql æ²¡æœ‰èµ°ä»»ä½•ç´¢å¼•æ—¶ï¼Œé‚£ä¹ˆå°†ä¼šåœ¨æ¯ä¸€æ¡èšç°‡ç´¢å¼•åé¢åŠ  X é”ï¼Œè¿™ä¸ªç±»ä¼¼äºè¡¨é”</strong>ï¼Œä½†åŸç†ä¸Šå’Œè¡¨é”åº”è¯¥æ˜¯å®Œå…¨ä¸åŒçš„ã€‚</p><h3 id="gap-lock">3.3.2 gap lock</h3><p>å½“æˆ‘ä»¬ç”¨èŒƒå›´æ¡ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç›¸ç­‰æ¡ä»¶æ£€ç´¢æ•°æ®ï¼Œå¹¶è¯·æ±‚å…±äº«æˆ–æ’ä»–é”æ—¶ï¼ŒInnoDBä¼šç»™ç¬¦åˆæ¡ä»¶çš„å·²æœ‰æ•°æ®è¿›è¡ŒåŠ é”ï¼› å¯¹äºé”®å€¼åœ¨æ¡ä»¶èŒƒå›´å†…ä½†å¹¶ä¸å­˜åœ¨çš„è®°å½•ï¼Œå«åš â€œé—´éš™ï¼ˆGAPï¼‰â€ï¼ŒInnoDBä¹Ÿä¼šå¯¹è¿™ä¸ª â€œé—´éš™â€ åŠ é”ï¼Œè¿™ç§é”æœºåˆ¶å°±æ˜¯æ‰€è°“çš„é—´éš™é”ï¼ˆgap lockï¼‰ï¼Œå®ƒ<strong>é”å®šä¸€ä¸ªèŒƒå›´çš„è®°å½•,ä½†ä¸åŒ…æ‹¬è®°å½•æœ¬èº«</strong>ã€‚é”åŠ åœ¨æœªä½¿ç”¨çš„ç©ºé—²ç©ºé—´ä¸Š,å¯èƒ½æ˜¯ä¸¤ä¸ªç´¢å¼•è®°å½•ä¹‹é—´ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¬¬ä¸€ä¸ªç´¢å¼•è®°å½•ä¹‹å‰æˆ–æœ€åä¸€ä¸ªç´¢å¼•ä¹‹åçš„ç©ºé—´ã€‚é—´éš™é”é’ˆå¯¹äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸ºå¯é‡å¤è¯»æˆ–ä»¥ä¸Šçº§åˆ«ã€‚</p><h3 id="next-key-lock">3.3.3 next-key lock</h3><p>è¡Œé”ä¸é—´éš™é”ç»„åˆèµ·æ¥ç”¨å°±å«åš Next-Key Lockã€‚<strong>é”å®šä¸€ä¸ªèŒƒå›´ï¼Œå¹¶ä¸”é”å®šè®°å½•æœ¬èº«</strong>ã€‚å¯¹äºè¡Œçš„æŸ¥è¯¢ï¼Œéƒ½æ˜¯é‡‡ç”¨è¯¥æ–¹æ³•ï¼Œä¸»è¦ç›®çš„æ˜¯é˜»æ­¢å¤šä¸ªäº‹åŠ¡å°†è®°å½•æ’å…¥åˆ°åŒä¸€èŒƒå›´å†…ï¼Œè§£å†³å¹»è¯»çš„é—®é¢˜ã€‚</p><p>InnoDB å·¥ä½œåœ¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹ï¼Œå¹¶ä¸”ä¼šä»¥ Next-Key Lock çš„æ–¹å¼å¯¹æ•°æ®è¡Œè¿›è¡ŒåŠ é”ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆé˜²æ­¢å¹»è¯»çš„å‘ç”Ÿã€‚Next-Key Lock æ˜¯è¡Œé”å’Œé—´éš™é”çš„ç»„åˆï¼Œå½“ InnoDB æ‰«æç´¢å¼•è®°å½•çš„æ—¶å€™ï¼Œä¼šé¦–å…ˆå¯¹ç´¢å¼•è®°å½•åŠ ä¸Šè¡Œé”ï¼ˆRecord Lockï¼‰ï¼Œå†å¯¹ç´¢å¼•è®°å½•ä¸¤è¾¹çš„é—´éš™åŠ ä¸Šé—´éš™é”ï¼ˆGap Lockï¼‰ã€‚åŠ ä¸Šé—´éš™é”ä¹‹åï¼Œå…¶ä»–äº‹åŠ¡å°±ä¸èƒ½åœ¨è¿™ä¸ªé—´éš™ä¿®æ”¹æˆ–è€…æ’å…¥è®°å½•ã€‚</p><p>å¦‚æœä¸€ä¸ªç´¢å¼•æœ‰10ï¼Œ11ï¼Œ13å’Œ20è¿™å››ä¸ªå€¼ï¼Œé‚£ä¹ˆè¯¥ç´¢å¼•å¯èƒ½è¢«Next-key Lockingçš„åŒºé—´ä¸ºï¼š</p><pre><code>(-âˆ,10](10,11](11,13](13,20](20,ï¼‹âˆ]</code></pre><p>è‹¥äº‹åŠ¡T1å·²ç»é”å®šäº†å¦‚ä¸‹èŒƒå›´ï¼š</p><p><code>(10,11]</code>ï¼Œ<code>(11,13]</code></p><p>åˆ™æ’å…¥æ–°çš„è®°å½•12æ—¶ï¼Œé”å®šçš„èŒƒå›´ä¼šå˜æˆï¼š</p><p><code>(10,11]</code>ï¼Œ<code>(11,12]</code>ï¼Œ<code>(12,13]</code></p><p>å½“æŸ¥è¯¢çš„ç´¢å¼•å«æœ‰å”¯ä¸€å±æ€§æ—¶ï¼ŒInnoDBå­˜å‚¨å¼•æ“ä¼šå¯¹Next-key Lockè¿›è¡Œä¼˜åŒ–ï¼Œå°†å…¶é™çº§ä¸ºRecord lockï¼Œå³ä»…é”ä½ç´¢å¼•æœ¬èº«ï¼Œè€Œä¸æ˜¯èŒƒå›´ã€‚</p><h3 id="å¦‚ä½•ç†è§£ä¸‰ç§ç®—æ³•">3.3.4 å¦‚ä½•ç†è§£ä¸‰ç§ç®—æ³•</h3><p>æˆ‘è¿™é‡Œè°ˆè°ˆæˆ‘è‡ªå·±çš„ç†è§£ï¼š</p><p>å¯¹äºå”¯ä¸€ç´¢å¼•ï¼ˆæ¯”å¦‚ä¸»é”®ï¼‰ï¼Œåªè¦ä¿è¯é”ä½è¯¥ç´¢å¼•è®°å½•ï¼Œå°±ä¸å¯èƒ½å‡ºç°å¹»è¯»ï¼Œè¿™å¯¹åº”çš„å°±æ˜¯Record Lock</p><p>æ¯”å¦‚å¯¹äºsqlæŸ¥è¯¢</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_user <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">5</span> <span class="token keyword">for</span> <span class="token keyword">update</span><span class="token punctuation">;</span></code></pre><p>è¿™ç§æƒ…å†µå°±åªä¼šåŠ ä¸€ä¸ªRecord Lockï¼Œç¬¬ä¸€æ¬¡æŸ¥è¯¢æ•°æ®ä¹‹åé”ä½äº†è¯¥è®°å½•ï¼Œæ­¤ååœ¨åŒä¸€äº‹åŠ¡å†…ä¸€ç›´åˆ°ç¬¬äºŒæ¬¡æŸ¥è¯¢ä¸å¯èƒ½ä¼šå‡ºç°å…¶ä»–äº‹åŠ¡ä¹Ÿå°†å…¶ä»–è®°å½•æ’å…¥åˆ°id = 5è¿™ä¸ªä½ç½®ã€‚</p><p>è€Œå¦‚æœä¸æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œç¬¬ä¸€æ¬¡æŸ¥è¯¢æ•°æ®ä¹‹åå³ä½¿æ‰€ä½äº†è¯¥è®°å½•ï¼Œä½†å¯èƒ½è¿˜ä¼šæœ‰è®°å½•è¢«æ’åˆ°id = 5è¿™ä¸ªä½ç½®ï¼Œæ‰€ä»¥æ­¤æ—¶éœ€è¦èŒƒå›´ç´¢å¼•ï¼Œé”ä½ç´¢å¼•ä¸º5è¿™ä¸ªå€¼ï¼Œå¯¹äºèŒƒå›´æŸ¥è¯¢ï¼ŒèŒƒå›´ç´¢å¼•æ›´é‡è¦ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è¯¥æ–‡å»ºè®®é…åˆ&lt;a href=&quot;../æ•°æ®åº“ç†è®ºä¹‹å¹¶å‘æ§åˆ¶/&quot;&gt;æ•°æ®åº“ç†è®ºä¹‹å¹¶å‘æ§åˆ¶&lt;/a&gt;é˜…è¯»ã€‚&lt;/p&gt;
&lt;h1 id=&quot;æ¦‚è¿°&quot;&gt;1 æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;é”æ˜¯è®¡ç®—æœºåè°ƒå¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹å¹¶å‘è®¿é—®æŸä¸€èµ„æºçš„æœºåˆ¶ï¼ˆé¿å…äº‰æŠ¢ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ•°æ®åº“ä¸­ï¼Œé™¤ä¼ ç»Ÿçš„è®¡ç®—èµ„æºï¼ˆå¦‚ CPU
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="æ•°æ®åº“" scheme="https://www.codetool.top/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="MySQL" scheme="https://www.codetool.top/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQLä¹‹å¹¶å‘å‚æ•°è°ƒæ•´</title>
    <link href="https://www.codetool.top/article/MySQL%E4%B9%8B%E5%B9%B6%E5%8F%91%E5%8F%82%E6%95%B0%E8%B0%83%E6%95%B4/"/>
    <id>https://www.codetool.top/article/MySQLä¹‹å¹¶å‘å‚æ•°è°ƒæ•´/</id>
    <published>2020-03-06T08:56:08.000Z</published>
    <updated>2020-03-06T09:23:45.404Z</updated>
    
    <content type="html"><![CDATA[<p>ä»å®ç°ä¸Šæ¥è¯´ï¼ŒMySQL Server æ˜¯å¤šçº¿ç¨‹ç»“æ„ï¼ŒåŒ…æ‹¬åå°çº¿ç¨‹å’Œå®¢æˆ·æœåŠ¡çº¿ç¨‹ã€‚å¤šçº¿ç¨‹å¯ä»¥æœ‰æ•ˆåˆ©ç”¨æœåŠ¡å™¨èµ„æºï¼Œæé«˜æ•°æ®åº“çš„å¹¶å‘æ€§èƒ½ã€‚åœ¨Mysqlä¸­ï¼Œæ§åˆ¶å¹¶å‘è¿æ¥å’Œçº¿ç¨‹çš„ä¸»è¦å‚æ•°åŒ…æ‹¬ <code>max_connections</code>ã€<code>back_log</code>ã€<code>thread_cache_size</code>ã€<code>table_open_cahce</code>ã€‚</p><h1 id="max-connections">1 max_connections</h1><p>é‡‡ç”¨max_connections æ§åˆ¶å…è®¸è¿æ¥åˆ°MySQLæ•°æ®åº“çš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤å€¼æ˜¯ 151ã€‚<strong>å¦‚æœçŠ¶æ€å˜é‡ <code>connection_errors_max_connections</code> ä¸ä¸ºé›¶ï¼Œå¹¶ä¸”ä¸€ç›´å¢é•¿ï¼Œåˆ™è¯´æ˜ä¸æ–­æœ‰è¿æ¥è¯·æ±‚å› æ•°æ®åº“è¿æ¥æ•°å·²è¾¾åˆ°å…è®¸æœ€å¤§å€¼è€Œå¤±è´¥</strong>ï¼Œè¿™æ—¶å¯ä»¥è€ƒè™‘å¢å¤§<code>max_connections</code> çš„å€¼ã€‚</p><p>Mysql æœ€å¤§å¯æ”¯æŒçš„è¿æ¥æ•°ï¼Œå–å†³äºå¾ˆå¤šå› ç´ ï¼ŒåŒ…æ‹¬ç»™å®šæ“ä½œç³»ç»Ÿå¹³å°çš„çº¿ç¨‹åº“çš„è´¨é‡ã€å†…å­˜å¤§å°ã€æ¯ä¸ªè¿æ¥çš„è´Ÿè·ã€CPUçš„å¤„ç†é€Ÿåº¦ï¼ŒæœŸæœ›çš„å“åº”æ—¶é—´ç­‰ã€‚åœ¨Linux å¹³å°ä¸‹ï¼Œæ€§èƒ½å¥½çš„æœåŠ¡å™¨ï¼Œæ”¯æŒ 500-1000 ä¸ªè¿æ¥ä¸æ˜¯éš¾äº‹ï¼Œéœ€è¦æ ¹æ®æœåŠ¡å™¨æ€§èƒ½è¿›è¡Œè¯„ä¼°è®¾å®šã€‚</p><h1 id="back-log">2 back_log</h1><p><code>back_log</code> å‚æ•°æ§åˆ¶MySQLç›‘å¬TCPç«¯å£æ—¶è®¾ç½®çš„ç§¯å‹è¯·æ±‚æ ˆå¤§å°ã€‚<strong>å¦‚æœMySqlçš„è¿æ¥æ•°è¾¾åˆ°<code>max_connections</code>æ—¶ï¼Œæ–°æ¥çš„è¯·æ±‚å°†ä¼šè¢«å­˜åœ¨å †æ ˆä¸­ï¼Œä»¥ç­‰å¾…æŸä¸€è¿æ¥é‡Šæ”¾èµ„æºï¼Œè¯¥å †æ ˆçš„æ•°é‡å³<code>back_log</code></strong>ï¼Œå¦‚æœç­‰å¾…è¿æ¥çš„æ•°é‡è¶…è¿‡back_logï¼Œå°†ä¸è¢«æˆäºˆè¿æ¥èµ„æºï¼Œå°†ä¼šæŠ¥é”™ã€‚5.6.6 ç‰ˆæœ¬ä¹‹å‰é»˜è®¤å€¼ä¸º 50 ï¼Œ ä¹‹åçš„ç‰ˆæœ¬é»˜è®¤ä¸º <code>50 + ï¼ˆmax_connections / 5ï¼‰</code>ï¼Œ ä½†æœ€å¤§ä¸è¶…è¿‡900ã€‚</p><p>å¦‚æœéœ€è¦æ•°æ®åº“åœ¨è¾ƒçŸ­çš„æ—¶é—´å†…å¤„ç†å¤§é‡è¿æ¥è¯·æ±‚ï¼Œ å¯ä»¥è€ƒè™‘é€‚å½“å¢å¤§back_log çš„å€¼ã€‚</p><h1 id="table-open-cache">3 table_open_cache</h1><p>è¯¥å‚æ•°ç”¨æ¥æ§åˆ¶æ‰€æœ‰SQLè¯­å¥æ‰§è¡Œçº¿ç¨‹å¯æ‰“å¼€è¡¨ç¼“å­˜çš„æ•°é‡ï¼Œ è€Œåœ¨æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼Œæ¯ä¸€ä¸ªSQLæ‰§è¡Œçº¿ç¨‹è‡³å°‘è¦æ‰“å¼€ 1 ä¸ªè¡¨ç¼“å­˜ã€‚è¯¥å‚æ•°çš„å€¼åº”è¯¥æ ¹æ®è®¾ç½®çš„æœ€å¤§è¿æ¥æ•° max_connections ä»¥åŠæ¯ä¸ªè¿æ¥æ‰§è¡Œå…³è”æŸ¥è¯¢ä¸­æ¶‰åŠçš„è¡¨çš„æœ€å¤§æ•°é‡æ¥è®¾å®š ï¼š</p><p>â€‹<code>max_connections x N</code></p><h1 id="thread-cache-size">4 thread_cache_size</h1><p>ä¸ºäº†åŠ å¿«è¿æ¥æ•°æ®åº“çš„é€Ÿåº¦ï¼ŒMySQL ä¼š<strong>ç¼“å­˜ä¸€å®šæ•°é‡çš„å®¢æˆ·æœåŠ¡çº¿ç¨‹</strong>ä»¥å¤‡é‡ç”¨ï¼Œé€šè¿‡å‚æ•° <code>thread_cache_size</code> å¯æ§åˆ¶ MySQL ç¼“å­˜å®¢æˆ·æœåŠ¡çº¿ç¨‹çš„æ•°é‡ã€‚</p><h1 id="innodb-lock-wait-timeout">5 innodb_lock_wait_timeout</h1><p>è¯¥å‚æ•°æ˜¯ç”¨æ¥è®¾ç½®InnoDB äº‹åŠ¡<strong>ç­‰å¾…è¡Œé”çš„æ—¶é—´</strong>ï¼Œé»˜è®¤å€¼æ˜¯50ms ï¼Œ å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡ŒåŠ¨æ€è®¾ç½®ã€‚å¯¹äºéœ€è¦å¿«é€Ÿåé¦ˆçš„ä¸šåŠ¡ç³»ç»Ÿæ¥è¯´ï¼Œå¯ä»¥å°†è¡Œé”çš„ç­‰å¾…æ—¶é—´è°ƒå°ï¼Œä»¥é¿å…äº‹åŠ¡é•¿æ—¶é—´æŒ‚èµ·ï¼› å¯¹äºåå°è¿è¡Œçš„æ‰¹é‡å¤„ç†ç¨‹åºæ¥è¯´ï¼Œ å¯ä»¥å°†è¡Œé”çš„ç­‰å¾…æ—¶é—´è°ƒå¤§ï¼Œ ä»¥é¿å…å‘ç”Ÿå¤§çš„å›æ»šæ“ä½œã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä»å®ç°ä¸Šæ¥è¯´ï¼ŒMySQL Server æ˜¯å¤šçº¿ç¨‹ç»“æ„ï¼ŒåŒ…æ‹¬åå°çº¿ç¨‹å’Œå®¢æˆ·æœåŠ¡çº¿ç¨‹ã€‚å¤šçº¿ç¨‹å¯ä»¥æœ‰æ•ˆåˆ©ç”¨æœåŠ¡å™¨èµ„æºï¼Œæé«˜æ•°æ®åº“çš„å¹¶å‘æ€§èƒ½ã€‚åœ¨Mysqlä¸­ï¼Œæ§åˆ¶å¹¶å‘è¿æ¥å’Œçº¿ç¨‹çš„ä¸»è¦å‚æ•°åŒ…æ‹¬ &lt;code&gt;max_connections&lt;/code&gt;ã€&lt;code&gt;back_log&lt;/
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="ä¼˜åŒ–" scheme="https://www.codetool.top/tags/%E4%BC%98%E5%8C%96/"/>
    
      <category term="æ•°æ®åº“" scheme="https://www.codetool.top/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="MySQL" scheme="https://www.codetool.top/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQLä¹‹å†…å­˜ç®¡ç†å’Œä¼˜åŒ–</title>
    <link href="https://www.codetool.top/article/MySQL%E4%B9%8B%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%92%8C%E4%BC%98%E5%8C%96/"/>
    <id>https://www.codetool.top/article/MySQLä¹‹å†…å­˜ç®¡ç†å’Œä¼˜åŒ–/</id>
    <published>2020-03-06T08:55:28.000Z</published>
    <updated>2020-03-06T09:26:59.592Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å†…å­˜ä¼˜åŒ–åŸåˆ™">1 å†…å­˜ä¼˜åŒ–åŸåˆ™</h1><ol><li><p>å°†å°½é‡å¤šçš„å†…å­˜åˆ†é…ç»™MySQLåšç¼“å­˜ï¼Œä½†è¦ç»™æ“ä½œç³»ç»Ÿå’Œå…¶ä»–ç¨‹åºé¢„ç•™è¶³å¤Ÿå†…å­˜ã€‚</p></li><li><p>MyISAM å­˜å‚¨å¼•æ“çš„æ•°æ®æ–‡ä»¶è¯»å–ä¾èµ–äºæ“ä½œç³»ç»Ÿè‡ªèº«çš„IOç¼“å­˜ï¼Œå› æ­¤ï¼Œå¦‚æœæœ‰MyISAMè¡¨ï¼Œå°±è¦é¢„ç•™æ›´å¤šçš„å†…å­˜ç»™æ“ä½œç³»ç»ŸåšIOç¼“å­˜ã€‚</p></li><li><p>æ’åºåŒºã€è¿æ¥åŒºç­‰ç¼“å­˜æ˜¯åˆ†é…ç»™æ¯ä¸ªæ•°æ®åº“ä¼šè¯ï¼ˆsessionï¼‰ä¸“ç”¨çš„ï¼Œå…¶é»˜è®¤å€¼çš„è®¾ç½®è¦æ ¹æ®æœ€å¤§è¿æ¥æ•°åˆç†åˆ†é…ï¼Œå¦‚æœè®¾ç½®å¤ªå¤§ï¼Œä¸ä½†æµªè´¹èµ„æºï¼Œè€Œä¸”åœ¨å¹¶å‘è¿æ¥è¾ƒé«˜æ—¶ä¼šå¯¼è‡´ç‰©ç†å†…å­˜è€—å°½ã€‚</p></li></ol><h1 id="MyISAM-å†…å­˜ä¼˜åŒ–">2 MyISAM å†…å­˜ä¼˜åŒ–</h1><p>MyISAMå­˜å‚¨å¼•æ“ä½¿ç”¨ <code>key_buffer</code> ç¼“å­˜<strong>ç´¢å¼•å—</strong>ï¼ŒåŠ é€ŸMyISAMç´¢å¼•çš„è¯»å†™é€Ÿåº¦ã€‚<strong>å¯¹äºMyISAMè¡¨çš„æ•°æ®å—ï¼Œmysqlæ²¡æœ‰ç‰¹åˆ«çš„ç¼“å­˜æœºåˆ¶ï¼Œå®Œå…¨ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„IOç¼“å­˜ã€‚</strong></p><h2 id="key-buffer-size">2.1 key_buffer_size</h2><p><strong><code>key_buffer_size</code>å†³å®šMyISAMç´¢å¼•å—ç¼“å­˜åŒºçš„å¤§å°ï¼Œç›´æ¥å½±å“åˆ°MyISAMè¡¨çš„å­˜å–æ•ˆç‡ã€‚</strong>å¯ä»¥åœ¨MySQLå‚æ•°æ–‡ä»¶ä¸­è®¾ç½®<code>key_buffer_size</code>çš„å€¼ï¼Œå¯¹äºä¸€èˆ¬MyISAMæ•°æ®åº“ï¼Œå»ºè®®è‡³å°‘å°†<code>1/4</code>å¯ç”¨å†…å­˜åˆ†é…ç»™<code>key_buffer_size</code>ã€‚</p><p>åœ¨é…ç½®æ–‡ä»¶ä¸­åšå¦‚ä¸‹é…ç½®ï¼š</p><pre><code>key_buffer_size=512M</code></pre><h2 id="read-buffer-size">2.2 read_buffer_size</h2><p>ä¸ºéœ€è¦å…¨è¡¨æ‰«æçš„MYISAMæ•°æ®è¡¨çº¿ç¨‹æŒ‡å®šç¼“å­˜ã€‚</p><p>å¦‚æœéœ€è¦ç»å¸¸é¡ºåºæ‰«æMyISAMè¡¨ï¼Œå¯ä»¥é€šè¿‡å¢å¤§<code>read_buffer_size</code>çš„å€¼æ¥æ”¹å–„æ€§èƒ½ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯<code>read_buffer_size</code>æ˜¯æ¯ä¸ªsessionç‹¬å çš„ï¼Œå¦‚æœé»˜è®¤å€¼è®¾ç½®å¤ªå¤§ï¼Œå°±ä¼šé€ æˆå†…å­˜æµªè´¹ã€‚</p><h2 id="read-rnd-buffer-size">2.3 read_rnd_buffer_size</h2><p>å¯¹äºéœ€è¦åšæ’åºçš„MyISAMè¡¨çš„æŸ¥è¯¢ï¼Œå¦‚å¸¦æœ‰order byå­å¥çš„sqlï¼Œé€‚å½“å¢åŠ  <code>read_rnd_buffer_size</code> çš„å€¼ï¼Œå¯ä»¥æ”¹å–„æ­¤ç±»çš„sqlæ€§èƒ½ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ <code>read_rnd_buffer_size</code> æ˜¯æ¯ä¸ªsessionç‹¬å çš„ï¼Œå¦‚æœé»˜è®¤å€¼è®¾ç½®å¤ªå¤§ï¼Œå°±ä¼šé€ æˆå†…å­˜æµªè´¹ã€‚</p><h1 id="InnoDB-å†…å­˜ä¼˜åŒ–">3 InnoDB å†…å­˜ä¼˜åŒ–</h1><p>InnoDBç”¨ä¸€å—å†…å­˜åŒºåšIOç¼“å­˜æ± ï¼Œè¯¥ç¼“å­˜æ± ä¸ä»…ç”¨æ¥ç¼“å­˜InnoDBçš„ç´¢å¼•å—ï¼Œè€Œä¸”ä¹Ÿç”¨æ¥ç¼“å­˜InnoDBçš„æ•°æ®å—ã€‚</p><h2 id="innodb-buffer-pool-size">3.1 innodb_buffer_pool_size</h2><p>è¯¥å˜é‡å†³å®šäº† <strong>InnoDB å­˜å‚¨å¼•æ“è¡¨æ•°æ®å’Œç´¢å¼•æ•°æ®çš„æœ€å¤§ç¼“å­˜åŒºå¤§å°</strong>ã€‚åœ¨ä¿è¯æ“ä½œç³»ç»ŸåŠå…¶ä»–ç¨‹åºæœ‰è¶³å¤Ÿå†…å­˜å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œ<code>innodb_buffer_pool_size</code> çš„å€¼è¶Šå¤§ï¼Œç¼“å­˜å‘½ä¸­ç‡è¶Šé«˜ï¼Œè®¿é—®InnoDBè¡¨éœ€è¦çš„ç£ç›˜I/O å°±è¶Šå°‘ï¼Œæ€§èƒ½ä¹Ÿå°±è¶Šé«˜ã€‚</p><pre><code>innodb_buffer_pool_size=512M</code></pre><h2 id="innodb-log-buffer-size">3.2 innodb_log_buffer_size</h2><p>å†³å®šäº†<strong>InnoDBé‡åšæ—¥å¿—ç¼“å­˜çš„å¤§å°</strong>ï¼Œå¯¹äºå¯èƒ½äº§ç”Ÿå¤§é‡æ›´æ–°è®°å½•çš„å¤§äº‹åŠ¡ï¼Œå¢åŠ <code>innodb_log_buffer_size</code> çš„å¤§å°ï¼Œå¯ä»¥é¿å…InnoDBåœ¨äº‹åŠ¡æäº¤å‰å°±æ‰§è¡Œä¸å¿…è¦çš„æ—¥å¿—å†™å…¥ç£ç›˜æ“ä½œã€‚</p><pre><code>innodb_log_buffer_size=10M</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å†…å­˜ä¼˜åŒ–åŸåˆ™&quot;&gt;1 å†…å­˜ä¼˜åŒ–åŸåˆ™&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;å°†å°½é‡å¤šçš„å†…å­˜åˆ†é…ç»™MySQLåšç¼“å­˜ï¼Œä½†è¦ç»™æ“ä½œç³»ç»Ÿå’Œå…¶ä»–ç¨‹åºé¢„ç•™è¶³å¤Ÿå†…å­˜ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MyISAM å­˜å‚¨å¼•æ“çš„æ•°æ®æ–‡ä»¶è¯»å–ä¾èµ–äºæ“ä½œç³»ç»Ÿè‡ªèº«çš„IOç¼“å­˜ï¼Œå› æ­¤ï¼Œå¦‚æœæœ‰MyIS
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="ä¼˜åŒ–" scheme="https://www.codetool.top/tags/%E4%BC%98%E5%8C%96/"/>
    
      <category term="æ•°æ®åº“" scheme="https://www.codetool.top/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="MySQL" scheme="https://www.codetool.top/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQLä¹‹æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–</title>
    <link href="https://www.codetool.top/article/MySQL%E4%B9%8B%E6%9F%A5%E8%AF%A2%E7%BC%93%E5%AD%98%E4%BC%98%E5%8C%96/"/>
    <id>https://www.codetool.top/article/MySQLä¹‹æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–/</id>
    <published>2020-03-06T08:53:20.000Z</published>
    <updated>2020-03-06T09:27:09.142Z</updated>
    
    <content type="html"><![CDATA[<p>å¼€å¯Mysqlçš„æŸ¥è¯¢ç¼“å­˜ï¼Œå½“æ‰§è¡Œå®Œå…¨ç›¸åŒçš„SQLè¯­å¥çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨å°±ä¼šç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–ç»“æœï¼Œå½“æ•°æ®è¢«ä¿®æ”¹ï¼Œä¹‹å‰çš„ç¼“å­˜ä¼šå¤±æ•ˆï¼Œä¿®æ”¹æ¯”è¾ƒé¢‘ç¹çš„è¡¨ä¸é€‚åˆåšæŸ¥è¯¢ç¼“å­˜ã€‚</p><p><img src="https://api.codetool.top/img/1583475530312.png" alt></p><h1 id="æŸ¥è¯¢ç¼“å­˜é…ç½®">1 æŸ¥è¯¢ç¼“å­˜é…ç½®</h1><p>æŸ¥çœ‹å½“å‰çš„MySQLæ•°æ®åº“æ˜¯å¦æ”¯æŒæŸ¥è¯¢ç¼“å­˜ï¼š</p><pre><code>mysql&gt; SHOW VARIABLES LIKE &#39;have_query_cache&#39;;+------------------+-------+| Variable_name    | Value |+------------------+-------+| have_query_cache | YES   |+------------------+-------+1 row in set (0.01 sec)</code></pre><p>æŸ¥çœ‹å½“å‰MySQLæ˜¯å¦å¼€å¯äº†æŸ¥è¯¢ç¼“å­˜ ï¼š</p><pre><code>mysql&gt; SHOW VARIABLES LIKE &#39;query_cache_type&#39;;+------------------+-------+| Variable_name    | Value |+------------------+-------+| query_cache_type | OFF   |+------------------+-------+1 row in set (0.01 sec)</code></pre><p>æŸ¥çœ‹æŸ¥è¯¢ç¼“å­˜çš„å ç”¨å¤§å° ï¼š</p><pre><code>mysql&gt; SHOW VARIABLES LIKE &#39;query_cache_size&#39;;+------------------+----------+| Variable_name    | Value    |+------------------+----------+| query_cache_size | 16777216 |+------------------+----------+1 row in set (0.00 sec)</code></pre><p>æŸ¥çœ‹æŸ¥è¯¢ç¼“å­˜çš„çŠ¶æ€å˜é‡ï¼š</p><pre><code>mysql&gt; SHOW STATUS LIKE &#39;Qcache%&#39;;+-------------------------+----------+| Variable_name           | Value    |+-------------------------+----------+| Qcache_free_blocks      | 1        || Qcache_free_memory      | 16760152 || Qcache_hits             | 0        || Qcache_inserts          | 0        || Qcache_lowmem_prunes    | 0        || Qcache_not_cached       | 1        || Qcache_queries_in_cache | 0        || Qcache_total_blocks     | 1        |+-------------------------+----------+8 rows in set (0.00 sec)</code></pre><p>å„ä¸ªå˜é‡çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><table><thead><tr><th>å‚æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>Qcache_free_blocks</td><td>æŸ¥è¯¢ç¼“å­˜ä¸­çš„å¯ç”¨å†…å­˜å—æ•°</td></tr><tr><td>Qcache_free_memory</td><td>æŸ¥è¯¢ç¼“å­˜çš„å¯ç”¨å†…å­˜é‡</td></tr><tr><td>Qcache_hits</td><td>æŸ¥è¯¢ç¼“å­˜å‘½ä¸­æ•°</td></tr><tr><td>Qcache_inserts</td><td>æ·»åŠ åˆ°æŸ¥è¯¢ç¼“å­˜çš„æŸ¥è¯¢æ•°</td></tr><tr><td>Qcache_lowmen_prunes</td><td>ç”±äºå†…å­˜ä¸è¶³è€Œä»æŸ¥è¯¢ç¼“å­˜ä¸­åˆ é™¤çš„æŸ¥è¯¢æ•°</td></tr><tr><td>Qcache_not_cached</td><td>éç¼“å­˜æŸ¥è¯¢çš„æ•°é‡ï¼ˆç”±äº query_cache_type è®¾ç½®è€Œæ— æ³•ç¼“å­˜æˆ–æœªç¼“å­˜ï¼‰</td></tr><tr><td>Qcache_queries_in_cache</td><td>æŸ¥è¯¢ç¼“å­˜ä¸­æ³¨å†Œçš„æŸ¥è¯¢æ•°</td></tr><tr><td>Qcache_total_blocks</td><td>æŸ¥è¯¢ç¼“å­˜ä¸­çš„å—æ€»æ•°</td></tr></tbody></table><h1 id="å¼€å¯æŸ¥è¯¢ç¼“å­˜">2 å¼€å¯æŸ¥è¯¢ç¼“å­˜</h1><p>MySQLçš„æŸ¥è¯¢ç¼“å­˜é»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦æ‰‹åŠ¨é…ç½®å‚æ•° query_cache_type ï¼Œ æ¥å¼€å¯æŸ¥è¯¢ç¼“å­˜ã€‚query_cache_type è¯¥å‚æ•°çš„å¯å–å€¼æœ‰ä¸‰ä¸ªï¼š</p><table><thead><tr><th>å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>OFF æˆ– 0</td><td>æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½å…³é—­</td></tr><tr><td>ON æˆ– 1</td><td>æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½æ‰“å¼€ï¼ŒSELECTçš„ç»“æœç¬¦åˆç¼“å­˜æ¡ä»¶å³ä¼šç¼“å­˜ï¼Œå¦åˆ™ï¼Œä¸äºˆç¼“å­˜ï¼Œæ˜¾å¼æŒ‡å®š SQL_NO_CACHEï¼Œä¸äºˆç¼“å­˜</td></tr><tr><td>DEMAND æˆ– 2</td><td>æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½æŒ‰éœ€è¿›è¡Œï¼Œæ˜¾å¼æŒ‡å®š SQL_CACHE çš„SELECTè¯­å¥æ‰ä¼šç¼“å­˜ï¼›å…¶å®ƒå‡ä¸äºˆç¼“å­˜</td></tr></tbody></table><p><img src="https://api.codetool.top/img/15834798798264.png" alt="é…ç½®ç¼“å­˜ç›¸å…³å‚æ•°"></p><p>é…ç½®å®Œæ¯•ä¹‹åï¼Œé‡å¯æœåŠ¡æ—¢å¯ç”Ÿæ•ˆ ï¼›</p><p>ç„¶åå°±å¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡ŒSQLè¯­å¥è¿›è¡ŒéªŒè¯ ï¼Œæ‰§è¡Œä¸€æ¡æ¯”è¾ƒè€—æ—¶çš„SQLè¯­å¥ï¼Œç„¶åå†å¤šæ‰§è¡Œå‡ æ¬¡ï¼ŒæŸ¥çœ‹åé¢å‡ æ¬¡çš„æ‰§è¡Œæ—¶é—´ï¼›è·å–é€šè¿‡æŸ¥çœ‹æŸ¥è¯¢ç¼“å­˜çš„ç¼“å­˜å‘½ä¸­æ•°ï¼Œæ¥åˆ¤å®šæ˜¯å¦èµ°æŸ¥è¯¢ç¼“å­˜ã€‚</p><h1 id="æŸ¥è¯¢ç¼“å­˜SELECTé€‰é¡¹">3 æŸ¥è¯¢ç¼“å­˜SELECTé€‰é¡¹</h1><p>å¯ä»¥åœ¨SELECTè¯­å¥ä¸­æŒ‡å®šä¸¤ä¸ªä¸æŸ¥è¯¢ç¼“å­˜ç›¸å…³çš„é€‰é¡¹ ï¼š</p><p><code>SQL_CACHE</code> : å¦‚æœæŸ¥è¯¢ç»“æœæ˜¯å¯ç¼“å­˜çš„ï¼Œå¹¶ä¸” query_cache_type ç³»ç»Ÿå˜é‡çš„å€¼ä¸ºONæˆ– DEMAND ï¼Œåˆ™ç¼“å­˜æŸ¥è¯¢ç»“æœ ã€‚</p><p><code>SQL_NO_CACHE</code> : æœåŠ¡å™¨ä¸ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚å®ƒæ—¢ä¸æ£€æŸ¥æŸ¥è¯¢ç¼“å­˜ï¼Œä¹Ÿä¸æ£€æŸ¥ç»“æœæ˜¯å¦å·²ç¼“å­˜ï¼Œä¹Ÿä¸ç¼“å­˜æŸ¥è¯¢ç»“æœã€‚</p><p>ä¾‹å­ï¼š</p><pre class=" language-SQL"><code class="language-SQL">SELECT SQL_CACHE id, name FROM customer;SELECT SQL_NO_CACHE id, name FROM customer;</code></pre><h1 id="æŸ¥è¯¢ç¼“å­˜å¤±æ•ˆçš„æƒ…å†µ">4 æŸ¥è¯¢ç¼“å­˜å¤±æ•ˆçš„æƒ…å†µ</h1><h2 id="SQL-è¯­å¥ä¸ä¸€è‡´">4.1 SQL è¯­å¥ä¸ä¸€è‡´</h2><p>è¦æƒ³å‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼ŒæŸ¥è¯¢çš„SQLè¯­å¥å¿…é¡»ä¸€è‡´ã€‚</p><pre class=" language-SQL"><code class="language-SQL">SQL1 : select count(*) from tb_item;SQL2 : Select count(*) from tb_item;</code></pre><p>åŒºåˆ†å¤§å°å†™</p><h2 id="å½“æŸ¥è¯¢è¯­å¥ä¸­ç”¨åˆ°äº†å‡½æ•°">4.2 å½“æŸ¥è¯¢è¯­å¥ä¸­ç”¨åˆ°äº†å‡½æ•°</h2><pre class=" language-SQL"><code class="language-SQL">SQL1 : select * from tb_item where updatetime < now() limit 1;SQL2 : select user();SQL3 : select database();</code></pre><p>è¿™äº›è‡ªå¸¦å‡½æ•°æ¯æ¬¡æŸ¥è¯¢éƒ½æ˜¯ä¸ç¡®å®šçš„ï¼Œä¸ä¼šä½¿ç”¨ç¼“å­˜ã€‚</p><h2 id="ä¸ä½¿ç”¨ä»»ä½•è¡¨æŸ¥è¯¢è¯­å¥">4.3 ä¸ä½¿ç”¨ä»»ä½•è¡¨æŸ¥è¯¢è¯­å¥</h2><pre class=" language-SQL"><code class="language-SQL">select 'A';</code></pre><h2 id="æŸ¥è¯¢ç³»ç»Ÿæ•°æ®åº“">4.4 æŸ¥è¯¢ç³»ç»Ÿæ•°æ®åº“</h2><p>æŸ¥è¯¢ mysqlï¼Œ information_schemaæˆ–  performance_schema æ•°æ®åº“ä¸­çš„è¡¨æ—¶ï¼Œä¸ä¼šèµ°æŸ¥è¯¢ç¼“å­˜ã€‚</p><pre class=" language-SQL"><code class="language-SQL">select * from information_schema.engines;</code></pre><h2 id="åœ¨å­˜å‚¨çš„å‡½æ•°ï¼Œè§¦å‘å™¨æˆ–äº‹ä»¶çš„ä¸»ä½“å†…æ‰§è¡Œçš„æŸ¥è¯¢">4.5 åœ¨å­˜å‚¨çš„å‡½æ•°ï¼Œè§¦å‘å™¨æˆ–äº‹ä»¶çš„ä¸»ä½“å†…æ‰§è¡Œçš„æŸ¥è¯¢</h2><h2 id="è¡¨æ›´æ”¹">4.6 è¡¨æ›´æ”¹</h2><p>å¦‚æœè¡¨æ›´æ”¹ï¼Œåˆ™ä½¿ç”¨è¯¥è¡¨çš„æ‰€æœ‰é«˜é€Ÿç¼“å­˜æŸ¥è¯¢éƒ½å°†å˜ä¸ºæ— æ•ˆå¹¶ä»é«˜é€Ÿç¼“å­˜ä¸­åˆ é™¤ã€‚è¿™åŒ…æ‹¬ä½¿ç”¨<code>MERGE</code>æ˜ å°„åˆ°å·²æ›´æ”¹è¡¨çš„è¡¨çš„æŸ¥è¯¢ã€‚ä¸€ä¸ªè¡¨å¯ä»¥è¢«è®¸å¤šç±»å‹çš„è¯­å¥æ”¹å˜, å¦‚ <code>INSERT</code>ï¼Œ <code>UPDATE</code>ï¼Œ <code>DELETE</code>ï¼Œ <code>TRUNCATE TABLE</code>ï¼Œ <code>ALTER TABLE</code>ï¼Œ <code>DROP TABLE</code>ï¼Œæˆ– <code>DROP DATABASE</code> ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å¼€å¯Mysqlçš„æŸ¥è¯¢ç¼“å­˜ï¼Œå½“æ‰§è¡Œå®Œå…¨ç›¸åŒçš„SQLè¯­å¥çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨å°±ä¼šç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–ç»“æœï¼Œå½“æ•°æ®è¢«ä¿®æ”¹ï¼Œä¹‹å‰çš„ç¼“å­˜ä¼šå¤±æ•ˆï¼Œä¿®æ”¹æ¯”è¾ƒé¢‘ç¹çš„è¡¨ä¸é€‚åˆåšæŸ¥è¯¢ç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://api.codetool.top/img/15834755303
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="ä¼˜åŒ–" scheme="https://www.codetool.top/tags/%E4%BC%98%E5%8C%96/"/>
    
      <category term="æ•°æ®åº“" scheme="https://www.codetool.top/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="MySQL" scheme="https://www.codetool.top/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>å‰‘æŒ‡offer57-å’Œä¸ºsçš„è¿ç»­æ­£æ•°åºåˆ—</title>
    <link href="https://www.codetool.top/article/%E5%89%91%E6%8C%87offer57-%E5%92%8C%E4%B8%BAs%E7%9A%84%E8%BF%9E%E7%BB%AD%E6%AD%A3%E6%95%B0%E5%BA%8F%E5%88%97/"/>
    <id>https://www.codetool.top/article/å‰‘æŒ‡offer57-å’Œä¸ºsçš„è¿ç»­æ­£æ•°åºåˆ—/</id>
    <published>2020-03-05T17:01:12.000Z</published>
    <updated>2020-03-05T17:04:48.394Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸé¢˜">1 åŸé¢˜</h1><p>è¾“å…¥ä¸€ä¸ªæ­£æ•´æ•° <code>target</code> ï¼Œè¾“å‡ºæ‰€æœ‰å’Œä¸º <code>target</code> çš„è¿ç»­æ­£æ•´æ•°åºåˆ—ï¼ˆè‡³å°‘å«æœ‰ä¸¤ä¸ªæ•°ï¼‰ã€‚</p><p>åºåˆ—å†…çš„æ•°å­—ç”±å°åˆ°å¤§æ’åˆ—ï¼Œä¸åŒåºåˆ—æŒ‰ç…§é¦–ä¸ªæ•°å­—ä»å°åˆ°å¤§æ’åˆ—ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p><strong>è¾“å…¥:</strong> target = 9<br><strong>è¾“å‡º:</strong> [[2,3,4],[4,5]] </p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p><strong>è¾“å…¥:</strong> target = 15<br><strong>è¾“å‡º:</strong> [[1,2,3,4,5],[4,5,6],[7,8]]  </p></blockquote><p><strong>é™åˆ¶ï¼š</strong></p><ul><li><code>1 &lt;= target &lt;= 10^5</code></li></ul><h1 id="è§£æ³•">2 è§£æ³•</h1><h2 id="æ€æƒ³">2.1 æ€æƒ³</h2><p>è¿™é“é¢˜æœ€å¤§çš„å‘å°±æ˜¯ç”¨äºŒç»´æ•°ç»„åšè¿”å›å€¼å§ã€‚ã€‚ç¡®å®è¯­æ³•ä¸ŠæŒºéº»çƒ¦çš„ï¼Œè§£æ³•å°±æ˜¯æ»‘åŠ¨çª—å£ï¼Œä¸€ä¸ªprevä¸€ä¸ªnextï¼Œå¦‚æœå½“å‰åŒºé—´å†…çš„æ‰€æœ‰å€¼çš„å’Œå°äºç›®æ ‡å€¼ï¼Œnextåç§»ä¸€ä½ï¼Œå¦‚æœå¤§äºç›®æ ‡å€¼ï¼Œprevåç§»ä¸€ä½ï¼Œå¦‚æœç­‰äºç›®æ ‡å€¼ï¼ŒæŠŠå½“å‰åŒºé—´å†…çš„æ‰€æœ‰æ•°æ”¾å…¥æ•°ç»„ä¸­å†æ”¾å…¥ä¸€ä¸ªlistä¸­ã€‚</p><p>è¿™æ ·ä¸‹å»ç›´åˆ°prevå¤§äºç›®æ ‡å€¼çš„ä¸€åŠï¼Œå°±å¯ä»¥ç»“æŸå¾ªç¯äº†ï¼Œç„¶åå°†listä¸­æ‰€æœ‰çš„æ•°ç»„å†æè¿›ä¸€ä¸ªæ•°ç»„é‡Œå»ã€‚</p><h2 id="ä»£ç ">2.2 ä»£ç </h2><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">findContinuousSequence</span><span class="token punctuation">(</span><span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> prev <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>next <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>next<span class="token operator">&lt;=</span><span class="token punctuation">(</span>target<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>sum <span class="token operator">></span> target<span class="token punctuation">)</span><span class="token punctuation">{</span>                sum <span class="token operator">=</span> sum<span class="token operator">-</span>prev<span class="token punctuation">;</span>                prev<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>sum <span class="token operator">==</span> target<span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>next<span class="token operator">-</span>prev<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>next<span class="token operator">-</span>prev<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                        nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">+</span>prev<span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                next<span class="token operator">++</span><span class="token punctuation">;</span>                sum <span class="token operator">=</span> sum<span class="token operator">+</span>next<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åŸé¢˜&quot;&gt;1 åŸé¢˜&lt;/h1&gt;&lt;p&gt;è¾“å…¥ä¸€ä¸ªæ­£æ•´æ•° &lt;code&gt;target&lt;/code&gt; ï¼Œè¾“å‡ºæ‰€æœ‰å’Œä¸º &lt;code&gt;target&lt;/code&gt; çš„è¿ç»­æ­£æ•´æ•°åºåˆ—ï¼ˆè‡³å°‘å«æœ‰ä¸¤ä¸ªæ•°ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åºåˆ—å†…çš„æ•°å­—ç”±å°åˆ°å¤§æ’åˆ—ï¼Œä¸åŒåºåˆ—æŒ‰ç…§é¦–ä¸ªæ•°å­—ä»å°åˆ°å¤§æ’åˆ—ã€‚&lt;/p&gt;
      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="ç®—æ³•" scheme="https://www.codetool.top/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="å‰‘æŒ‡offer" scheme="https://www.codetool.top/tags/%E5%89%91%E6%8C%87offer/"/>
    
  </entry>
  
</feed>
