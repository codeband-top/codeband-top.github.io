<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ä»£ç æ®µå°ç«™</title>
  <icon>https://www.gravatar.com/avatar/4c71a513a84e4d430b9f9aed224237fc</icon>
  <subtitle>CodeTool - ä¸ªäººè®¡ç®—æœºç±»ç»ƒæ‰‹å°åšå®¢</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.codetool.top/"/>
  <updated>2020-03-31T07:38:50.538Z</updated>
  <id>https://www.codetool.top/</id>
  
  <author>
    <name>Rhett Peng</name>
    <email>pctdyx@qq.net</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸFastDFSçš„äº†è§£åŠJavaå®¢æˆ·ç«¯ä½¿ç”¨</title>
    <link href="https://www.codetool.top/article/%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9FFastDFS%E7%9A%84%E4%BA%86%E8%A7%A3%E5%8F%8AJava%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BD%BF%E7%94%A8/"/>
    <id>https://www.codetool.top/article/åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸFastDFSçš„äº†è§£åŠJavaå®¢æˆ·ç«¯ä½¿ç”¨/</id>
    <published>2020-03-31T07:38:50.000Z</published>
    <updated>2020-03-31T07:38:50.538Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>leetcode912-æ’åºæ•°ç»„</title>
    <link href="https://www.codetool.top/article/leetcode912-%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84/"/>
    <id>https://www.codetool.top/article/leetcode912-æ’åºæ•°ç»„/</id>
    <published>2020-03-31T01:24:36.000Z</published>
    <updated>2020-03-31T01:35:03.065Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸé¢˜">1 åŸé¢˜</h1><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>ï¼Œå°†è¯¥æ•°ç»„å‡åºæ’åˆ—ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p><strong>è¾“å…¥ï¼š</strong> [5,2,3,1]<br><strong>è¾“å‡ºï¼š</strong> [1,2,3,5]  </p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p><strong>è¾“å…¥ï¼š</strong> [5,1,1,2,0,0]<br><strong>è¾“å‡ºï¼š</strong> [0,0,1,1,2,5]  </p></blockquote><p><strong>æç¤ºï¼š</strong></p><ol><li><code>1 &lt;= A.length &lt;= 10000</code></li><li><code>-50000 &lt;= A[i] &lt;= 50000</code></li></ol><h1 id="è§£æ³•">2 è§£æ³•</h1><h2 id="æ€æƒ³">2.1 æ€æƒ³</h2><p>ç»å…¸æ’åºé—®é¢˜ï¼Œè§£æ³•è§<a href="../åå¤§æ’åºç®—æ³•ä¸Javaå®ç°">åå¤§æ’åºç®—æ³•ä¸Javaå®ç°</a></p><h2 id="ä»£ç ">2.2 ä»£ç </h2><p>è®¡æ•°æ’åºï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">sortArray</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> occur <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">100001</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token operator">:</span>nums<span class="token punctuation">)</span><span class="token punctuation">{</span>            occur<span class="token punctuation">[</span>num<span class="token operator">+</span><span class="token number">50000</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">100001</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>occur<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> n <span class="token operator">&lt;</span> occur<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>n<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    nums<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">-</span><span class="token number">50000</span><span class="token punctuation">;</span>                    index<span class="token operator">++</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>å¿«é€Ÿæ’åºï¼Œè¿™é‡Œæ¯æ¬¡é€‰å–ä¸­è½´å…ƒç´ éƒ½æ˜¯é€‰å–çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">sortArray</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">quickSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>nums<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">quickSort</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> left<span class="token punctuation">,</span> <span class="token keyword">int</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//è·å–ä¸­è½´å…ƒç´ æ‰€å¤„çš„ä½ç½®</span>            <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token function">partition</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//è¿›è¡Œåˆ†å‰²</span>            arr <span class="token operator">=</span> <span class="token function">quickSort</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> left<span class="token punctuation">,</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            arr <span class="token operator">=</span> <span class="token function">quickSort</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> arr<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">partition</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> left<span class="token punctuation">,</span> <span class="token keyword">int</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//é€‰å–ä¸­è½´å…ƒç´ </span>        <span class="token keyword">int</span> pivot <span class="token operator">=</span> arr<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> left <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> j <span class="token operator">=</span> right<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// å‘å³æ‰¾åˆ°ç¬¬ä¸€ä¸ªå°äºç­‰äº pivot çš„å…ƒç´ ä½ç½®</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> j <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> pivot<span class="token punctuation">)</span> i<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// å‘å·¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äº pivot çš„å…ƒç´ ä½ç½®</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> j <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">>=</span> pivot <span class="token punctuation">)</span> j<span class="token operator">--</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">>=</span> j<span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//äº¤æ¢ä¸¤ä¸ªå…ƒç´ çš„ä½ç½®ï¼Œä½¿å¾—å·¦è¾¹çš„å…ƒç´ ä¸å¤§äºpivot,å³è¾¹çš„ä¸å°äºpivot</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        arr<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// ä½¿ä¸­è½´å…ƒç´ å¤„äºæœ‰åºçš„ä½ç½®</span>        arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> pivot<span class="token punctuation">;</span>        <span class="token keyword">return</span> j<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åŸé¢˜&quot;&gt;1 åŸé¢˜&lt;/h1&gt;&lt;p&gt;ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ &lt;code&gt;nums&lt;/code&gt;ï¼Œå°†è¯¥æ•°ç»„å‡åºæ’åˆ—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹ 1:&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;è¾“å…¥ï¼š&lt;/strong&gt; [5,2,3,1
      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="leetcode" scheme="https://www.codetool.top/tags/leetcode/"/>
    
      <category term="ç®—æ³•" scheme="https://www.codetool.top/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>å›½äººå¼€å‘çš„Mybatiså°å·¥å…·-é€šç”¨Mapperå’ŒPageHelper</title>
    <link href="https://www.codetool.top/article/%E5%9B%BD%E4%BA%BA%E5%BC%80%E5%8F%91%E7%9A%84Mybatis%E5%B0%8F%E5%B7%A5%E5%85%B7-%E9%80%9A%E7%94%A8Mapper%E5%92%8CPageHelper/"/>
    <id>https://www.codetool.top/article/å›½äººå¼€å‘çš„Mybatiså°å·¥å…·-é€šç”¨Mapperå’ŒPageHelper/</id>
    <published>2020-03-30T11:07:39.000Z</published>
    <updated>2020-03-30T11:16:34.607Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é€šç”¨Mapper">1 é€šç”¨Mapper</h1><p>é€šç”¨Mapperä¸Pagehelperæ˜¯ä¸€ä½å›½å†…å¤§ç¥å†™çš„ç®€åŒ–Mybatiså¼€å‘çš„ä¸¤é¡¹æŠ€æœ¯ï¼Œé€šç”¨Mapperé…åˆORMæ˜ å°„æ³¨è§£å¯ä»¥åšåˆ°ä¸å†™sqlè¯­å¥å’Œmapperæ–¹æ³•ï¼Œè€ŒPagehelperå¯ä»¥ç®€åŒ–åˆ†é¡µæ“ä½œã€‚</p><p>ä½œè€…çš„githubï¼š <a href="https://github.com/abel533" target="_blank" rel="noopener">https://github.com/abel533</a></p><p>ä½œè€…çš„åšå®¢ï¼š <a href="https://blog.csdn.net/isea533" target="_blank" rel="noopener">https://blog.csdn.net/isea533</a></p><p>æœ¬æ–‡å‚è€ƒäºä½œè€…æä¾›çš„ä½¿ç”¨æ–‡æ¡£ã€‚</p><h2 id="ä½¿ç”¨">1.1 ä½¿ç”¨</h2><p>ä¾èµ–ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- é€šç”¨mapper --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>tk.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mapper-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.1.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- Mybatis-starter --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- JPAæ³¨è§£ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.persistence<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>persistence-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>compile<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><ul><li>ä¸ºæ‰€æœ‰çš„mapperæ¥å£æ·»åŠ <code>@Mapper</code>æ³¨è§£</li><li>é…ç½®ç±»æ·»åŠ <code>@MapperScan</code>æ³¨è§£</li></ul><p>ä¾‹å¦‚ï¼šç›´æ¥åœ¨å¯åŠ¨ç±»ä¸Šæ ‡æ³¨Mapperæ‰«æåŒ…</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"com.rhett.dao"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsApplication</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        SpringApplication<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>GoodsApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h2 id="ORMæ˜ å°„æ³¨è§£">1.2 ORMæ˜ å°„æ³¨è§£</h2><p>é€šç”¨ Mapper ä½¿ç”¨ä¸€éƒ¨åˆ† JPA æ³¨è§£å’Œè‡ªå·±æä¾›çš„æ³¨è§£æ¥å®ç°å¯¹è±¡å…³ç³»æ˜ å°„</p><h3 id="Id">1.2.1 Id</h3><p>æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦ä¸€ä¸ª <code>@Id</code> æ ‡è®°å­—æ®µä¸ºä¸»é”®å³å¯ã€‚æ•°æ®åº“ä¸­çš„å­—æ®µåå’Œå®ä½“ç±»çš„å­—æ®µåæ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œè¿™ä¸­æƒ…å†µä¸‹å®ä½“å’Œè¡¨å¯ä»¥ç›´æ¥æ˜ å°„ã€‚</p><p>å‡è®¾æœ‰ä¸€æ•°æ®åº“è¡¨ï¼š</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>country<span class="token punctuation">`</span> <span class="token punctuation">(</span>  <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'ä¸»é”®'</span><span class="token punctuation">,</span>  <span class="token punctuation">`</span>countryname<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'åç§°'</span><span class="token punctuation">,</span>  <span class="token punctuation">`</span>countrycode<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ä»£ç '</span><span class="token punctuation">,</span>  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>Id<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">10011</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'å›½å®¶ä¿¡æ¯'</span><span class="token punctuation">;</span></code></pre><p>å¯¹åº”javaå®ä½“ç±»ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Country</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Id</span>    <span class="token keyword">private</span> Integer id<span class="token punctuation">;</span>    <span class="token keyword">private</span> String  countryname<span class="token punctuation">;</span>    <span class="token keyword">private</span> String  countrycode<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//çœç•¥ getter å’Œ setter</span><span class="token punctuation">}</span></code></pre><h3 id="NameStyle">1.2.2 NameStyle</h3><p><code>@NameStyle</code>åœ¨ç±»ä¸Šè¿›è¡Œé…ç½®ï¼Œè¡¨ç¤ºå­—æ®µåçš„æ˜ å°„é£æ ¼ï¼Œå®ƒçš„å–å€¼åœ¨<code>Style</code>ä¸­æšä¸¾ï¼Œå…±æœ‰ï¼š</p><ul><li><code>normal</code>        åŸå€¼</li><li><code>camelhump</code>     é©¼å³°è½¬ä¸‹åˆ’çº¿</li><li><code>uppercase</code>       è½¬æ¢ä¸ºå¤§å†™</li><li><code>lowercase</code>       è½¬æ¢ä¸ºå°å†™</li><li><code>camelhumpAndUppercase</code>   é©¼å³°è½¬ä¸‹åˆ’çº¿å¤§å†™å½¢å¼</li><li><code>camelhumpAndLowercase</code>   é©¼å³°è½¬ä¸‹åˆ’çº¿å°å†™å½¢å¼</li></ul><p>ä¾‹ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@NameStyle</span><span class="token punctuation">(</span>Style<span class="token punctuation">.</span>camelhumpAndUppercase<span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Country</span></code></pre><h3 id="Table">1.2.3 Table</h3><p>æŒ‡å®šå¯¹åº”çš„è¡¨åï¼Œæ²¡é…ç½®æ—¶æŒ‰ç±»åè‡ªåŠ¨è½¬æ¢</p><p>ä¾‹ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"sys_user"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span></code></pre><h3 id="Column">1.2.4 Column</h3><p>æŒ‡å®šå¯¹åº”çš„å­—æ®µæ˜ å°„åï¼Œæ²¡é…ç½®æ—¶é»˜è®¤å’Œå­—æ®µåç›¸åŒ</p><p>ä¾‹ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"user_name"</span><span class="token punctuation">)</span><span class="token keyword">private</span> String name<span class="token punctuation">;</span></code></pre><h3 id="Transient">1.2.5 Transient</h3><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå®ä½“ä¸­çš„å­—æ®µå’Œæ•°æ®åº“è¡¨ä¸­çš„å­—æ®µæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¾ˆå¤šæƒ…å†µæˆ‘ä»¬ä¼šåœ¨å®ä½“ä¸­å¢åŠ ä¸€äº›é¢å¤–çš„å±æ€§ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå°±éœ€è¦ä½¿ç”¨ <code>@Transient</code> æ³¨è§£æ¥å‘Šè¯‰é€šç”¨ Mapper è¿™ä¸æ˜¯è¡¨ä¸­çš„å­—æ®µã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ç®€å•ç±»å‹ä¼šè¢«è‡ªåŠ¨è®¤ä¸ºæ˜¯è¡¨ä¸­çš„å­—æ®µã€‚</p><blockquote><p>è¿™é‡Œçš„ç®€å•ç±»å‹ä¸åŒ…å« Java ä¸­çš„8ç§åŸºæœ¬ç±»å‹ï¼š</p><p>byte,short,int,long,float,double,char,boolean</p><p>è¿™æ˜¯å› ä¸ºåœ¨ç±»ä¸­ï¼ŒåŸºæœ¬ç±»å‹ä¼šæœ‰é»˜è®¤å€¼ï¼Œè€Œ <strong>MyBatis ä¸­ç»å¸¸ä¼šéœ€è¦åˆ¤æ–­å±æ€§å€¼æ˜¯å¦ä¸ºç©ºï¼Œæ‰€ä»¥ä¸è¦åœ¨ç±»ä¸­ä½¿ç”¨åŸºæœ¬ç±»å‹ï¼Œå¦åˆ™ä¼šé‡åˆ°è«åå…¶å¦™çš„é”™è¯¯ã€‚</strong></p></blockquote><p>å¯¹äºç±»ä¸­çš„å¤æ‚å¯¹è±¡ï¼Œä»¥åŠ Map,List ç­‰å±æ€§ä¸éœ€è¦é…ç½®è¿™ä¸ªæ³¨è§£ã€‚</p><h2 id="ä½¿ç”¨Mapper">1.3 ä½¿ç”¨Mapper</h2><p>åˆ™å…ˆå†™ä¸€ä¸ªMapperæ¥å£ï¼Œè¦ç»§æ‰¿<code>tk.mybatis.mapper.common.Mapper</code>ï¼Œè¯¥ç±»æœ‰å¾ˆå¤šä»£è¡¨æ•°æ®åº“æ“ä½œçš„æ–¹æ³•ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> tk<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>common<span class="token punctuation">.</span>Mapper<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CountryMapper</span> <span class="token keyword">extends</span> <span class="token class-name">Mapper</span><span class="token operator">&lt;</span>Country<span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre><p>ä» MyBatis ä¸­è·å–è¯¥æ¥å£åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ä» MyBatis æˆ–è€… Spring ä¸­è·å– countryMapperï¼Œç„¶åè°ƒç”¨ selectAll æ–¹æ³•</span>List<span class="token operator">&lt;</span>Country<span class="token operator">></span> countries <span class="token operator">=</span> countryMapper<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ ¹æ®ä¸»é”®æŸ¥è¯¢</span>Country country <span class="token operator">=</span> countryMapper<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æˆ–è€…ä½¿ç”¨å¯¹è±¡ä¼ å‚ï¼Œé€‚ç”¨äº1ä¸ªå­—æ®µæˆ–è€…å¤šä¸ªå­—æ®µè”åˆä¸»é”®ä½¿ç”¨</span>Country query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Country</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>query<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>country <span class="token operator">=</span> countryMapper<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="è‡ªå®šä¹‰æ–¹æ³•å®ç°">1.4 è‡ªå®šä¹‰æ–¹æ³•å®ç°</h2><p>å¦‚æœæƒ³è¦å¢åŠ è‡ªå·±å†™çš„æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ CountryMapper ä¸­å¢åŠ ã€‚</p><h3 id="çº¯æ¥å£æ³¨è§£æ–¹å¼">1.4.1 çº¯æ¥å£æ³¨è§£æ–¹å¼</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>Select<span class="token punctuation">;</span><span class="token keyword">import</span> tk<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>common<span class="token punctuation">.</span>Mapper<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CountryMapper</span> <span class="token keyword">extends</span> <span class="token class-name">Mapper</span><span class="token operator">&lt;</span>Country<span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from country where countryname = #{countryname}"</span><span class="token punctuation">)</span>    Country <span class="token function">selectByCountryName</span><span class="token punctuation">(</span>String countryname<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="å¦‚æœä½¿ç”¨-XML-æ–¹å¼ï¼Œéœ€è¦æä¾›æ¥å£å¯¹åº”çš„-XML-æ–‡ä»¶">1.4.2 å¦‚æœä½¿ç”¨ XML æ–¹å¼ï¼Œéœ€è¦æä¾›æ¥å£å¯¹åº”çš„ XML æ–‡ä»¶</h3><p>ä¾‹å¦‚æä¾›äº† CountryMapper.xml æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token doctype">&lt;!DOCTYPE mapper        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tk.mybatis.sample.mapper.CountryMapper<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectByCountryName<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tk.mybatis.model.Country<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        select * from country where countryname = #{countryname}    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span></code></pre><p>åœ¨æ¥å£ä¸­æ·»åŠ å¯¹åº”çš„æ–¹æ³•ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> tk<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>common<span class="token punctuation">.</span>Mapper<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CountryMapper</span> <span class="token keyword">extends</span> <span class="token class-name">Mapper</span><span class="token operator">&lt;</span>Country<span class="token operator">></span> <span class="token punctuation">{</span>    Country <span class="token function">selectByCountryName</span><span class="token punctuation">(</span>String countryname<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>åœ¨æ¥å£ä¸­æ·»åŠ å…¶ä»–æ–¹æ³•çš„æ—¶å€™å’Œåªç”¨ MyBatis æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œ<strong>åœ¨å¯¹åº”çš„ XML ä¸­ï¼Œä¸èƒ½å‡ºç°å’Œç»§æ‰¿æ¥å£ä¸­åŒåçš„æ–¹æ³•ï¼</strong></p><h1 id="PageHelper">2 PageHelper</h1><h2 id="ä»‹ç»">2.1 ä»‹ç»</h2><p>PageHelperæ˜¯åŸºäºMybatisçš„æ’ä»¶æœºåˆ¶å¼€å‘çš„ï¼ŒMybatisæ”¯æŒç¼–å†™<strong>æ‹¦æˆªå™¨</strong>ï¼Œåœ¨Mybatisçš„åº•å±‚æ–¹æ³•ä¸­è¿›è¡Œæ‹¦æˆªï¼Œå¦‚æ‰“å°æ‰§è¡Œçš„SQLè¯­å¥æ—¥å¿—ï¼Œåšä¸€äº›æƒé™æ§åˆ¶ï¼Œåˆ†é¡µç­‰åŠŸèƒ½ã€‚</p><p>PageHelperå°±æ˜¯é€šè¿‡æ‹¦æˆªäº†Mybatisä¸­Executorçš„queryæ–¹æ³•çš„æ‰§è¡Œï¼Œæ¥å®ç°æŸ¥è¯¢æ—¶åˆ†é¡µé€»è¾‘çš„æ·»åŠ ã€‚</p><p>æ‹¦æˆªå™¨éƒ¨åˆ†æºç ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Intercepts</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Signature</span><span class="token punctuation">(</span>type <span class="token operator">=</span> Executor<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"query"</span><span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token punctuation">{</span>MappedStatement<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> RowBounds<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> ResultHandler<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token annotation punctuation">@Signature</span><span class="token punctuation">(</span>type <span class="token operator">=</span> Executor<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"query"</span><span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token punctuation">{</span>MappedStatement<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> RowBounds<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> ResultHandler<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> CacheKey<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> BoundSql<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PageInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">volatile</span> Dialect dialect<span class="token punctuation">;</span>    <span class="token keyword">private</span> String countSuffix <span class="token operator">=</span> <span class="token string">"_COUNT"</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> Cache<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> MappedStatement<span class="token operator">></span> msCountMap <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">private</span> String default_dialect_class <span class="token operator">=</span> <span class="token string">"com.github.pagehelper.PageHelper"</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> Object <span class="token function">intercept</span><span class="token punctuation">(</span>Invocation invocation<span class="token punctuation">)</span> <span class="token keyword">throws</span> Throwable <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//...</span>    <span class="token punctuation">}</span></code></pre><h2 id="PageHelperçš„ä½¿ç”¨">2.2 PageHelperçš„ä½¿ç”¨</h2><p>å¼•å…¥ä¾èµ–ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.github.pagehelper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>pagehelper-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.13<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><p>ä½¿ç”¨ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºé¡µæ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå•é¡µçš„æ¡æ•°</span><span class="token comment" spellcheck="true">//ç¬¬ä¸‰ä¸ªå‚æ•°è¿™é‡Œæ˜¯æ ¹æ®stu_idé™åºæ’åº</span>PageHelper<span class="token punctuation">.</span><span class="token function">startPage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"stu_id desc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åœ¨startPageåé¢ç´§è·Ÿä¸€ä¸ªæŸ¥è¯¢é›†åˆæ–¹æ³•</span>List<span class="token operator">&lt;</span>Student<span class="token operator">></span> list <span class="token operator">=</span> studentMapper<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;é€šç”¨Mapper&quot;&gt;1 é€šç”¨Mapper&lt;/h1&gt;&lt;p&gt;é€šç”¨Mapperä¸Pagehelperæ˜¯ä¸€ä½å›½å†…å¤§ç¥å†™çš„ç®€åŒ–Mybatiså¼€å‘çš„ä¸¤é¡¹æŠ€æœ¯ï¼Œé€šç”¨Mapperé…åˆORMæ˜ å°„æ³¨è§£å¯ä»¥åšåˆ°ä¸å†™sqlè¯­å¥å’Œmapperæ–¹æ³•ï¼Œè€ŒPagehelperå¯ä»¥ç®€åŒ–åˆ†é¡µæ“ä½œã€‚&lt;
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="Mybatis" scheme="https://www.codetool.top/tags/Mybatis/"/>
    
  </entry>
  
  <entry>
    <title>å‰‘æŒ‡offer62-åœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­—</title>
    <link href="https://www.codetool.top/article/%E5%89%91%E6%8C%87offer62-%E5%9C%86%E5%9C%88%E4%B8%AD%E6%9C%80%E5%90%8E%E5%89%A9%E4%B8%8B%E7%9A%84%E6%95%B0%E5%AD%97/"/>
    <id>https://www.codetool.top/article/å‰‘æŒ‡offer62-åœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­—/</id>
    <published>2020-03-30T01:54:24.000Z</published>
    <updated>2020-03-30T01:58:59.322Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸé¢˜ï¼ˆæ¥æºLeetcodeï¼‰">1 åŸé¢˜ï¼ˆæ¥æºLeetcodeï¼‰</h1><p>0,1,,n-1è¿™nä¸ªæ•°å­—æ’æˆä¸€ä¸ªåœ†åœˆï¼Œä»æ•°å­—0å¼€å§‹ï¼Œæ¯æ¬¡ä»è¿™ä¸ªåœ†åœˆé‡Œåˆ é™¤ç¬¬mä¸ªæ•°å­—ã€‚æ±‚å‡ºè¿™ä¸ªåœ†åœˆé‡Œå‰©ä¸‹çš„æœ€åä¸€ä¸ªæ•°å­—ã€‚</p><p>ä¾‹å¦‚ï¼Œ0ã€1ã€2ã€3ã€4è¿™5ä¸ªæ•°å­—ç»„æˆä¸€ä¸ªåœ†åœˆï¼Œä»æ•°å­—0å¼€å§‹æ¯æ¬¡åˆ é™¤ç¬¬3ä¸ªæ•°å­—ï¼Œåˆ™åˆ é™¤çš„å‰4ä¸ªæ•°å­—ä¾æ¬¡æ˜¯2ã€0ã€4ã€1ï¼Œå› æ­¤æœ€åå‰©ä¸‹çš„æ•°å­—æ˜¯3ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p><strong>è¾“å…¥:</strong> n = 5, m = 3<br><strong>è¾“å‡º:</strong> 3  </p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p><strong>è¾“å…¥:</strong> n = 10, m = 17<br><strong>è¾“å‡º:</strong> 2</p></blockquote><p><strong>é™åˆ¶ï¼š</strong></p><ul><li><code>1 &lt;= n &lt;= 10^5</code></li><li><code>1 &lt;= m &lt;= 10^6</code></li></ul><h1 id="è§£æ³•">2 è§£æ³•</h1><h2 id="æ€æƒ³">2.1 æ€æƒ³</h2><p>çº¦ç‘Ÿå¤«é—®é¢˜ï¼Œleetcodeä¸Šé¢åªèƒ½ç”¨æ•°å­¦è§£æ³•ï¼Œå¦åˆ™ä¼šè¶…æ—¶ã€‚</p><p>è§£æ³•å‚è€ƒï¼š</p><p><a href="https://leetcode-cn.com/problems/yuan-quan-zhong-zui-hou-sheng-xia-de-shu-zi-lcof/solution/chi-jing-stsu-degd-degtsu-tu-jie-yue-se-fu-huan-hu/" target="_blank" rel="noopener">å›¾è§£çº¦ç‘Ÿå¤«ç¯ï¼Œè¿˜é€ã€Šå…·ä½“æ•°å­¦ã€‹PDF ğŸ³åƒé²¸ Î£(ã£ Â°Ğ” Â°;)ã£  - åœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­— - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="ä»£ç ">2.2 ä»£ç </h2><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>m <span class="token operator">+</span> x<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lastRemaining</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åŸé¢˜ï¼ˆæ¥æºLeetcodeï¼‰&quot;&gt;1 åŸé¢˜ï¼ˆæ¥æºLeetcodeï¼‰&lt;/h1&gt;&lt;p&gt;0,1,,n-1è¿™nä¸ªæ•°å­—æ’æˆä¸€ä¸ªåœ†åœˆï¼Œä»æ•°å­—0å¼€å§‹ï¼Œæ¯æ¬¡ä»è¿™ä¸ªåœ†åœˆé‡Œåˆ é™¤ç¬¬mä¸ªæ•°å­—ã€‚æ±‚å‡ºè¿™ä¸ªåœ†åœˆé‡Œå‰©ä¸‹çš„æœ€åä¸€ä¸ªæ•°å­—ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œ0ã€1ã€2ã€3ã€4è¿™5ä¸ªæ•°å­—ç»„æˆä¸€ä¸ªåœ†åœˆï¼Œ
      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="ç®—æ³•" scheme="https://www.codetool.top/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="å‰‘æŒ‡offer" scheme="https://www.codetool.top/tags/%E5%89%91%E6%8C%87offer/"/>
    
  </entry>
  
  <entry>
    <title>docker-composeä½¿ç”¨å’Œdockerç§æœ‰ä»“åº“æ­å»º</title>
    <link href="https://www.codetool.top/article/docker-compose%E4%BD%BF%E7%94%A8%E5%92%8Cdocker%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E6%90%AD%E5%BB%BA/"/>
    <id>https://www.codetool.top/article/docker-composeä½¿ç”¨å’Œdockerç§æœ‰ä»“åº“æ­å»º/</id>
    <published>2020-03-29T14:11:31.000Z</published>
    <updated>2020-03-29T14:12:22.252Z</updated>
    
    <content type="html"><![CDATA[<h1 id="docker-compose">1 docker-compose</h1><h2 id="ä»‹ç»ä¸å®‰è£…">1.1 ä»‹ç»ä¸å®‰è£…</h2><p>å¾®æœåŠ¡æ¶æ„çš„åº”ç”¨ç³»ç»Ÿä¸­ä¸€èˆ¬åŒ…å«è‹¥å¹²ä¸ªå¾®æœåŠ¡ï¼Œæ¯ä¸ªå¾®æœåŠ¡ä¸€èˆ¬éƒ½ä¼šéƒ¨ç½²å¤šä¸ªå®ä¾‹ï¼Œå¦‚æœæ¯ä¸ªå¾®æœåŠ¡éƒ½è¦æ‰‹åŠ¨å¯åœï¼Œç»´æŠ¤çš„å·¥ä½œé‡ä¼šå¾ˆå¤§ã€‚</p><p>Docker Composeæ˜¯ä¸€ä¸ªç¼–æ’å¤šå®¹å™¨åˆ†å¸ƒå¼éƒ¨ç½²çš„å·¥å…·ï¼Œæä¾›å‘½ä»¤é›†ç®¡ç†å®¹å™¨åŒ–åº”ç”¨çš„å®Œæ•´å¼€å‘å‘¨æœŸï¼ŒåŒ…æ‹¬æœåŠ¡æ„å»ºï¼Œå¯åŠ¨å’Œåœæ­¢ã€‚ä½¿ç”¨æ­¥éª¤ï¼š</p><ol><li>åˆ©ç”¨ Dockerfile å®šä¹‰è¿è¡Œç¯å¢ƒé•œåƒ</li><li>ä½¿ç”¨ <code>docker-compose.yml</code> å®šä¹‰ç»„æˆåº”ç”¨çš„å„æœåŠ¡</li><li>è¿è¡Œ <code>docker-compose up</code> å¯åŠ¨åº”ç”¨</li></ol><p>ä¸‹è½½ï¼š <a href="https://github.com/docker/compose/releases/" target="_blank" rel="noopener">https://github.com/docker/compose/releases/</a></p><p>è¿™é‡Œé€‰æ‹©1.25.4ç‰ˆæœ¬ä¸‹è½½ï¼Œä¸‹è½½ä¸‹æ¥çš„å°±æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œèµ‹äºˆæ‰§è¡Œæƒé™ï¼Œå¯ä»¥å°†å…¶ç§»åŠ¨åˆ°<code>/usr/bin</code>ç›®å½•ä¸‹ï¼š</p><pre><code>wget https://github.com/docker/compose/releases/download/1.25.4/docker-compose-Linux-x86_64chmod +x docker-compose-Linux-x86_64mv docker-compose-Linux-x86_64 /usr/bin/docker-compose</code></pre><p>æŸ¥çœ‹ç‰ˆæœ¬</p><pre><code>docker-compose -version</code></pre><h2 id="ä½¿ç”¨">1.2 ä½¿ç”¨</h2><p>åˆ›å»ºä¸€ä¸ª<code>docker-compose</code>ç›®å½•ç”¨äºæµ‹è¯•</p><pre><code>mkdir ~/docker-composecd ~/docker-compose</code></pre><p>ç¼–å†™ docker-compose.yml æ–‡ä»¶ï¼š</p><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3'</span><span class="token key atrule">services</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># ä»£è¡¨è¦å¯åŠ¨çš„å®¹å™¨</span>    <span class="token key atrule">nginx</span><span class="token punctuation">:</span>        <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx        <span class="token key atrule">ports</span><span class="token punctuation">:</span>        <span class="token punctuation">-</span> <span class="token datetime number">80:80</span>        <span class="token key atrule">links</span><span class="token punctuation">:</span>        <span class="token punctuation">-</span> app        <span class="token key atrule">volumes</span><span class="token punctuation">:</span>        <span class="token punctuation">-</span> ./nginx/conf.d<span class="token punctuation">:</span>/etc/nginx/conf.d    <span class="token key atrule">app</span><span class="token punctuation">:</span>        <span class="token key atrule">image</span><span class="token punctuation">:</span> app        <span class="token key atrule">expose</span><span class="token punctuation">:</span>            <span class="token punctuation">-</span> <span class="token string">"8080"</span></code></pre><p>æ‰§è¡Œå‘½ä»¤</p><pre><code>docker-compose up</code></pre><p>å³å¯è¿è¡Œã€‚</p><h1 id="dockerç§æœ‰ä»“åº“">2 dockerç§æœ‰ä»“åº“</h1><p>Dockerå®˜æ–¹çš„Docker hubï¼ˆ<a href="https://hub.docker.comï¼‰æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å…¬å…±é•œåƒçš„ä»“åº“ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸Šé¢æ‹‰å–é•œåƒ" target="_blank" rel="noopener">https://hub.docker.comï¼‰æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å…¬å…±é•œåƒçš„ä»“åº“ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸Šé¢æ‹‰å–é•œåƒ</a> åˆ°æœ¬åœ°ï¼Œä¹Ÿå¯ä»¥æŠŠæˆ‘ä»¬è‡ªå·±çš„é•œåƒæ¨é€ä¸Šå»ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬çš„æœåŠ¡å™¨æ— æ³•è®¿é—®äº’è”ç½‘ï¼Œæˆ–è€…ä½ ä¸å¸Œæœ›å°†è‡ªå·±çš„é•œåƒæ”¾åˆ°å…¬ç½‘å½“ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ­å»ºè‡ªå·±çš„ç§æœ‰ä»“åº“æ¥å­˜å‚¨å’Œç®¡ç†è‡ªå·±çš„é•œåƒã€‚</p><h2 id="ç§æœ‰ä»“åº“æ­å»º">2.1 ç§æœ‰ä»“åº“æ­å»º</h2><pre class=" language-shell"><code class="language-shell"># 1ã€æ‹‰å–ç§æœ‰ä»“åº“é•œåƒ docker pull registry# 2ã€å¯åŠ¨ç§æœ‰ä»“åº“å®¹å™¨ docker run -id --name=registry -p 5000:5000 registry</code></pre><p>æ‰“å¼€æµè§ˆå™¨ è¾“å…¥åœ°å€ http://ç§æœ‰ä»“åº“æœåŠ¡å™¨ip:5000/v2/_catalog ï¼Œçœ‹åˆ°<code>{&quot;repositories&quot;:[]}</code> è¡¨ç¤ºç§æœ‰ä»“åº“ æ­å»ºæˆåŠŸ</p><p>3ã€ä¿®æ”¹daemon.json   </p><pre><code>vim /etc/docker/daemon.json </code></pre><p>åœ¨ä¸Šè¿°æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªkeyï¼Œä¿å­˜é€€å‡ºã€‚æ­¤æ­¥ç”¨äºè®© docker ä¿¡ä»»ç§æœ‰ä»“åº“åœ°å€ï¼›æ³¨æ„å°†ç§æœ‰ä»“åº“æœåŠ¡å™¨ipä¿®æ”¹ä¸ºè‡ªå·±ç§æœ‰ä»“åº“æœåŠ¡å™¨çœŸå®ip </p><pre><code>{&quot;insecure-registries&quot;:[&quot;ç§æœ‰ä»“åº“æœåŠ¡å™¨ip:5000&quot;]} </code></pre><p>4ã€é‡å¯docker æœåŠ¡ </p><pre><code>systemctl restart dockerdocker start registry</code></pre><h2 id="å°†é•œåƒä¸Šä¼ è‡³ç§æœ‰ä»“åº“">2.2 å°†é•œåƒä¸Šä¼ è‡³ç§æœ‰ä»“åº“</h2><pre class=" language-shell"><code class="language-shell"># 1ã€æ ‡è®°é•œåƒä¸ºç§æœ‰ä»“åº“çš„é•œåƒ     docker tag centos:7 ç§æœ‰ä»“åº“æœåŠ¡å™¨IP:5000/centos:7# 2ã€ä¸Šä¼ æ ‡è®°çš„é•œåƒ     docker push ç§æœ‰ä»“åº“æœåŠ¡å™¨IP:5000/centos:7</code></pre><h2 id="ä»ç§æœ‰ä»“åº“æ‹‰å–é•œåƒ">2.3 ä»ç§æœ‰ä»“åº“æ‹‰å–é•œåƒ</h2><pre class=" language-shell"><code class="language-shell"># æ‹‰å–é•œåƒ docker pull ç§æœ‰ä»“åº“æœåŠ¡å™¨ip:5000/centos:7</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;docker-compose&quot;&gt;1 docker-compose&lt;/h1&gt;&lt;h2 id=&quot;ä»‹ç»ä¸å®‰è£…&quot;&gt;1.1 ä»‹ç»ä¸å®‰è£…&lt;/h2&gt;&lt;p&gt;å¾®æœåŠ¡æ¶æ„çš„åº”ç”¨ç³»ç»Ÿä¸­ä¸€èˆ¬åŒ…å«è‹¥å¹²ä¸ªå¾®æœåŠ¡ï¼Œæ¯ä¸ªå¾®æœåŠ¡ä¸€èˆ¬éƒ½ä¼šéƒ¨ç½²å¤šä¸ªå®ä¾‹ï¼Œå¦‚æœæ¯ä¸ªå¾®æœåŠ¡éƒ½è¦æ‰‹åŠ¨å¯åœï¼Œç»´æŠ¤çš„å·¥ä½œé‡ä¼šå¾ˆå¤§ã€‚&lt;
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="docker" scheme="https://www.codetool.top/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>dockeré•œåƒåŸç†ä¸dockerfile</title>
    <link href="https://www.codetool.top/article/docker%E9%95%9C%E5%83%8F%E5%8E%9F%E7%90%86%E4%B8%8Edockerfile/"/>
    <id>https://www.codetool.top/article/dockeré•œåƒåŸç†ä¸dockerfile/</id>
    <published>2020-03-29T10:20:24.000Z</published>
    <updated>2020-03-29T14:12:24.869Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Docker-é•œåƒæœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ">1 Docker é•œåƒæœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>æ˜¯ä¸€ä¸ªåˆ†å±‚æ–‡ä»¶ç³»ç»Ÿ</p><p><strong>ç»Ÿä¸€æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼ˆUnion File Systemï¼‰æŠ€æœ¯èƒ½å¤Ÿå°†ä¸åŒçš„å±‚æ•´åˆæˆä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä¸ºè¿™äº›å±‚æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„è§†è§’ï¼Œè¿™æ ·å°±éšè—äº†å¤šå±‚çš„å­˜åœ¨ï¼Œåœ¨ç”¨æˆ·çš„è§’åº¦çœ‹æ¥ï¼Œåªå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚ </p><p>ä¸€ä¸ªé•œåƒå¯ä»¥æ”¾åœ¨å¦ä¸€ä¸ªé•œåƒçš„ä¸Šé¢ã€‚ä½äºä¸‹é¢çš„é•œåƒç§°ä¸ºçˆ¶é•œåƒï¼Œæœ€åº•éƒ¨çš„é•œåƒæˆä¸ºåŸºç¡€é•œåƒã€‚</p><p>å½“ä»ä¸€ä¸ªé•œåƒå¯åŠ¨å®¹å™¨æ—¶ï¼ŒDockerä¼šåœ¨æœ€é¡¶å±‚åŠ è½½ä¸€ä¸ªè¯»å†™æ–‡ä»¶ç³»ç»Ÿä½œä¸ºå®¹å™¨</p><h1 id="Docker-ä¸­ä¸€ä¸ªcentosé•œåƒä¸ºä»€ä¹ˆåªæœ‰200MBï¼Œè€Œä¸€ä¸ªcentosæ“ä½œç³»ç»Ÿçš„isoæ–‡ä»¶è¦å‡ ä¸ªä¸ªGï¼Ÿ">2 Docker ä¸­ä¸€ä¸ªcentosé•œåƒä¸ºä»€ä¹ˆåªæœ‰200MBï¼Œè€Œä¸€ä¸ªcentosæ“ä½œç³»ç»Ÿçš„isoæ–‡ä»¶è¦å‡ ä¸ªä¸ªGï¼Ÿ</h1><p>Dockeré•œåƒæ˜¯ç”±ç‰¹æ®Šçš„æ–‡ä»¶ç³»ç»Ÿå åŠ è€Œæˆï¼Œ<br>æœ€åº•ç«¯æ˜¯ <code>bootfs</code>ï¼Œå¹¶ä½¿ç”¨å®¿ä¸»æœºçš„ <code>bootfs</code>ã€‚</p><p>ç¬¬äºŒå±‚æ˜¯rootæ–‡ä»¶ç³»ç»Ÿ<code>rootfs</code>,ç§°ä¸º<code>base image</code><br>ç„¶åå†å¾€ä¸Šå¯ä»¥å åŠ å…¶ä»–çš„é•œåƒæ–‡ä»¶</p><p><img src="https://api.codetool.top/img/15854771588983.png" alt></p><p>Centosçš„isoé•œåƒæ–‡ä»¶åŒ…å«<code>bootfs</code>å’Œ<code>rootfs</code>ï¼Œè€Œdockerçš„centosé•œåƒå¤ç”¨æ“ä½œç³»ç»Ÿçš„<code>bootfs</code>ï¼Œåªæœ‰<code>rootfs</code>å’Œå…¶ä»–é•œåƒå±‚</p><p>Docker ä¸­ä¸€ä¸ªtomcaté•œåƒä¸ºä»€ä¹ˆæœ‰500MBï¼Œè€Œä¸€ä¸ªtomcatå®‰è£…åŒ…åªæœ‰70å¤šMBï¼Ÿ</p><p>ç”±äºdockerä¸­é•œåƒæ˜¯åˆ†å±‚çš„ï¼Œtomcatè™½ç„¶åªæœ‰70å¤šMBï¼Œä½†ä»–éœ€è¦ä¾èµ–äºçˆ¶é•œåƒå’ŒåŸºç¡€é•œåƒï¼Œæ‰€æœ‰æ•´ä¸ªå¯¹å¤–æš´éœ²çš„tomcaté•œåƒå¤§å°500å¤šMB</p><p>ä½¿ç”¨<code>docker inspect é•œåƒå</code>ä¹Ÿå¯ä»¥çœ‹åˆ°<code>layers</code>ï¼Œå³åˆ†å±‚é•œåƒã€‚</p><h1 id="dockerfile">3 dockerfile</h1><p>å®¹å™¨è½¬æˆé•œåƒï¼š</p><pre><code>docker commit å®¹å™¨id é•œåƒåç§°:ç‰ˆæœ¬å·</code></pre><p>å‹ç¼©å’Œè§£å‹ï¼š</p><pre><code>docker save -o å‹ç¼©æ–‡ä»¶åç§° é•œåƒåç§°:ç‰ˆæœ¬å·docker load -i å‹ç¼©æ–‡ä»¶åç§°</code></pre><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥ç”¨dockerfileæ¥åˆ¶ä½œé•œåƒã€‚</p><h2 id="è¯­æ³•">3.1 è¯­æ³•</h2><h3 id="FROM-amp-RUN-amp-USER">3.1.1 FROM &amp; RUN &amp; USER</h3><pre class=" language-dockerfile"><code class="language-dockerfile">From debian:wheezyUSER cowsayRun apt-get update && apt-get install -y cowsay fortune</code></pre><p><code>FROM</code>æŒ‡ä»¤æŒ‡å®šåˆå§‹é•œåƒï¼Œè¿™é‡Œä½¿ç”¨debianï¼Œå¹¶ä¸”æŒ‡å®šäº†wheezyç‰ˆæœ¬</p><p><code>USER</code>æŒ‡å®šbuildæˆ–å¯åŠ¨çš„æ—¶å€™ï¼Œrun cmd entrypointæ‰§è¡Œæ—¶ä½¿ç”¨çš„ç”¨æˆ·ã€‚</p><p><code>RUN</code>ç”¨äºæ‰§è¡ŒæŒ‡ä»¤</p><h3 id="ENTRYPOINT">3.1.2 ENTRYPOINT</h3><pre class=" language-dockerfile"><code class="language-dockerfile">ENTRYPOINT ["/usr/games/cowsay"]</code></pre><p>ENTRYPOINTæŒ‡å®šä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¼ ç»™docker runä½œå‚æ•°ï¼Œä¸€èˆ¬åœ¨åˆ¶ä½œä¸€äº›æ‰§è¡Œå°±å…³é—­çš„å®¹å™¨ä¸­ä¼šä½¿ç”¨ã€‚</p><h3 id="COPY-amp-ADD">3.1.3 COPY &amp; ADD</h3><pre class=" language-dockerfile"><code class="language-dockerfile">COPY entrypoint.sh /ADD entrypoint.sh /</code></pre><p>æŠŠä¸€ä¸ªæ–‡ä»¶ä»ä¸»æœºï¼ˆå¯ä½¿ç”¨dockerfileæ‰€åœ¨è·¯å¾„çš„ç›¸å¯¹è·¯å¾„ï¼‰å¤åˆ¶åˆ°é•œåƒçš„æ–‡ä»¶ç³»ç»Ÿã€‚COPYæŒ‡ä»¤å’ŒADDæŒ‡ä»¤çš„å”¯ä¸€åŒºåˆ«åœ¨äºæ˜¯å¦æ”¯æŒä»è¿œç¨‹URLè·å–èµ„æºã€‚COPYæŒ‡ä»¤åªèƒ½ä»æ‰§è¡Œdocker buildæ‰€åœ¨çš„ä¸»æœºä¸Šè¯»å–èµ„æºå¹¶å¤åˆ¶åˆ°é•œåƒä¸­ã€‚è€ŒADDæŒ‡ä»¤è¿˜æ”¯æŒé€šè¿‡URLä»è¿œç¨‹æœåŠ¡å™¨è¯»å–èµ„æºå¹¶å¤åˆ¶åˆ°é•œåƒä¸­ã€‚</p><h3 id="ENV-amp-ARG">3.1.4 ENV &amp; ARG</h3><pre class=" language-dockerfile"><code class="language-dockerfile">ENV NGINX_VERSION   1.17.9</code></pre><p>æŒ‡å®šç¯å¢ƒå˜é‡</p><pre class=" language-dockerfile"><code class="language-dockerfile">ARG some_variable_name=default_valueRUN echo "Oh dang look at that $some_variable_name"</code></pre><p>å¯ä»¥ç”¨æ¥ä½œä¸ºæ„å»ºçš„å‚æ•°ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼‰ã€‚</p><h3 id="MAINTAINER-amp-LABEL">3.1.5 MAINTAINER &amp; LABEL</h3><pre class=" language-dockerfile"><code class="language-dockerfile">MAINTAINER John Smith <john@smith.com>LABEL maintainer="John Smith <john@smith.com>"</code></pre><p><code>MAINTAINER</code>è®¾å®šä½œè€…çš„è”ç³»ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨<code>LABEL</code>ä»£æ›¿ï¼ŒLABELè®¾ç½®çš„å±æ€§æœ€ç»ˆå¯ä»¥åœ¨docker imageçš„åŸºæœ¬å±æ€§ä¸­æŸ¥çœ‹</p><h3 id="EXPOSE">3.1.6 EXPOSE</h3><pre class=" language-dockerfile"><code class="language-dockerfile">EXPOSE 80</code></pre><p>æš´éœ²ç«¯å£</p><h3 id="VOLUME-amp-WORKDIR">3.1.7 VOLUME &amp; WORKDIR</h3><pre class=" language-dockerfile"><code class="language-dockerfile">VOLUME /dataWORKDIR /data</code></pre><p><code>VOLUME</code>å®šä¹‰å¤–éƒ¨å¯ä»¥æŒ‚è½½çš„æ•°æ®å·ï¼Œ<code>WORKDIR</code>æŒ‡å®šå·¥ä½œç›®å½•ï¼Œå¦‚æœæ²¡æœ‰è‡ªåŠ¨åˆ›å»º</p><h3 id="CMD">3.1.8 CMD</h3><p>ç¬¬ä¸€ç§ç”¨æ³•ï¼š</p><pre class=" language-dockerfile"><code class="language-dockerfile">CMD java -jar app.jar</code></pre><p>è¿è¡Œä¸€ä¸ªå¯æ‰§è¡Œçš„æ–‡ä»¶å¹¶æä¾›å‚æ•°ã€‚</p><p>ç¬¬äºŒç§ç”¨æ³•ï¼šä¸ºENTRYPOINTæŒ‡å®šå‚æ•°ã€‚</p><p>ç¬¬ä¸‰ç§ç”¨æ³•ï¼š</p><pre class=" language-dockerfile"><code class="language-dockerfile">CMD["/bin/bash"]</code></pre><p>è®¾ç½®å¯åŠ¨å®¹å™¨é»˜è®¤æ‰“å¼€çš„ç»ˆç«¯</p><h2 id="ä½¿ç”¨Dockerfileåˆ›å»ºé•œåƒ">3.2 ä½¿ç”¨Dockerfileåˆ›å»ºé•œåƒ</h2><pre><code>docker build -f ./centos_dockerfile -t vim_centos:1 .</code></pre><p><code>-f Dockerfile</code>æŒ‡å®šdockerfileçš„ä½ç½®</p><p><code>-t image_name:tag</code>æŒ‡å®šé•œåƒçš„åå­—åŠæ ‡ç­¾</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Docker-é•œåƒæœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;1 Docker é•œåƒæœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h1&gt;&lt;p&gt;æ˜¯ä¸€ä¸ªåˆ†å±‚æ–‡ä»¶ç³»ç»Ÿ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç»Ÿä¸€æ–‡ä»¶ç³»ç»Ÿ&lt;/strong&gt;ï¼ˆUnion File Systemï¼‰æŠ€æœ¯èƒ½å¤Ÿå°†ä¸åŒçš„å±‚æ•´åˆæˆä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä¸ºè¿™äº›å±‚æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="docker" scheme="https://www.codetool.top/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>å¸¸ç”¨è½¯ä»¶çš„dockeréƒ¨ç½²</title>
    <link href="https://www.codetool.top/article/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E7%9A%84docker%E9%83%A8%E7%BD%B2/"/>
    <id>https://www.codetool.top/article/å¸¸ç”¨è½¯ä»¶çš„dockeréƒ¨ç½²/</id>
    <published>2020-03-29T06:07:45.000Z</published>
    <updated>2020-03-29T06:15:44.152Z</updated>
    
    <content type="html"><![CDATA[<h1 id="dockerç«¯å£æ˜ å°„">1 dockerç«¯å£æ˜ å°„</h1><ul><li>å®¹å™¨å†…çš„ç½‘ç»œæœåŠ¡å’Œå¤–éƒ¨æœºå™¨ä¸èƒ½ç›´æ¥é€šä¿¡</li><li>å¤–éƒ¨æœºå™¨å’Œå®¿ä¸»æœºå¯ä»¥ç›´æ¥é€šä¿¡</li><li>å®¿ä¸»æœºå’Œå®¹å™¨å¯ä»¥ç›´æ¥é€šä¿¡</li></ul><p>å½“å®¹å™¨ä¸­çš„ç½‘ç»œæœåŠ¡éœ€è¦è¢«å¤–éƒ¨æœºå™¨è®¿é—®æ—¶ï¼Œå¯ä»¥å°†å®¹å™¨ä¸­æä¾›æœåŠ¡çš„ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç«¯å£ä¸Šã€‚å¤–éƒ¨æœºå™¨è®¿é—®å®¿ä¸»æœºçš„è¯¥ç«¯å£ï¼Œä»è€Œé—´æ¥è®¿é—®å®¹å™¨çš„æœåŠ¡ã€‚è¿™ç§æ“ä½œç§°ä¸ºï¼šç«¯å£æ˜ å°„</p><h1 id="Mysqléƒ¨ç½²">2 Mysqléƒ¨ç½²</h1><ol><li>æœç´¢mysqlé•œåƒ</li></ol><pre><code>docker search mysql</code></pre><ol start="2"><li>æ‹‰å–mysqlé•œåƒ</li></ol><pre><code>docker pull mysql:5.7</code></pre><ol start="3"><li>åˆ›å»ºå®¹å™¨ï¼Œè®¾ç½®ç«¯å£æ˜ å°„ã€ç›®å½•æ˜ å°„</li></ol><pre class=" language-shell"><code class="language-shell"># åœ¨/rootç›®å½•ä¸‹åˆ›å»ºmysqlç›®å½•ç”¨äºå­˜å‚¨mysqlæ•°æ®ä¿¡æ¯mkdir ~/mysqlcd ~/mysqldocker run -id \-p 3306:3306 \--name=c_mysql \-v $PWD/conf:/etc/mysql/conf.d \-v $PWD/logs:/logs \-v $PWD/data:/var/lib/mysql \-e MYSQL_ROOT_PASSWORD=123456 \mysql:5.7</code></pre><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>-p 3306:3306</code>ï¼šå°†å®¹å™¨çš„ 3306 ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ 3306 ç«¯å£ã€‚å‰ä¸€ä¸ª3306æ˜¯å®¿ä¸»æœºçš„ç«¯å£ã€‚</li><li><code>-v $PWD/conf:/etc/mysql/conf.d</code>ï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„ conf/my.cnf æŒ‚è½½åˆ°å®¹å™¨çš„ /etc/mysql/my.cnfã€‚é…ç½®ç›®å½•</li><li><code>-v $PWD/logs:/logs</code>ï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„ logs ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ /logsã€‚æ—¥å¿—ç›®å½•</li><li><code>-v $PWD/data:/var/lib/mysql</code>ï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„dataç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ /var/lib/mysql ã€‚æ•°æ®ç›®å½•</li><li><code>-e MYSQL_ROOT_PASSWORD=123456</code>ï¼šåˆå§‹åŒ– root ç”¨æˆ·çš„å¯†ç ã€‚</li></ul><p>ã€æ³¨ã€‘å¦‚æœæç¤º<code>[Warning] IPv4 forwarding is disabled. Networking will not work.</code>ï¼š</p><p>åœ¨dockerçš„å®¿ä¸»æœºä¸­æ›´æ”¹æ–‡ä»¶ï¼š</p><pre><code>vim /usr/lib/sysctl.d/00-system.conf</code></pre><p>åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ <code>net.ipv4.ip_forward=1</code></p><p>é‡æ–°å¯åŠ¨networkæœåŠ¡ï¼š<code>systemctl restart network</code></p><ol start="4"><li>è¿›å…¥å®¹å™¨ç¯å¢ƒ</li></ol><pre><code>docker exec -it c_mysql /bin/bash</code></pre><h1 id="Nginxéƒ¨ç½²">3 Nginxéƒ¨ç½²</h1><pre><code>docker pull nginx</code></pre><p>ä¸‹é¢è¿™ä¸ªæ­¥éª¤æ˜¯æŠŠnginx.confæ–‡ä»¶å¤åˆ¶å‡ºæ¥ï¼š</p><pre><code>mkdir ~/nginxcd ~/nginxmkdir confdocker run -id --name=c_nginx -p 80:80 nginxdocker cp c_nginx:/etc/nginx/nginx.conf ~/nginx/confdocker stop c_nginxdocker rm c_nginx</code></pre><p>é‡æ–°ç”Ÿæˆå®¹å™¨ï¼Œå¹¶ç»‘å®šæ•°æ®å·ï¼š</p><pre><code>docker run -id --name=c_nginx \-p 80:80 \-v $PWD/conf/nginx.conf:/etc/nginx/nginx.conf \-v $PWD/logs:/var/log/nginx \-v $PWD/html:/usr/share/nginx/html \nginx</code></pre><p>åœ¨<code>html/</code>ä¸‹æ–°å»ºindex.htmlï¼š</p><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>hello docker nginxï¼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>ä¿å­˜å¹¶é€€å‡ºï¼Œè®¿é—®å®¿ä¸»æœºçš„80ç«¯å£ï¼Œå¯ä»¥çœ‹è§ç½‘ç«™æˆåŠŸå“åº”</p><p><img src="https://api.codetool.top/img/15854600337280.png" alt></p><h1 id="rediséƒ¨ç½²">4 rediséƒ¨ç½²</h1><pre><code>docker pull redis:5.0docker run -id --name=c_redis -p 6379:6379 redis:5.0</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;dockerç«¯å£æ˜ å°„&quot;&gt;1 dockerç«¯å£æ˜ å°„&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;å®¹å™¨å†…çš„ç½‘ç»œæœåŠ¡å’Œå¤–éƒ¨æœºå™¨ä¸èƒ½ç›´æ¥é€šä¿¡&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨æœºå™¨å’Œå®¿ä¸»æœºå¯ä»¥ç›´æ¥é€šä¿¡&lt;/li&gt;
&lt;li&gt;å®¿ä¸»æœºå’Œå®¹å™¨å¯ä»¥ç›´æ¥é€šä¿¡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“å®¹å™¨ä¸­çš„ç½‘ç»œæœåŠ¡éœ€è¦è¢«å¤–éƒ¨
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="docker" scheme="https://www.codetool.top/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>dockeræ•°æ®æŒ‚è½½-æ•°æ®å·ä»‹ç»</title>
    <link href="https://www.codetool.top/article/docker%E6%95%B0%E6%8D%AE%E6%8C%82%E8%BD%BD-%E6%95%B0%E6%8D%AE%E5%8D%B7%E4%BB%8B%E7%BB%8D/"/>
    <id>https://www.codetool.top/article/dockeræ•°æ®æŒ‚è½½-æ•°æ®å·ä»‹ç»/</id>
    <published>2020-03-29T04:37:34.000Z</published>
    <updated>2020-03-29T04:37:47.123Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨Dockerä¸­ï¼Œè¦æƒ³å®ç°æ•°æ®çš„æŒä¹…åŒ–ï¼ˆæ‰€è°“Dockerçš„æ•°æ®æŒä¹…åŒ–å³æ•°æ®ä¸éšç€Containerçš„ç»“æŸè€Œç»“æŸï¼‰ï¼Œéœ€è¦å°†æ•°æ®ä»å®¿ä¸»æœºæŒ‚è½½åˆ°å®¹å™¨ä¸­ã€‚ç›®å‰Dockeræä¾›äº†ä¸‰ç§ä¸åŒçš„æ–¹å¼å°†æ•°æ®ä»å®¿ä¸»æœºæŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼š</p><ol><li>volumesï¼šDockerç®¡ç†å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œé»˜è®¤ä½äº /var/lib/docker/volumes ç›®å½•ä¸­ï¼›ï¼ˆæœ€å¸¸ç”¨çš„æ–¹å¼ï¼‰</li><li>bind mountsï¼šæ„ä¸ºç€å¯ä»¥å­˜å‚¨åœ¨å®¿ä¸»æœºç³»ç»Ÿçš„ä»»æ„ä½ç½®ï¼›ï¼ˆæ¯”è¾ƒå¸¸ç”¨çš„æ–¹å¼ï¼‰<br>ä½†æ˜¯ï¼Œbind mountåœ¨ä¸åŒçš„å®¿ä¸»æœºç³»ç»Ÿæ—¶ä¸å¯ç§»æ¤çš„ï¼Œæ¯”å¦‚Windowså’ŒLinuxçš„ç›®å½•ç»“æ„æ˜¯ä¸ä¸€æ ·çš„ï¼Œbind mountæ‰€æŒ‡å‘çš„hostç›®å½•ä¹Ÿä¸èƒ½ä¸€æ ·ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆbind mountä¸èƒ½å‡ºç°åœ¨Dockerfileä¸­çš„åŸå› ï¼Œå› ä¸ºè¿™æ ·Dockerfileå°±ä¸å¯ç§»æ¤äº†ã€‚</li><li>tmpfsï¼šæŒ‚è½½å­˜å‚¨åœ¨å®¿ä¸»æœºç³»ç»Ÿçš„å†…å­˜ä¸­ï¼Œè€Œä¸ä¼šå†™å…¥å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿï¼›ï¼ˆä¸€èˆ¬éƒ½ä¸ä¼šç”¨çš„æ–¹å¼ï¼‰</li></ol><h1 id="Volumes">1 Volumes</h1><h2 id="åˆ›å»ºæ•°æ®å·">1.1 åˆ›å»ºæ•°æ®å·</h2><pre><code>docker volume create edc-nginx-vol # åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰å®¹å™¨å·docker volume ls # æŸ¥çœ‹æ‰€æœ‰å®¹å™¨å·docker volume inspect edc-nginx-vol # æŸ¥çœ‹æŒ‡å®šå®¹å™¨å·è¯¦æƒ…ä¿¡æ¯</code></pre><h2 id="å¯åŠ¨å®¹å™¨æ—¶æŒ‚è½½æ•°æ®å·">1.2 å¯åŠ¨å®¹å™¨æ—¶æŒ‚è½½æ•°æ®å·</h2><pre><code>docker run -d -it --name=edc-nginx -p 8800:80 -v edc-nginx-vol:/usr/share/nginx/html nginx</code></pre><p>å…¶ä¸­ï¼Œ<code>edc-nginx-vol</code>æŒ‡çš„æ˜¯åˆ›å»ºæ•°æ®å·çš„åç§°ï¼Œ<code>/usr/share/nginx/html</code>æŒ‡çš„æ˜¯è¦æŒ‚è½½åˆ°çš„å®¹å™¨ä¸­çš„è·¯å¾„åï¼Œå¦‚æœä¸å¡«å†™<code>edc-nginx-vol:</code>å³çœç•¥æ•°æ®å·åç§°ï¼Œåˆ™ä¼šåˆ†é…ä¸€ä¸ªåŒ¿åçš„æ•°æ®å·ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p><ul><li>æ•°æ®å·æ˜¯å®¿ä¸»æœºä¸­çš„ä¸€ä¸ªç›®å½•æˆ–æ–‡ä»¶</li><li>å½“å®¹å™¨ç›®å½•å’Œæ•°æ®å·ç›®å½•ç»‘å®šåï¼Œå¯¹æ–¹çš„ä¿®æ”¹ä¼šç«‹å³åŒæ­¥</li><li>ä¸€ä¸ªæ•°æ®å·å¯ä»¥è¢«å¤šä¸ªå®¹å™¨åŒæ—¶æŒ‚è½½</li><li>ä¸€ä¸ªå®¹å™¨ä¹Ÿå¯ä»¥è¢«æŒ‚è½½å¤šä¸ªæ•°æ®å·</li><li>å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»º</li></ul><h2 id="æ¸…ç†å·">1.3 æ¸…ç†å·</h2><pre><code>docker stop edc-nginx # æš‚åœå®¹å™¨å®ä¾‹docker rm edc-nginx # ç§»é™¤å®¹å™¨å®ä¾‹docker volume rm edc-nginx-vol # åˆ é™¤è‡ªå®šä¹‰æ•°æ®å·</code></pre><h1 id="bind-mounts">2 bind mounts</h1><p>bind mountså¯ä»¥æŒ‚è½½å®¿ä¸»æœºçš„ä»»æ„ä½ç½®ï¼Œè¯­æ³•ï¼š</p><pre><code>docker run -d -it --name=edc-nginx -v /app/wwwroot:/usr/share/nginx/html nginx</code></pre><p>å…¶ä¸­<code>/app/wwwroot</code>æŒ‡çš„æ˜¯å®¿ä¸»æœºä¸­çš„è·¯å¾„ï¼Œ<code>/usr/share/nginx/html</code>æŒ‡çš„æ˜¯è¦æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„è·¯å¾„ã€‚</p><p>æ³¨æ„ï¼š å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„</p><p>é€šè¿‡<code>docker inspect edc-nginx</code>å¯ä»¥çœ‹åˆ°å®¹å™¨ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬bindsä¿¡æ¯ã€‚</p><p>æ•°æ®å·æŒ‚è½½çš„å¦ä¸€ä¸ªåº”ç”¨æ˜¯å¯ä»¥å¤šä¸ªå®¹å™¨æŒ‚è½½åŒä¸€ä¸ªæ•°æ®å·ä»è€Œå®ç°å®¹å™¨é—´çš„æ•°æ®äº¤æ¢ã€‚</p><h1 id="æ•°æ®å·å®¹å™¨">3 æ•°æ®å·å®¹å™¨</h1><p>ä¸ºäº†æœ‰æ•ˆåœ°ç»´æŠ¤å¤šå®¹å™¨çš„æ•°æ®å…±äº«ï¼Œå¯ä»¥ç»´æŠ¤ä¸€ä¸ªæ•°æ®å·å®¹å™¨ï¼ŒæŒ‚è½½æ•°æ®å·ï¼Œå…¶ä»–å®¹å™¨é€šè¿‡<code>--volumes-from</code>ä»è¯¥å®¹å™¨è·å–æ•°æ®å·é…ç½®ã€‚</p><p><img src="https://api.codetool.top/img/15854548494585.png" alt></p><p>ä¾‹ï¼š</p><pre><code>docker run â€“it --name=c3 â€“v /volume centos:7 /bin/bash </code></pre><pre><code>docker run â€“it --name=c1 --volumes-from c3 centos:7 /bin/bashdocker run â€“it --name=c2 --volumes-from c3 centos:7 /bin/bash  </code></pre><p>æœ‰ç‚¹åƒç»§æ‰¿c3çš„æ•°æ®å·é…ç½®ï¼Œå½“c3çš„æ•°æ®å·é…ç½®ä¿®æ”¹æ—¶c1å’Œc2ä¹Ÿä¼šä¿®æ”¹ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨Dockerä¸­ï¼Œè¦æƒ³å®ç°æ•°æ®çš„æŒä¹…åŒ–ï¼ˆæ‰€è°“Dockerçš„æ•°æ®æŒä¹…åŒ–å³æ•°æ®ä¸éšç€Containerçš„ç»“æŸè€Œç»“æŸï¼‰ï¼Œéœ€è¦å°†æ•°æ®ä»å®¿ä¸»æœºæŒ‚è½½åˆ°å®¹å™¨ä¸­ã€‚ç›®å‰Dockeræä¾›äº†ä¸‰ç§ä¸åŒçš„æ–¹å¼å°†æ•°æ®ä»å®¿ä¸»æœºæŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;volumesï¼šDockerç®¡ç†å®¿ä¸»
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="docker" scheme="https://www.codetool.top/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>leetcode1162-åœ°å›¾åˆ†æ</title>
    <link href="https://www.codetool.top/article/leetcode1162-%E5%9C%B0%E5%9B%BE%E5%88%86%E6%9E%90/"/>
    <id>https://www.codetool.top/article/leetcode1162-åœ°å›¾åˆ†æ/</id>
    <published>2020-03-29T02:56:33.000Z</published>
    <updated>2020-03-29T04:37:49.237Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸé¢˜">1 åŸé¢˜</h1><p>ä½ ç°åœ¨æ‰‹é‡Œæœ‰ä¸€ä»½å¤§å°ä¸º N x N çš„ã€åœ°å›¾ã€ï¼ˆç½‘æ ¼ï¼‰ <code>grid</code>ï¼Œä¸Šé¢çš„æ¯ä¸ªã€åŒºåŸŸã€ï¼ˆå•å…ƒæ ¼ï¼‰éƒ½ç”¨ <code>0</code> å’Œ <code>1</code> æ ‡è®°å¥½äº†ã€‚å…¶ä¸­ <code>0</code> ä»£è¡¨æµ·æ´‹ï¼Œ<code>1</code> ä»£è¡¨é™†åœ°ï¼Œä½ çŸ¥é“è·ç¦»é™†åœ°åŒºåŸŸæœ€è¿œçš„æµ·æ´‹åŒºåŸŸæ˜¯æ˜¯å“ªä¸€ä¸ªå—ï¼Ÿè¯·è¿”å›è¯¥æµ·æ´‹åŒºåŸŸåˆ°ç¦»å®ƒæœ€è¿‘çš„é™†åœ°åŒºåŸŸçš„è·ç¦»ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œè¯´çš„è·ç¦»æ˜¯ã€æ›¼å“ˆé¡¿è·ç¦»ã€ï¼ˆ Manhattan Distanceï¼‰ï¼š<code>(x0, y0)</code> å’Œ <code>(x1, y1)</code> è¿™ä¸¤ä¸ªåŒºåŸŸä¹‹é—´çš„è·ç¦»æ˜¯ <code>|x0 - x1| + |y0 - y1|</code> ã€‚</p><p>å¦‚æœæˆ‘ä»¬çš„åœ°å›¾ä¸Šåªæœ‰é™†åœ°æˆ–è€…æµ·æ´‹ï¼Œè¯·è¿”å› <code>-1</code>ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><p><img src="https://api.codetool.top/img/15854507938180.jpeg" alt></p><blockquote><p><strong>è¾“å…¥ï¼š</strong> [[1,0,1],[0,0,0],[1,0,1]]<br><strong>è¾“å‡ºï¼š</strong> 2<br><strong>è§£é‡Šï¼š</strong><br>æµ·æ´‹åŒºåŸŸ (1, 1) å’Œæ‰€æœ‰é™†åœ°åŒºåŸŸä¹‹é—´çš„è·ç¦»éƒ½è¾¾åˆ°æœ€å¤§ï¼Œæœ€å¤§è·ç¦»ä¸º 2ã€‚</p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><p><img src="https://api.codetool.top/img/15854508097755.jpeg" alt></p><blockquote><p><strong>è¾“å…¥ï¼š</strong> [[1,0,0],[0,0,0],[0,0,0]]<br><strong>è¾“å‡ºï¼š</strong> 4<br><strong>è§£é‡Šï¼š</strong><br>æµ·æ´‹åŒºåŸŸ (2, 2) å’Œæ‰€æœ‰é™†åœ°åŒºåŸŸä¹‹é—´çš„è·ç¦»éƒ½è¾¾åˆ°æœ€å¤§ï¼Œæœ€å¤§è·ç¦»ä¸º 4ã€‚  </p></blockquote><p><strong>æç¤ºï¼š</strong></p><ol><li><code>1 &lt;= grid.length == grid[0].length &lt;= 100</code></li><li><code>grid[i][j]</code> ä¸æ˜¯ <code>0</code> å°±æ˜¯ <code>1</code></li></ol><h1 id="è§£æ³•">2 è§£æ³•</h1><h2 id="æ€æƒ³">2.1 æ€æƒ³</h2><p>å·¦ä¸Šï¼Œå³ä¸‹ä¸¤éåŠ¨æ€è§„åˆ’</p><h2 id="ä»£ç ">2.2 ä»£ç </h2><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxDistance</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> grid<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span>dp<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">int</span> <span class="token punctuation">[</span>grid<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">[</span>grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>        <span class="token keyword">int</span> ans<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>grid<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>grid<span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>grid<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>                    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>grid<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>                    dp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>dp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">&lt;</span>grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>                    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span>grid<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span>grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">--</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">>=</span><span class="token number">1</span><span class="token punctuation">)</span>                    dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">>=</span><span class="token number">1</span><span class="token punctuation">)</span>                    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>grid<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>                ans<span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>ans<span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span>ans<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åŸé¢˜&quot;&gt;1 åŸé¢˜&lt;/h1&gt;&lt;p&gt;ä½ ç°åœ¨æ‰‹é‡Œæœ‰ä¸€ä»½å¤§å°ä¸º N x N çš„ã€åœ°å›¾ã€ï¼ˆç½‘æ ¼ï¼‰ &lt;code&gt;grid&lt;/code&gt;ï¼Œä¸Šé¢çš„æ¯ä¸ªã€åŒºåŸŸã€ï¼ˆå•å…ƒæ ¼ï¼‰éƒ½ç”¨ &lt;code&gt;0&lt;/code&gt; å’Œ &lt;code&gt;1&lt;/code&gt; æ ‡è®°å¥½äº†ã€‚å…¶ä¸­ &lt;code&gt;0&lt;/code
      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="leetcode" scheme="https://www.codetool.top/tags/leetcode/"/>
    
      <category term="ç®—æ³•" scheme="https://www.codetool.top/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="https://www.codetool.top/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
  </entry>
  
  <entry>
    <title>dockeræ¦‚è¿°å’Œç›¸å…³å‘½ä»¤</title>
    <link href="https://www.codetool.top/article/docker%E6%A6%82%E8%BF%B0%E5%92%8C%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/"/>
    <id>https://www.codetool.top/article/dockeræ¦‚è¿°å’Œç›¸å…³å‘½ä»¤/</id>
    <published>2020-03-28T16:13:11.000Z</published>
    <updated>2020-03-28T16:13:36.859Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Dockeræ¦‚è¿°">1 Dockeræ¦‚è¿°</h1><ul><li>Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œè¯ç”Ÿäº 2013 å¹´åˆï¼ŒåŸºäº Go è¯­è¨€å®ç°ï¼ŒdotCloud å…¬å¸å‡ºå“ï¼ˆåæ”¹åä¸ºDocker Incï¼‰ã€‚</li><li>Docker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šã€‚</li><li>å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’éš”ç¦»</li><li>å®¹å™¨æ€§èƒ½å¼€é”€æä½ã€‚</li><li>Docker ä» 17.03 ç‰ˆæœ¬ä¹‹ååˆ†ä¸º CEï¼ˆCommunity Edition: ç¤¾åŒºç‰ˆï¼‰ å’Œ EEï¼ˆEnterprise Edition: ä¼ä¸šç‰ˆï¼‰</li></ul><h1 id="å®‰è£…docker">2 å®‰è£…docker</h1><pre class=" language-shell"><code class="language-shell"># 1ã€yum åŒ…æ›´æ–°åˆ°æœ€æ–° yum update# 2ã€å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…ï¼Œ yum-util æä¾›yum-config-manageråŠŸèƒ½ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯devicemapperé©±åŠ¨ä¾èµ–çš„ yum install -y yum-utils device-mapper-persistent-data lvm2# 3ã€ è®¾ç½®yumæºyum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo# 4ã€ å®‰è£…dockeryum install -y docker-ce# 5ã€ æŸ¥çœ‹dockerç‰ˆæœ¬ï¼ŒéªŒè¯æ˜¯å¦éªŒè¯æˆåŠŸdocker -v</code></pre><h2 id="é…ç½®dockeré•œåƒåŠ é€Ÿ">2.1 é…ç½®dockeré•œåƒåŠ é€Ÿ</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†æ¥ä»docker hubï¼ˆ<a href="https://hub.docker.com/ï¼‰ä¸Šä¸‹è½½dockeré•œåƒï¼Œå¤ªæ…¢ã€‚ä¸€èˆ¬éƒ½ä¼šé…ç½®é•œåƒåŠ é€Ÿå™¨ï¼š" target="_blank" rel="noopener">https://hub.docker.com/ï¼‰ä¸Šä¸‹è½½dockeré•œåƒï¼Œå¤ªæ…¢ã€‚ä¸€èˆ¬éƒ½ä¼šé…ç½®é•œåƒåŠ é€Ÿå™¨ï¼š</a></p><ul><li>USTCï¼šä¸­ç§‘å¤§é•œåƒåŠ é€Ÿå™¨ï¼ˆ<a href="https://docker.mirrors.ustc.edu.cnï¼‰" target="_blank" rel="noopener">https://docker.mirrors.ustc.edu.cnï¼‰</a></li><li>é˜¿é‡Œäº‘</li><li>ç½‘æ˜“äº‘</li><li>è…¾è®¯äº‘</li></ul><p>é˜¿é‡Œäº‘ï¼š <a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors" target="_blank" rel="noopener">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p><h2 id="è®¾ç½®å¼€æœºå¯åŠ¨">2.2 è®¾ç½®å¼€æœºå¯åŠ¨</h2><pre><code>systemctl enable docker</code></pre><h1 id="dockeræ¶æ„">3 dockeræ¶æ„</h1><p><img src="https://api.codetool.top/img/15854049916115.png" alt></p><p>é•œåƒï¼ˆImageï¼‰ï¼šDocker é•œåƒï¼ˆImageï¼‰ï¼Œå°±ç›¸å½“äºæ˜¯ä¸€ä¸ª root æ–‡ä»¶ç³»ç»Ÿã€‚æ¯”å¦‚å®˜æ–¹é•œåƒ ubuntu:16.04 å°±åŒ…å«äº†å®Œæ•´çš„ä¸€å¥— Ubuntu16.04 æœ€å°ç³»ç»Ÿçš„ root æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>å®¹å™¨ï¼ˆContainerï¼‰ï¼šé•œåƒï¼ˆImageï¼‰å’Œå®¹å™¨ï¼ˆContainerï¼‰çš„å…³ç³»ï¼Œå°±åƒæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ç±»å’Œå¯¹è±¡ä¸€æ ·ï¼Œé•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“ã€‚å®¹å™¨å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰ã€‚</p><p>ä»“åº“ï¼ˆRepositoryï¼‰ï¼šä»“åº“å¯çœ‹æˆä¸€ä¸ªä»£ç æ§åˆ¶ä¸­å¿ƒï¼Œç”¨æ¥ä¿å­˜é•œåƒã€‚</p><h1 id="dockeré•œåƒç›¸å…³å‘½ä»¤">4 dockeré•œåƒç›¸å…³å‘½ä»¤</h1><p><strong>æŸ¥çœ‹é•œåƒ</strong></p><p>æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰çš„é•œåƒ</p><pre><code>docker imagesdocker images â€“q # æŸ¥çœ‹æ‰€ç”¨é•œåƒçš„id</code></pre><p><strong>æœç´¢é•œåƒ</strong></p><pre><code>docker search **</code></pre><p>ä¹Ÿå¯ä»¥åœ¨ <a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a> æœç´¢</p><p><strong>æ‹‰å–é•œåƒ</strong></p><pre><code>docker pull **</code></pre><p>å¯ä»¥å¸¦ä¸ŠtagæŒ‡å®šç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼š</p><pre><code>docker pull mysql:5.7</code></pre><p><strong>ç§»é™¤é•œåƒ</strong></p><pre><code>docker rmi é•œåƒid</code></pre><h1 id="dockerå®¹å™¨ç›¸å…³å‘½ä»¤">5 dockerå®¹å™¨ç›¸å…³å‘½ä»¤</h1><p><strong>è¿è¡Œå®¹å™¨å¹¶åœ¨å®¹å™¨ä¸­æ‰“å¼€å‘½ä»¤è¡Œ</strong></p><pre><code>docker run -it --name=c1 debian /bin/bash</code></pre><p>ä½¿ç”¨<code>--name=**</code>å¯ä»¥æŒ‡å®šå®¹å™¨çš„åç§°</p><p>ä½¿ç”¨<code>exit</code>é€€å‡º</p><ul><li><code>-i</code>:ä¿æŒå®¹å™¨è¿è¡Œ</li><li><code>-t</code>:ä¸ºå®¹å™¨åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸å’Œ<code>-i</code>é…åˆä½¿ç”¨</li></ul><p><strong>åˆ›å»ºåå°è¿è¡Œçš„å®¹å™¨</strong></p><pre><code>docker run -id --name=c2 debian</code></pre><p>è¿è¡Œå‘½ä»¤åä¼šæ˜¾ç¤ºå®¹å™¨çš„id</p><p>å¦‚æœè¦è¿›å…¥åå°è¿è¡Œçš„å®¹å™¨ç¯å¢ƒï¼Œä½¿ç”¨</p><pre><code>docker exec -it c2 /bin/bash</code></pre><p>åå°è¿è¡Œçš„å®¹å™¨ä½¿ç”¨<code>exit</code>é€€å‡ºä¸ä¼šè‡ªåŠ¨å…³é—­ã€‚</p><ul><li><code>-d</code>ï¼šä»¥å®ˆæŠ¤æ¨¡å¼è¿è¡Œå®¹å™¨</li></ul><p><code>-it</code>åˆ›å»ºçš„å®¹å™¨ä¸€èˆ¬ç§°ä¸ºäº¤äº’å¼å®¹å™¨ï¼Œ<code>-d</code>åˆ›å»ºçš„å®¹å™¨ä¸€èˆ¬ç§°ä¸ºå®ˆæŠ¤å¼å®¹å™¨</p><p><strong>æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨</strong></p><pre class=" language-shell"><code class="language-shell">docker ps</code></pre><p>è¿è¡Œç»“æœ  </p><pre><code>CONTAINER ID    IMAGE       COMMAND         ...     NAMES   00723499fdbf    debian      &quot;/bin/bash&quot;     ...     stupefied_turing</code></pre><p>nameå¯ä»¥æ ‡è¯†è¿™ä¸ªå®¹å™¨</p><p>ä½¿ç”¨<code>docker ps -a</code>å¯ä»¥çœ‹åˆ°æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬ä¸åœ¨è¿è¡Œçš„ï¼‰</p><p><strong>åœæ­¢è¿è¡Œå®¹å™¨</strong></p><pre><code>docker stop c2</code></pre><p><strong>å¯åŠ¨å®¹å™¨</strong></p><pre><code>docker start c2</code></pre><p>å’Œ<code>docker run</code>çš„åŒºåˆ«æ˜¯<code>docker start</code>æ˜¯é‡å¯å·²å­˜åœ¨çš„å®¹å™¨ï¼Œè€Œ<code>docker run</code>æ˜¯ä»é•œåƒåˆ›å»ºå®¹å™¨ã€‚</p><p><strong>æŸ¥çœ‹å®¹å™¨ä¿¡æ¯</strong></p><pre><code>docker inspect </code></pre><p><strong>æŸ¥çœ‹å®¹å™¨è¢«æ”¹åŠ¨çš„æ–‡ä»¶</strong></p><pre><code>docker diff</code></pre><p><strong>æŸ¥çœ‹å®¹å™¨å†å²è®°å½•</strong></p><pre><code>docker logs</code></pre><p><strong>åˆ é™¤å®¹å™¨</strong></p><p>åˆ é™¤æŒ‡å®šå®¹å™¨</p><pre><code>docker rm dockername</code></pre><p>è·å–æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨</p><pre><code>docker ps -aq -f status=exited </code></pre><p>åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨</p><pre><code>docker rm -v $(docker ps -aq -f status=exited)</code></pre><p><strong>å°†å®¹å™¨æäº¤ä¸ºé•œåƒ</strong></p><pre><code>docker commit container_name repo/image_name</code></pre><p><code>repo</code>æ˜¯å­˜æ”¾é•œåƒçš„ä»“åº“åç§°ï¼Œè¿™ä¸ªå‘½ä»¤å°†ä¼šè¿”å›ä¸€ä¸ªé•œåƒçš„å”¯ä¸€è¯†åˆ«ç </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Dockeræ¦‚è¿°&quot;&gt;1 Dockeræ¦‚è¿°&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œè¯ç”Ÿäº 2013 å¹´åˆï¼ŒåŸºäº Go è¯­è¨€å®ç°ï¼ŒdotCloud å…¬å¸å‡ºå“ï¼ˆåæ”¹åä¸ºDocker Incï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Docker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="docker" scheme="https://www.codetool.top/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>ElasticSearchæ¦‚è¿°å’Œå¸¸ç”¨Rest APIä½¿ç”¨</title>
    <link href="https://www.codetool.top/article/ElasticSearch%E6%A6%82%E8%BF%B0%E5%92%8C%E5%B8%B8%E7%94%A8Rest-API%E4%BD%BF%E7%94%A8/"/>
    <id>https://www.codetool.top/article/ElasticSearchæ¦‚è¿°å’Œå¸¸ç”¨Rest-APIä½¿ç”¨/</id>
    <published>2020-03-28T11:13:30.000Z</published>
    <updated>2020-03-29T01:30:38.885Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Elastic-Stackæ¦‚è¿°">1 Elastic Stackæ¦‚è¿°</h1><p>å¦‚æœä½ æ²¡æœ‰å¬è¯´è¿‡Elastic Stackï¼Œé‚£ä½ ä¸€å®šå¬è¯´è¿‡ELKï¼Œå®é™…ä¸ŠELKæ˜¯ä¸‰æ¬¾è½¯ä»¶çš„ç®€ç§°ï¼Œåˆ†åˆ«æ˜¯Elasticsearchã€ Logstashã€Kibanaç»„æˆï¼Œåœ¨å‘å±•çš„è¿‡ç¨‹ä¸­ï¼Œåˆæœ‰æ–°æˆå‘˜Beatsçš„åŠ å…¥ï¼Œæ‰€ä»¥å°±å½¢æˆäº†Elastic Stackã€‚æ‰€ä»¥è¯´ï¼ŒELKæ˜¯æ—§çš„ç§°å‘¼ï¼ŒElastic Stackæ˜¯æ–°çš„åå­—ã€‚</p><p><img src="https://api.codetool.top/img/1585363297461.jpg" alt></p><p>å…¨ç³»çš„Elastic StackæŠ€æœ¯æ ˆåŒ…æ‹¬ï¼š</p><p><img src="https://api.codetool.top/img/15853635525873.png" alt></p><ul><li>Elasticsearch<br>Elasticsearch åŸºäºjavaï¼Œæ˜¯ä¸ªå¼€æºåˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œå®ƒçš„ç‰¹ç‚¹æœ‰ï¼šåˆ†å¸ƒå¼ï¼Œé›¶é…ç½®ï¼Œè‡ªåŠ¨å‘ç°ï¼Œç´¢å¼•è‡ªåŠ¨åˆ†ç‰‡ï¼Œç´¢å¼•å‰¯æœ¬æœºåˆ¶ï¼Œrestfulé£æ ¼æ¥å£ï¼Œå¤šæ•°æ®æºï¼Œè‡ªåŠ¨æœç´¢è´Ÿè½½ç­‰ã€‚</li><li>Logstash<br>Logstash åŸºäºjavaï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„ç”¨äºæ”¶é›†,åˆ†æå’Œå­˜å‚¨æ—¥å¿—çš„å·¥å…·ã€‚</li><li>Kibana<br>Kibana åŸºäºnodejsï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¼€æºå’Œå…è´¹çš„å·¥å…·ï¼ŒKibanaå¯ä»¥ä¸º Logstash å’ŒElasticSearch æä¾›çš„æ—¥å¿—åˆ†æå‹å¥½çš„Web ç•Œé¢ï¼Œå¯ä»¥æ±‡æ€»ã€åˆ†æå’Œæœç´¢é‡è¦æ•°æ®æ—¥å¿—ã€‚</li><li>Beats<br>Beatsæ˜¯elasticå…¬å¸å¼€æºçš„ä¸€æ¬¾é‡‡é›†ç³»ç»Ÿç›‘æ§æ•°æ®çš„ä»£ç†agentï¼Œæ˜¯åœ¨è¢«ç›‘æ§æœåŠ¡å™¨ä¸Šä»¥å®¢æˆ·ç«¯å½¢å¼è¿è¡Œçš„æ•°æ®æ”¶é›†å™¨çš„ç»Ÿç§°ï¼Œå¯ä»¥ç›´æ¥æŠŠæ•°æ®å‘é€ç»™Elasticsearchæˆ–è€…é€šè¿‡Logstashå‘é€ç»™Elasticsearchï¼Œç„¶åè¿›è¡Œåç»­çš„æ•°æ®åˆ†ææ´»åŠ¨ã€‚</li></ul><p>Beatsç”±å¦‚ä¸‹ç»„æˆ:</p><ul><li>Packetbeatï¼šæ˜¯ä¸€ä¸ªç½‘ç»œæ•°æ®åŒ…åˆ†æå™¨ï¼Œç”¨äºç›‘æ§ã€æ”¶é›†ç½‘ç»œæµé‡ä¿¡æ¯ï¼ŒPacketbeatå—…æ¢æœåŠ¡å™¨ä¹‹é—´çš„æµé‡ï¼Œè§£æåº”ç”¨å±‚åè®®ï¼Œå¹¶å…³è”åˆ°æ¶ˆæ¯çš„å¤„ç†ï¼Œå…¶æ”¯ æŒICMP (v4 and v6)ã€DNSã€HTTPã€Mysqlã€PostgreSQLã€Redisã€MongoDBã€Memcacheç­‰åè®®ã€‚</li><li>Filebeatï¼šç”¨äºç›‘æ§ã€æ”¶é›†æœåŠ¡å™¨æ—¥å¿—æ–‡ä»¶ï¼Œå…¶å·²å–ä»£ logstash forwarderã€‚</li><li>Metricbeatï¼šå¯å®šæœŸè·å–å¤–éƒ¨ç³»ç»Ÿçš„ç›‘æ§æŒ‡æ ‡ä¿¡æ¯ï¼Œå…¶å¯ä»¥ç›‘æ§ã€æ”¶é›† Apacheã€HAProxyã€MongoDBã€MySQLã€Nginxã€PostgreSQLã€Redisã€Systemã€Zookeeperç­‰æœåŠ¡ã€‚</li><li>Winlogbeatï¼šç”¨äºç›‘æ§ã€æ”¶é›†Windowsç³»ç»Ÿçš„æ—¥å¿—ä¿¡æ¯ã€‚</li></ul><h1 id="ElasticSearchæ¦‚è¿°">2 ElasticSearchæ¦‚è¿°</h1><p>ElasticSearchæ˜¯ä¸€ä¸ª<strong>åŸºäºLucene</strong>çš„æœç´¢æœåŠ¡å™¨ã€‚å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚Elasticsearchæ˜¯ç”¨Javaè¯­è¨€å¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯ä¸€ç§æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚ElasticSearchç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚å®˜æ–¹å®¢æˆ·ç«¯åœ¨Javaã€.NETï¼ˆC#ï¼‰ã€PHPã€Pythonã€Apache Groovyã€Rubyå’Œè®¸å¤šå…¶ä»–è¯­è¨€ä¸­éƒ½æ˜¯å¯ç”¨çš„ã€‚</p><h2 id="å®‰è£…">2.1 å®‰è£…</h2><p>Elasticsearchçš„å‘å±•æ˜¯éå¸¸å¿«é€Ÿçš„ï¼Œæ‰€ä»¥åœ¨ES5.0ä¹‹å‰ï¼ŒELKçš„å„ä¸ªç‰ˆæœ¬éƒ½ä¸ç»Ÿä¸€ï¼Œå‡ºç°äº†ç‰ˆæœ¬å·æ··ä¹±çš„çŠ¶æ€ï¼Œæ‰€ä»¥ä»5.0å¼€å§‹ï¼Œæ‰€æœ‰Elastic Stackä¸­çš„é¡¹ç›®å…¨éƒ¨ç»Ÿä¸€ç‰ˆæœ¬å·ã€‚</p><p>ä¸‹è½½åœ°å€ï¼š <a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/cn/downloads/elasticsearch</a></p><p>å› ä¸ºå¯åŠ¨Elasticsearch5.0ç‰ˆæœ¬åŠä»¥ä¸Šéœ€è¦ä½¿ç”¨érootç”¨æˆ·ï¼Œéœ€è¦æ–°å»ºä¸€ä¸ªç”¨æˆ·æ¥å¯åŠ¨Elasticsearch</p><pre><code>useradd elkmkdir -pv /opt/elk/{data,logs}chown -R elk:elk /opt/elk/</code></pre><p>å°†ä¸‹è½½åçš„å‹ç¼©åŒ…è§£å‹</p><pre><code>mv elasticsearch-7.6.1-linux-x86_64.tar.gz /opt/tar -xvf elasticsearch-7.6.1-linux-x86_64.tar.gzmv elasticsearch-7.6.1 elasticsearchchown -R elk:elk /opt/elasticsearch/</code></pre><p>ä¿®æ”¹å®‰è£…ç›®å½•ä¸‹çš„<code>/conf/elasticsearch.yml</code></p><pre class=" language-yml"><code class="language-yml">network.host: 0.0.0.0path.data: /opt/elk/datapath.logs: /opt/elk/logsdiscovery.seed_hosts: ["127.0.0.1","[::1]"]cluster.initial_master_nodes: ["node-1"]</code></pre><p>åœ¨Elasticsearchä¸­å¦‚æœï¼Œnetwork.hostä¸æ˜¯localhostæˆ–è€…127.0.0.1çš„è¯ï¼Œå°±ä¼šè®¤ä¸ºæ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œä¼šå¯¹ç¯å¢ƒçš„è¦æ±‚æ¯”è¾ƒé«˜ï¼Œæˆ‘ä»¬çš„æµ‹è¯•ç¯å¢ƒä¸ä¸€å®šèƒ½å¤Ÿæ»¡è¶³ï¼Œä¸€èˆ¬æƒ…å†µä¸‹éœ€è¦ä¿®æ”¹å‡ å¤„é…ç½®ï¼š</p><p>ä¿®æ”¹<code>jvm.options</code></p><pre><code># -Xms1g # -Xmx1g-Xms128m-Xmx128m</code></pre><p>ä¿®æ”¹<code>/etc/sysctl.conf</code>ï¼Œæ·»åŠ ä¸€è¡Œï¼Œç›®çš„æ˜¯ç¡®ä¿ç³»ç»Ÿæœ‰è¶³å¤Ÿçš„èµ„æºå¯åŠ¨Elasticsearchï¼š</p><pre class=" language-conf"><code class="language-conf">vm.max_map_count=655360</code></pre><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç¡®ä¿é…ç½®ç”Ÿæ•ˆï¼š</p><pre><code>sysctl -p</code></pre><p>ä¿®æ”¹<code>/etc/security/limits.conf</code>ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸‹é¢å†…å®¹ï¼š</p><pre><code>* soft nofile 65536* hard nofile 131072* soft nproc 65536* hard nproc 131072</code></pre><p>ä¿®æ”¹<code>/etc/security/limits.d/20-nproc.conf</code>ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸‹é¢å†…å®¹ï¼š</p><pre><code>elk soft nproc 65536</code></pre><p>ä½¿ç”¨elkç”¨æˆ·èº«ä»½å¯åŠ¨elastic search</p><pre><code>su elkcd ../bin./elasticsearch æˆ– ./elasticsearch -d #åå°å¯åŠ¨</code></pre><p>è¿è¡ŒæˆåŠŸåï¼Œè®¿é—®9200ç«¯å£å³å¯çœ‹åˆ°ä¸€æ®µjsonè¾“å‡º</p><h2 id="elasticsearch-headä½¿ç”¨">2.2 elasticsearch headä½¿ç”¨</h2><p>elasticsearch headæ˜¯ç¬¬ä¸‰æ–¹å¼€å‘çš„ElasticSearchç•Œé¢ç®¡ç†å·¥å…·ï¼Œå¯ä»¥é€šè¿‡chromeæ’ä»¶å®‰è£…ï¼š <a href="https://chrome.google.com/webstore/detail/elasticsearch-head/ffmkiejjmecolpfloofpjologoblkegm/" target="_blank" rel="noopener">https://chrome.google.com/webstore/detail/elasticsearch-head/ffmkiejjmecolpfloofpjologoblkegm/</a></p><p><img src="https://api.codetool.top/img/15853746961730.png" alt></p><h2 id="ElasticsearchåŸºæœ¬æ¦‚å¿µ">2.3 ElasticsearchåŸºæœ¬æ¦‚å¿µ</h2><h3 id="ç´¢å¼•">2.3.1 ç´¢å¼•</h3><ul><li>ç´¢å¼•ï¼ˆindexï¼‰æ˜¯Elasticsearchå¯¹é€»è¾‘æ•°æ®çš„é€»è¾‘å­˜å‚¨ï¼Œæ‰€ä»¥å®ƒå¯ä»¥åˆ†ä¸ºæ›´å°çš„éƒ¨åˆ†ã€‚</li><li>å¯ä»¥æŠŠç´¢å¼•çœ‹æˆå…³ç³»å‹æ•°æ®åº“çš„è¡¨ï¼Œç´¢å¼•çš„ç»“æ„æ˜¯ä¸ºå¿«é€Ÿæœ‰æ•ˆçš„å…¨æ–‡ç´¢å¼•å‡†å¤‡çš„ï¼Œç‰¹åˆ«æ˜¯å®ƒä¸å­˜å‚¨åŸå§‹å€¼ã€‚</li><li>Elasticsearchå¯ä»¥æŠŠç´¢å¼•å­˜æ”¾åœ¨ä¸€å°æœºå™¨æˆ–è€…åˆ†æ•£åœ¨å¤šå°æœåŠ¡å™¨ä¸Šï¼Œæ¯ä¸ªç´¢å¼•æœ‰ä¸€æˆ–å¤šä¸ªåˆ†ç‰‡ï¼ˆshardï¼‰ï¼Œæ¯ä¸ªåˆ†ç‰‡å¯ä»¥æœ‰å¤šä¸ªå‰¯æœ¬ï¼ˆreplicaï¼‰ã€‚</li></ul><h3 id="æ–‡æ¡£">2.3.2 æ–‡æ¡£</h3><p>å°±æ˜¯luceneçš„åº•å±‚å­˜å‚¨å§ã€‚</p><ul><li>å­˜å‚¨åœ¨Elasticsearchä¸­çš„ä¸»è¦å®ä½“å«æ–‡æ¡£ï¼ˆdocumentï¼‰ã€‚ç”¨å…³ç³»å‹æ•°æ®åº“æ¥ç±»æ¯”çš„è¯ï¼Œä¸€ä¸ªæ–‡æ¡£ç›¸å½“äºæ•°æ®åº“è¡¨ä¸­çš„ä¸€è¡Œè®°å½•ã€‚</li><li>Elasticsearchå’ŒMongoDBä¸­çš„æ–‡æ¡£ç±»ä¼¼ï¼Œéƒ½å¯ä»¥æœ‰ä¸åŒçš„ç»“æ„ï¼Œä½†Elasticsearchçš„æ–‡æ¡£ä¸­ï¼Œç›¸åŒå­—æ®µå¿…é¡»æœ‰ç›¸åŒç±»å‹ã€‚</li><li>æ–‡æ¡£ç”±å¤šä¸ªå­—æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µå¯èƒ½å¤šæ¬¡å‡ºç°åœ¨ä¸€ä¸ªæ–‡æ¡£é‡Œï¼Œè¿™æ ·çš„å­—æ®µå«å¤šå€¼å­—æ®µï¼ˆmultivaluedï¼‰ã€‚</li><li>æ¯ä¸ªå­—æ®µçš„ç±»å‹ï¼Œå¯ä»¥æ˜¯æ–‡æœ¬ã€æ•°å€¼ã€æ—¥æœŸç­‰ã€‚å­—æ®µç±»å‹ä¹Ÿå¯ä»¥æ˜¯å¤æ‚ç±»å‹ï¼Œä¸€ä¸ªå­—æ®µåŒ…å«å…¶ä»–å­æ–‡æ¡£æˆ–è€…æ•°ç»„ã€‚</li></ul><h3 id="æ˜ å°„">2.3.3 æ˜ å°„</h3><ul><li>æ‰€æœ‰æ–‡æ¡£å†™è¿›ç´¢å¼•ä¹‹å‰éƒ½ä¼šå…ˆè¿›è¡Œåˆ†æï¼Œå¦‚ä½•å°†è¾“å…¥çš„æ–‡æœ¬åˆ†å‰²ä¸ºè¯æ¡ã€å“ªäº›è¯æ¡åˆä¼šè¢«è¿‡æ»¤ï¼Œè¿™ç§è¡Œä¸ºå«åšæ˜ å°„ï¼ˆmappingï¼‰ã€‚ä¸€èˆ¬ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰è§„åˆ™ã€‚</li></ul><h3 id="æ–‡æ¡£ç±»å‹">2.3.4 æ–‡æ¡£ç±»å‹</h3><ul><li>åœ¨Elasticsearchä¸­ï¼Œä¸€ä¸ªç´¢å¼•å¯¹è±¡å¯ä»¥å­˜å‚¨å¾ˆå¤šä¸åŒç”¨é€”çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåšå®¢åº”ç”¨ç¨‹åºå¯ä»¥ä¿å­˜æ–‡ç« å’Œè¯„è®ºã€‚</li><li>æ¯ä¸ªæ–‡æ¡£å¯ä»¥æœ‰ä¸åŒçš„ç»“æ„ã€‚</li><li>ä¸åŒçš„æ–‡æ¡£ç±»å‹ä¸èƒ½ä¸ºç›¸åŒçš„å±æ€§è®¾ç½®ä¸åŒçš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨åŒä¸€ç´¢å¼•ä¸­çš„æ‰€æœ‰æ–‡æ¡£ç±»å‹ä¸­ï¼Œä¸€ä¸ªå«titleçš„å­—æ®µå¿…é¡»å…·æœ‰ç›¸åŒçš„ç±»å‹ã€‚</li></ul><h1 id="RESTful-APIä½¿ç”¨">3 RESTful APIä½¿ç”¨</h1><p>åœ¨Elasticsearchä¸­ï¼Œæä¾›äº†åŠŸèƒ½ä¸°å¯Œçš„RESTful APIçš„æ“ä½œï¼ŒåŒ…æ‹¬åŸºæœ¬çš„CRUDã€åˆ›å»ºç´¢å¼•ã€åˆ é™¤ç´¢å¼•ç­‰æ“ä½œã€‚</p><h2 id="åˆ›å»ºç´¢å¼•åº“">3.1 åˆ›å»ºç´¢å¼•åº“</h2><p>åˆ›å»ºç©ºç´¢å¼•åº“ï¼š</p><pre class=" language-json"><code class="language-json">PUT /haoke<span class="token punctuation">{</span>    <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"index"</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">"number_of_shards"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span> #åˆ†ç‰‡æ•°            <span class="token property">"number_of_replicas"</span><span class="token operator">:</span> <span class="token string">"0"</span> #å‰¯æœ¬æ•°        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>#åˆ é™¤ç´¢å¼•DELETE /haoke<span class="token punctuation">{</span>    <span class="token property">"acknowledged"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span></code></pre><h2 id="æ’å…¥æ–‡æ¡£">3.2 æ’å…¥æ–‡æ¡£</h2><p>åœ¨Luceneä¸­ï¼Œåˆ›å»ºç´¢å¼•æ˜¯éœ€è¦å®šä¹‰å­—æ®µåç§°ä»¥åŠå­—æ®µçš„ç±»å‹çš„ï¼Œåœ¨Elasticsearchä¸­æä¾›äº†éç»“æ„åŒ–çš„ç´¢å¼•ï¼Œå°±æ˜¯ä¸éœ€è¦åˆ›å»ºç´¢å¼•ç»“æ„ï¼Œå³å¯å†™å…¥æ•°æ®åˆ°ç´¢å¼•ä¸­ï¼Œå®é™…ä¸Šåœ¨Elasticsearchåº•å±‚ä¼šè¿›è¡Œç»“æ„åŒ–æ“ä½œï¼Œæ­¤æ“ä½œå¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ã€‚</p><p><code>POST /{ç´¢å¼•åº“}/{ç±»å‹}/{id}</code></p><p>è¿™é‡Œçš„idæ˜¯æ‰‹åŠ¨æŒ‡å®šæ–‡æ¡£çš„idï¼Œå¦‚æœä¸å†™ä¼šåˆ†é…ä¸€ä¸ªéšæœºçš„æ–‡æ¡£idã€‚</p><pre class=" language-json"><code class="language-json">POST /haoke/user/<span class="token number">1001</span>#æ•°æ®<span class="token punctuation">{</span>    <span class="token property">"id"</span><span class="token operator">:</span><span class="token number">1001</span><span class="token punctuation">,</span>    <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">,</span>    <span class="token property">"age"</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span>    <span class="token property">"sex"</span><span class="token operator">:</span><span class="token string">"ç”·"</span><span class="token punctuation">}</span>#å“åº”<span class="token punctuation">{</span>    <span class="token property">"_index"</span><span class="token operator">:</span> <span class="token string">"haoke"</span><span class="token punctuation">,</span>    <span class="token property">"_type"</span><span class="token operator">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span>    <span class="token property">"_id"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>    <span class="token property">"_version"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token string">"created"</span><span class="token punctuation">,</span>    <span class="token property">"_shards"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"total"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"successful"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"failed"</span><span class="token operator">:</span> <span class="token number">0</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token property">"_seq_no"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token property">"_primary_term"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span></code></pre><h2 id="æ›´æ–°æ•°æ®">3.3 æ›´æ–°æ•°æ®</h2><p>ä¹Ÿå°±æ˜¯luceneçš„å…ˆåˆ é™¤å†åˆ›å»º</p><pre class=" language-json"><code class="language-json">PUT /haoke/user/<span class="token number">1001</span><span class="token punctuation">{</span>    <span class="token property">"id"</span><span class="token operator">:</span><span class="token number">1001</span><span class="token punctuation">,</span>    <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">,</span>    <span class="token property">"age"</span><span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">,</span>    <span class="token property">"sex"</span><span class="token operator">:</span><span class="token string">"å¥³"</span><span class="token punctuation">}</span></code></pre><p>å¯ä»¥é€šè¿‡åœ¨urlåé¢é™„ä¸Š/_updateæ¥å±€éƒ¨æ›´æ–°</p><pre class=" language-json"><code class="language-json">#æ³¨æ„ï¼šè¿™é‡Œå¤šäº†_updateæ ‡è¯†POST /haoke/user/<span class="token number">1001</span>/_update<span class="token punctuation">{</span>    <span class="token property">"doc"</span><span class="token operator">:</span><span class="token punctuation">{</span>        <span class="token property">"age"</span><span class="token operator">:</span><span class="token number">23</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>å“åº”çš„<code>_version</code>ä¼šåŠ ä¸€ã€‚</p><h2 id="åˆ é™¤æ–‡æ¡£">3.4 åˆ é™¤æ–‡æ¡£</h2><p>åœ¨Elasticsearchä¸­ï¼Œåˆ é™¤æ–‡æ¡£æ•°æ®ï¼Œåªéœ€è¦å‘èµ·DELETEè¯·æ±‚å³å¯ã€‚</p><pre><code>DELETE /haoke/user/1001</code></pre><p>åˆ é™¤ä¸€ä¸ªæ–‡æ¡£ä¹Ÿä¸ä¼šç«‹å³ä»ç£ç›˜ä¸Šç§»é™¤ï¼Œå®ƒåªæ˜¯è¢«æ ‡è®°æˆå·²åˆ é™¤ã€‚Elasticsearchå°†ä¼šåœ¨ä½ ä¹‹åæ·»åŠ æ›´å¤šç´¢å¼•çš„æ—¶å€™æ‰ä¼šåœ¨åå°è¿›è¡Œåˆ é™¤å†…å®¹çš„æ¸…ç†ã€‚</p><p>å“åº”çš„<code>_version</code>ä¼šåŠ ä¸€ã€‚</p><h2 id="æ™®é€šæœç´¢">3.5 æ™®é€šæœç´¢</h2><h3 id="æ ¹æ®æ–‡æ¡£idæŸ¥è¯¢">3.5.1 æ ¹æ®æ–‡æ¡£idæŸ¥è¯¢</h3><p><code>GET /_index/_type/{id}</code></p><pre class=" language-json"><code class="language-json">GET /haoke/user/BbPe_WcB9cFOnF3uebvr#è¿”å›çš„æ•°æ®å¦‚ä¸‹<span class="token punctuation">{</span>    <span class="token property">"_index"</span><span class="token operator">:</span> <span class="token string">"haoke"</span><span class="token punctuation">,</span>    <span class="token property">"_type"</span><span class="token operator">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span>    <span class="token property">"_id"</span><span class="token operator">:</span> <span class="token string">"BbPe_WcB9cFOnF3uebvr"</span><span class="token punctuation">,</span>    <span class="token property">"_version"</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>    <span class="token property">"found"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"_source"</span><span class="token operator">:</span> <span class="token punctuation">{</span>  #åŸå§‹æ•°æ®åœ¨è¿™é‡Œ        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1002</span><span class="token punctuation">,</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"æå››"</span><span class="token punctuation">,</span>        <span class="token property">"age"</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>        <span class="token property">"sex"</span><span class="token operator">:</span> <span class="token string">"ç”·"</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="è·å–å…¨éƒ¨æ•°æ®">3.5.2 è·å–å…¨éƒ¨æ•°æ®</h3><p>é»˜è®¤è¿”å›10æ¡æ•°æ®</p><pre><code>GET /haoke/user/_search</code></pre><h3 id="å…³é”®è¯æœç´¢">3.5.3 å…³é”®è¯æœç´¢</h3><pre><code>#æŸ¥è¯¢å¹´é¾„ç­‰äº20çš„ç”¨æˆ·GET /haoke/user/_search?q=age:20</code></pre><h2 id="é«˜çº§æœç´¢DSL">3.6 é«˜çº§æœç´¢DSL</h2><p>Elasticsearchæä¾›ä¸°å¯Œä¸”çµæ´»çš„æŸ¥è¯¢è¯­è¨€å«åšDSLæŸ¥è¯¢(Query DSL),å®ƒå…è®¸ä½ æ„å»ºæ›´åŠ å¤æ‚ã€å¼ºå¤§çš„æŸ¥è¯¢ã€‚</p><p>DSL(Domain Specific Languageç‰¹å®šé¢†åŸŸè¯­è¨€)ä»¥JSONè¯·æ±‚ä½“çš„å½¢å¼å‡ºç°ã€‚</p><h3 id="æ ‡å‡†æŸ¥è¯¢">3.6.1 æ ‡å‡†æŸ¥è¯¢</h3><pre class=" language-json"><code class="language-json">POST /haoke/user/_search#è¯·æ±‚ä½“<span class="token punctuation">{</span>    <span class="token property">"query"</span> <span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"match"</span> <span class="token operator">:</span> <span class="token punctuation">{</span>  #matchåªæ˜¯æŸ¥è¯¢çš„ä¸€ç§            <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">20</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="èŒƒå›´æŸ¥è¯¢">3.6.2 èŒƒå›´æŸ¥è¯¢</h3><pre class=" language-json"><code class="language-json">POST /haoke/user/_search#è¯·æ±‚æ•°æ®<span class="token punctuation">{</span>    <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                <span class="token property">"range"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                    <span class="token property">"age"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                        <span class="token property">"gt"</span><span class="token operator">:</span> <span class="token number">30</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                    <span class="token property">"sex"</span><span class="token operator">:</span> <span class="token string">"ç”·"</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p><code>bool</code>åˆæ˜¯ä¸€ä¸ªç»„åˆæŸ¥è¯¢ï¼Œå¯¹åº”luceneé‡Œé¢çš„<code>BooleanQuery</code></p><h3 id="ç²¾ç¡®åŒ¹é…">3.6.3 ç²¾ç¡®åŒ¹é…</h3><p>ä½¿ç”¨termæˆ–terms</p><h3 id="é«˜äº®æ˜¾ç¤º">3.6.4 é«˜äº®æ˜¾ç¤º</h3><p>fieldæŒ‡å®šè¦åŒ¹é…çš„åŸŸï¼Œå¯ä»¥å¡«å†™è¦é«˜äº®çš„è¯ã€‚</p><pre class=" language-json"><code class="language-json">POST /haoke/user/_search<span class="token punctuation">{</span>    <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"å¼ ä¸‰ æå››"</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token property">"highlight"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="èšåˆ">3.6.5 èšåˆ</h3><p>åœ¨Elasticsearchä¸­ï¼Œæ”¯æŒèšåˆæ“ä½œï¼Œç±»ä¼¼SQLä¸­çš„group byæ“ä½œã€‚</p><pre class=" language-json"><code class="language-json">POST /haoke/user/_search<span class="token punctuation">{</span>    <span class="token property">"aggs"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"all_interests"</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">"terms"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>è¿™è¡¨ç¤ºä½¿ç”¨â€ageâ€åŸŸè¿›è¡Œèšåˆã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Elastic-Stackæ¦‚è¿°&quot;&gt;1 Elastic Stackæ¦‚è¿°&lt;/h1&gt;&lt;p&gt;å¦‚æœä½ æ²¡æœ‰å¬è¯´è¿‡Elastic Stackï¼Œé‚£ä½ ä¸€å®šå¬è¯´è¿‡ELKï¼Œå®é™…ä¸ŠELKæ˜¯ä¸‰æ¬¾è½¯ä»¶çš„ç®€ç§°ï¼Œåˆ†åˆ«æ˜¯Elasticsearchã€ Logstashã€Kibanaç»„æˆï¼Œåœ¨å‘å±•çš„è¿‡ç¨‹
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="ElasticSearch" scheme="https://www.codetool.top/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>Luceneé«˜çº§æŸ¥è¯¢</title>
    <link href="https://www.codetool.top/article/Lucene%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/"/>
    <id>https://www.codetool.top/article/Luceneé«˜çº§æŸ¥è¯¢/</id>
    <published>2020-03-28T10:48:35.000Z</published>
    <updated>2020-03-28T10:49:05.681Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ–‡æœ¬æœç´¢">1 æ–‡æœ¬æœç´¢</h1><p>QueryParserå¯ä»¥æŒ‡å®šé»˜è®¤åŸŸï¼Œ<code>queryParser.parse</code>ä¸­åˆå¯ä»¥ç”¨<code>åŸŸå:å…³é”®è¯</code>æ¥è¦†ç›–å®ƒã€‚å¦‚æœparseä¸­æ²¡æœ‰æŒ‡å®šæœç´¢åŸŸå°±ä½¿ç”¨é»˜è®¤åŸŸã€‚</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testIndexSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 1. åˆ›å»ºQueryæœç´¢å¯¹è±¡</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºåˆ†è¯å™¨</span>    Analyzer analyzer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IKAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºæœç´¢è§£æå™¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ï¼šé»˜è®¤FieldåŸŸï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼šåˆ†è¯å™¨</span>    QueryParser queryParser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryParser</span><span class="token punctuation">(</span><span class="token string">"brandName"</span><span class="token punctuation">,</span> analyzer<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºæœç´¢å¯¹è±¡</span>    Query query <span class="token operator">=</span> queryParser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"name:åä¸ºæ‰‹æœº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 2. åˆ›å»ºDirectoryæµå¯¹è±¡,å£°æ˜ç´¢å¼•åº“ä½ç½®</span>    Directory directory <span class="token operator">=</span> FSDirectory<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>Paths<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"E:\\dir"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 3. åˆ›å»ºç´¢å¼•è¯»å–å¯¹è±¡IndexReader</span>    IndexReader reader <span class="token operator">=</span> DirectoryReader<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 4. åˆ›å»ºç´¢å¼•æœç´¢å¯¹è±¡</span>    IndexSearcher searcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexSearcher</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 5. ä½¿ç”¨ç´¢å¼•æœç´¢å¯¹è±¡ï¼Œæ‰§è¡Œæœç´¢ï¼Œè¿”å›ç»“æœé›†TopDocs</span>    <span class="token comment" spellcheck="true">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæœç´¢å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼šè¿”å›çš„æ•°æ®æ¡æ•°ï¼ŒæŒ‡å®šæŸ¥è¯¢ç»“æœæœ€é¡¶éƒ¨çš„næ¡æ•°æ®è¿”å›</span>    TopDocs topDocs <span class="token operator">=</span> searcher<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æŸ¥è¯¢åˆ°çš„æ•°æ®æ€»æ¡æ•°æ˜¯ï¼š"</span> <span class="token operator">+</span> topDocs<span class="token punctuation">.</span>totalHits<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è·å–æŸ¥è¯¢ç»“æœé›†</span>    ScoreDoc<span class="token punctuation">[</span><span class="token punctuation">]</span> docs <span class="token operator">=</span> topDocs<span class="token punctuation">.</span>scoreDocs<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 6. è§£æç»“æœé›†</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ScoreDoc scoreDoc <span class="token operator">:</span> docs<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è·å–æ–‡æ¡£</span>        <span class="token keyword">int</span> docID <span class="token operator">=</span> scoreDoc<span class="token punctuation">.</span>doc<span class="token punctuation">;</span>        Document doc <span class="token operator">=</span> searcher<span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span>docID<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"============================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"docID:"</span> <span class="token operator">+</span> docID<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"id:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"name:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"price:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"brandName:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"brandName"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"image:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"image"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 7. é‡Šæ”¾èµ„æº</span>    reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>queryParser.parseæ›´å¤šç”¨æ³•ï¼š</p><p>ä½¿ç”¨ANDæ±‚å¹¶é›†ï¼Œä½¿ç”¨ORæ±‚äº¤é›†ï¼Œæ³¨æ„å¿…é¡»å¤§å†™</p><pre class=" language-java"><code class="language-java">queryParser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"åä¸º AND æ‰‹æœº"</span><span class="token punctuation">)</span>queryParser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"åä¸º OR æ‰‹æœº"</span><span class="token punctuation">)</span></code></pre><h1 id="æ•°å€¼èŒƒå›´æŸ¥è¯¢">2 æ•°å€¼èŒƒå›´æŸ¥è¯¢</h1><p>ä¾‹å¦‚ï¼š æŸ¥è¯¢ä»·æ ¼å¤§äºç­‰äº100, å°äºç­‰äº1000çš„å•†å“</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testRangeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 1. åˆ›å»ºQueryæœç´¢å¯¹è±¡</span>    Query query <span class="token operator">=</span> FloatPoint<span class="token punctuation">.</span><span class="token function">newRangeQuery</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 2. åˆ›å»ºDirectoryæµå¯¹è±¡,å£°æ˜ç´¢å¼•åº“ä½ç½®</span>    Directory directory <span class="token operator">=</span> FSDirectory<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>Paths<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"E:\\dir"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 3. åˆ›å»ºç´¢å¼•è¯»å–å¯¹è±¡IndexReader</span>    IndexReader reader <span class="token operator">=</span> DirectoryReader<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 4. åˆ›å»ºç´¢å¼•æœç´¢å¯¹è±¡</span>    IndexSearcher searcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexSearcher</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 5. ä½¿ç”¨ç´¢å¼•æœç´¢å¯¹è±¡ï¼Œæ‰§è¡Œæœç´¢ï¼Œè¿”å›ç»“æœé›†TopDocs</span>    <span class="token comment" spellcheck="true">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæœç´¢å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼šè¿”å›çš„æ•°æ®æ¡æ•°ï¼ŒæŒ‡å®šæŸ¥è¯¢ç»“æœæœ€é¡¶éƒ¨çš„næ¡æ•°æ®è¿”å›</span>    TopDocs topDocs <span class="token operator">=</span> searcher<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æŸ¥è¯¢åˆ°çš„æ•°æ®æ€»æ¡æ•°æ˜¯ï¼š"</span> <span class="token operator">+</span> topDocs<span class="token punctuation">.</span>totalHits<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è·å–æŸ¥è¯¢ç»“æœé›†</span>    ScoreDoc<span class="token punctuation">[</span><span class="token punctuation">]</span> docs <span class="token operator">=</span> topDocs<span class="token punctuation">.</span>scoreDocs<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 6. è§£æç»“æœé›†</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ScoreDoc scoreDoc <span class="token operator">:</span> docs<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è·å–æ–‡æ¡£</span>        <span class="token keyword">int</span> docID <span class="token operator">=</span> scoreDoc<span class="token punctuation">.</span>doc<span class="token punctuation">;</span>        Document doc <span class="token operator">=</span> searcher<span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span>docID<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"============================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"docID:"</span> <span class="token operator">+</span> docID<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"id:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"name:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"price:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"brandName:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"brandName"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"image:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"image"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 7. é‡Šæ”¾èµ„æº</span>    reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h1 id="ç»„åˆæŸ¥è¯¢">3 ç»„åˆæŸ¥è¯¢</h1><p>ç»„åˆæŸ¥è¯¢å¯ä»¥ç»„åˆå¤šä¸ªæŸ¥è¯¢å¯¹è±¡ï¼Œå³å¤šä¸ªæ¡ä»¶ï¼Œä½¿ç”¨<code>BooleanQuery.Builder</code>æ„é€ ã€‚</p><p>æ¯è”ç³»ä¸€ä¸ªQueryå¯¹è±¡ï¼Œå¯ä»¥æŒ‡å®šï¼š</p><ul><li><code>BooleanClause.Occur.MUST</code> å¿…é¡» ç›¸å½“äºand, å¹¶ä¸”</li><li><code>BooleanClause.Occur.MUST_NOT</code> ä¸å¿…é¡» ç›¸å½“äºnot, é</li><li><code>BooleanClause.Occur.SHOULD</code> åº”è¯¥ ç›¸å½“äºor, æˆ–è€…</li></ul><p><strong>æ³¨æ„:</strong> å¦‚æœé€»è¾‘æ¡ä»¶ä¸­, åªæœ‰<code>MUST_NOT</code>, æˆ–è€…å¤šä¸ªé€»è¾‘æ¡ä»¶éƒ½æ˜¯<code>MUST_NOT</code>, æ— æ•ˆ, æŸ¥è¯¢ä¸å‡ºä»»ä½•æ•°æ®ã€‚</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testBooleanSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºåˆ†è¯å™¨</span>    Analyzer analyzer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IKAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºæ•°å€¼èŒƒå›´æœç´¢å¯¹è±¡</span>    Query query1 <span class="token operator">=</span> FloatPoint<span class="token punctuation">.</span><span class="token function">newRangeQuery</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    QueryParser queryParser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryParser</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> analyzer<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºæœç´¢å¯¹è±¡</span>    Query query2 <span class="token operator">=</span> queryParser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"åä¸ºæ‰‹æœº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºç»„åˆæœç´¢å¯¹è±¡</span>    BooleanQuery<span class="token punctuation">.</span>Builder builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BooleanQuery<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    builder<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BooleanClause</span><span class="token punctuation">(</span>query1<span class="token punctuation">,</span> BooleanClause<span class="token punctuation">.</span>Occur<span class="token punctuation">.</span>MUST<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    builder<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BooleanClause</span><span class="token punctuation">(</span>query2<span class="token punctuation">,</span> BooleanClause<span class="token punctuation">.</span>Occur<span class="token punctuation">.</span>MUST_NOT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 2. åˆ›å»ºDirectoryæµå¯¹è±¡,å£°æ˜ç´¢å¼•åº“ä½ç½®</span>    Directory directory <span class="token operator">=</span> FSDirectory<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>Paths<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"E:\\dir"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 3. åˆ›å»ºç´¢å¼•è¯»å–å¯¹è±¡IndexReader</span>    IndexReader reader <span class="token operator">=</span> DirectoryReader<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 4. åˆ›å»ºç´¢å¼•æœç´¢å¯¹è±¡</span>    IndexSearcher searcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexSearcher</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 5. ä½¿ç”¨ç´¢å¼•æœç´¢å¯¹è±¡ï¼Œæ‰§è¡Œæœç´¢ï¼Œè¿”å›ç»“æœé›†TopDocs</span>    <span class="token comment" spellcheck="true">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæœç´¢å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼šè¿”å›çš„æ•°æ®æ¡æ•°ï¼ŒæŒ‡å®šæŸ¥è¯¢ç»“æœæœ€é¡¶éƒ¨çš„næ¡æ•°æ®è¿”å›</span>    TopDocs topDocs <span class="token operator">=</span> searcher<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æŸ¥è¯¢åˆ°çš„æ•°æ®æ€»æ¡æ•°æ˜¯ï¼š"</span> <span class="token operator">+</span> topDocs<span class="token punctuation">.</span>totalHits<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è·å–æŸ¥è¯¢ç»“æœé›†</span>    ScoreDoc<span class="token punctuation">[</span><span class="token punctuation">]</span> docs <span class="token operator">=</span> topDocs<span class="token punctuation">.</span>scoreDocs<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 6. è§£æç»“æœé›†</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ScoreDoc scoreDoc <span class="token operator">:</span> docs<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è·å–æ–‡æ¡£</span>        <span class="token keyword">int</span> docID <span class="token operator">=</span> scoreDoc<span class="token punctuation">.</span>doc<span class="token punctuation">;</span>        Document doc <span class="token operator">=</span> searcher<span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span>docID<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"============================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"docID:"</span> <span class="token operator">+</span> docID<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"id:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"name:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"price:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"brandName:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"brandName"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"image:"</span> <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"image"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 7. é‡Šæ”¾èµ„æº</span>    reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æ–‡æœ¬æœç´¢&quot;&gt;1 æ–‡æœ¬æœç´¢&lt;/h1&gt;&lt;p&gt;QueryParserå¯ä»¥æŒ‡å®šé»˜è®¤åŸŸï¼Œ&lt;code&gt;queryParser.parse&lt;/code&gt;ä¸­åˆå¯ä»¥ç”¨&lt;code&gt;åŸŸå:å…³é”®è¯&lt;/code&gt;æ¥è¦†ç›–å®ƒã€‚å¦‚æœparseä¸­æ²¡æœ‰æŒ‡å®šæœç´¢åŸŸå°±ä½¿ç”¨é»˜è®¤åŸŸã€‚&lt;/p&gt;
&lt;pre cl
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="Lucene" scheme="https://www.codetool.top/tags/Lucene/"/>
    
  </entry>
  
  <entry>
    <title>leetcode820-å•è¯çš„å‹ç¼©ç¼–ç </title>
    <link href="https://www.codetool.top/article/leetcode820-%E5%8D%95%E8%AF%8D%E7%9A%84%E5%8E%8B%E7%BC%A9%E7%BC%96%E7%A0%81/"/>
    <id>https://www.codetool.top/article/leetcode820-å•è¯çš„å‹ç¼©ç¼–ç /</id>
    <published>2020-03-28T02:25:49.000Z</published>
    <updated>2020-03-28T02:30:58.133Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸé¢˜">1 åŸé¢˜</h1><p>ç»™å®šä¸€ä¸ªå•è¯åˆ—è¡¨ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªåˆ—è¡¨ç¼–ç æˆä¸€ä¸ªç´¢å¼•å­—ç¬¦ä¸² <code>S</code> ä¸ä¸€ä¸ªç´¢å¼•åˆ—è¡¨ <code>A</code>ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœè¿™ä¸ªåˆ—è¡¨æ˜¯ <code>[&quot;time&quot;, &quot;me&quot;, &quot;bell&quot;]</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶è¡¨ç¤ºä¸º <code>S = &quot;time#bell#&quot;</code> å’Œ <code>indexes = [0, 2, 5]</code>ã€‚</p><p>å¯¹äºæ¯ä¸€ä¸ªç´¢å¼•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»å­—ç¬¦ä¸² <code>S</code> ä¸­ç´¢å¼•çš„ä½ç½®å¼€å§‹è¯»å–å­—ç¬¦ä¸²ï¼Œç›´åˆ° â€œ#â€ ç»“æŸï¼Œæ¥æ¢å¤æˆ‘ä»¬ä¹‹å‰çš„å•è¯åˆ—è¡¨ã€‚</p><p>é‚£ä¹ˆæˆåŠŸå¯¹ç»™å®šå•è¯åˆ—è¡¨è¿›è¡Œç¼–ç çš„æœ€å°å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿ</p><p><strong>ç¤ºä¾‹:</strong></p><p><strong>è¾“å…¥:</strong> words = [â€œtimeâ€, â€œmeâ€, â€œbellâ€]<br><strong>è¾“å‡º:</strong> 10<br><strong>è¯´æ˜:</strong> S = â€œtime#bell#â€ ï¼Œ indexes = [0, 2, 5] ã€‚</p><p><strong>æç¤º:</strong></p><ol><li><code>1 &lt;= words.length &lt;= 2000</code></li><li><code>1 &lt;= words[i].length &lt;= 7</code></li><li>æ¯ä¸ªå•è¯éƒ½æ˜¯å°å†™å­—æ¯ ã€‚</li></ol><h1 id="è§£æ³•">2 è§£æ³•</h1><h2 id="æ€æƒ³">2.1 æ€æƒ³</h2><ol><li><p>æš´åŠ›æœç´¢åç¼€ã€‚</p></li><li><p><strong>ä½¿ç”¨å­—å…¸æ ‘å€’åºå­˜å‚¨å­—ç¬¦ä¸²ã€‚</strong></p></li></ol><h2 id="ä»£ç ">2.2 ä»£ç </h2><p>æš´åŠ›æ£€æŸ¥åç¼€ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minimumLengthEncoding</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>String<span class="token operator">></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>String word<span class="token operator">:</span>words<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">boolean</span> noNeedToAdd <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>word<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span>word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    list<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>                    noNeedToAdd <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token operator">==</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    noNeedToAdd <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>noNeedToAdd<span class="token punctuation">)</span> list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>String word<span class="token operator">:</span>list<span class="token punctuation">)</span><span class="token punctuation">{</span>            sum <span class="token operator">+=</span> word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> sum<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>ä½¿ç”¨å­—å…¸æ ‘å€’åºå­˜å‚¨å­—ç¬¦ä¸²ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minimumLengthEncoding</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">)</span> <span class="token punctuation">{</span>        TrieNode trie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrieNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Map<span class="token operator">&lt;</span>TrieNode<span class="token punctuation">,</span> Integer<span class="token operator">></span> nodes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> words<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            String word <span class="token operator">=</span> words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            TrieNode cur <span class="token operator">=</span> trie<span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span>                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            nodes<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>cur<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>TrieNode node<span class="token operator">:</span> nodes<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>                ans <span class="token operator">+=</span> words<span class="token punctuation">[</span>nodes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">TrieNode</span> <span class="token punctuation">{</span>    TrieNode<span class="token punctuation">[</span><span class="token punctuation">]</span> children<span class="token punctuation">;</span>    <span class="token keyword">int</span> count<span class="token punctuation">;</span>    <span class="token function">TrieNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        children <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrieNode</span><span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> TrieNode <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>children<span class="token punctuation">[</span>c <span class="token operator">-</span> <span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            children<span class="token punctuation">[</span>c <span class="token operator">-</span> <span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrieNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            count<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> children<span class="token punctuation">[</span>c <span class="token operator">-</span> <span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åŸé¢˜&quot;&gt;1 åŸé¢˜&lt;/h1&gt;&lt;p&gt;ç»™å®šä¸€ä¸ªå•è¯åˆ—è¡¨ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªåˆ—è¡¨ç¼–ç æˆä¸€ä¸ªç´¢å¼•å­—ç¬¦ä¸² &lt;code&gt;S&lt;/code&gt; ä¸ä¸€ä¸ªç´¢å¼•åˆ—è¡¨ &lt;code&gt;A&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¦‚æœè¿™ä¸ªåˆ—è¡¨æ˜¯ &lt;code&gt;[&amp;quot;time&amp;quot;, &amp;quot;m
      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="leetcode" scheme="https://www.codetool.top/tags/leetcode/"/>
    
      <category term="ç®—æ³•" scheme="https://www.codetool.top/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>è·³è¡¨-æŠ«ç€é“¾è¡¨å¤–è¡£çš„ä¼ªæœç´¢æ ‘</title>
    <link href="https://www.codetool.top/article/%E8%B7%B3%E8%A1%A8-%E6%8A%AB%E7%9D%80%E9%93%BE%E8%A1%A8%E5%A4%96%E8%A1%A3%E7%9A%84%E4%BC%AA%E6%90%9C%E7%B4%A2%E6%A0%91/"/>
    <id>https://www.codetool.top/article/è·³è¡¨-æŠ«ç€é“¾è¡¨å¤–è¡£çš„ä¼ªæœç´¢æ ‘/</id>
    <published>2020-03-27T16:06:37.000Z</published>
    <updated>2020-03-27T16:32:41.439Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡å‚è€ƒèµ„æºï¼š</p><p><a href="https://blog.csdn.net/pcwl1206/article/details/83512600" target="_blank" rel="noopener">ã€æ•°æ®ç»“æ„ä¸ç®—æ³•ã€‘ä¹‹è·³è¡¨ï¼ˆJavaå®ç°ï¼‰â€”ç¬¬ä¹ç¯‡_Java_éœ‡å“¥èŠæ ¡æ‹›-CSDNåšå®¢</a></p><p><a href="https://www.cnblogs.com/lfri/p/9991925.html" target="_blank" rel="noopener">è·³è¡¨çš„åŸç†åŠå®ä¾‹ - Rogn - åšå®¢å›­</a></p><p><a href="https://blog.csdn.net/gloomysnow/article/details/51510203" target="_blank" rel="noopener">è·³è¡¨Javaå®ç°_Java_åç¦»çš„å®šå¼¦-CSDNåšå®¢</a></p><h1 id="è·³è¡¨æ¦‚è¿°">1 è·³è¡¨æ¦‚è¿°</h1><p>å¦‚æœè¯´æŸä¸€ç§æ•°æ®ç»“æ„èƒ½è¾¾åˆ°ä»¥lognçš„é€Ÿåº¦æŸ¥æ‰¾æ•°æ®ï¼Œç›¸ä¿¡å¤§å¤šæ•°äººç¬¬ä¸€ååº”éƒ½æ˜¯äºŒåˆ†æŸ¥æ‰¾æˆ–æ˜¯æœç´¢æ ‘ã€‚</p><p>å¯¹äºäºŒåˆ†æŸ¥æ‰¾æ¥è¯´ï¼Œå®ƒé€šå¸¸æ˜¯ä¸€ä¸ªæœ‰åºæ•°ç»„ï¼Œè™½ç„¶æŸ¥æ‰¾æ•ˆç‡è¾¾åˆ°äº†lognï¼Œä½†æ’å…¥æ•ˆç‡è¦ä¹ˆå°±æ˜¯æ•°ç»„ä¸å…è®¸æ’å…¥ï¼Œè¦ä¹ˆå°±æ˜¯arraylistä¸ºlognã€‚</p><p>å¯¹äºæœç´¢æ ‘ï¼Œåˆ™å¿…é¡»è¦æ˜¯è‡ªå¹³è¡¡çš„æœç´¢æ ‘æ‰èƒ½åœ¨æ’å…¥äº†å¾ˆå¤šæ•°æ®ä¹‹åä¾ç„¶ä¿æŒlognçš„æŸ¥æ‰¾æ•ˆç‡ï¼Œè¿™å°±è¦æ±‚æ’å…¥æ¶‰åŠåˆ°æ—‹è½¬å¹³è¡¡æ“ä½œï¼Œå®ç°è¾ƒå¤æ‚ã€‚</p><p>è€Œæˆ‘ä»¬ä»Šå¤©è¦ä»‹ç»çš„ä¸»è§’â€”â€”è·³è¡¨ï¼Œç›¸è¾ƒäºçº¢é»‘æ ‘ã€AVLç­‰è‡ªå¹³è¡¡æœç´¢æ ‘çš„å®ç°ä¼šæ›´ç®€å•äº›ï¼ŒæŸ¥æ‰¾æ•ˆç‡å’Œæ’å…¥æ•ˆç‡ä¹Ÿéƒ½è¾¾åˆ°äº†lognã€‚</p><h2 id="è·³è¡¨çš„æ€§è´¨">1.1 è·³è¡¨çš„æ€§è´¨</h2><ol><li>ç”±å¾ˆå¤šå±‚ç»“æ„ç»„æˆï¼Œlevelæ˜¯é€šè¿‡ä¸€å®šçš„æ¦‚ç‡éšæœºäº§ç”Ÿçš„</li><li>æ¯ä¸€å±‚éƒ½æ˜¯ä¸€ä¸ªæœ‰åºçš„é“¾è¡¨ï¼Œé»˜è®¤æ˜¯å‡åº</li><li>æœ€åº•å±‚(Level 1)çš„é“¾è¡¨åŒ…å«æ‰€æœ‰å…ƒç´ ï¼›</li><li>å¦‚æœä¸€ä¸ªå…ƒç´ å‡ºç°åœ¨Level i çš„é“¾è¡¨ä¸­ï¼Œåˆ™å®ƒåœ¨Level i ä¹‹ä¸‹çš„é“¾è¡¨ä¹Ÿéƒ½ä¼šå‡ºç°ï¼› </li><li>æ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡å‘åŒä¸€é“¾è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæŒ‡å‘ä¸‹é¢ä¸€å±‚çš„å…ƒç´ ã€‚</li></ol><h1 id="è·³è¡¨åŸç†">2 è·³è¡¨åŸç†</h1><p>ç”¨å›¾ç‰‡å½¢å¼æ¥ç†è§£è·³è¡¨:</p><p><img src="https://api.codetool.top/img/15853249172712.jpg" alt></p><p>å¦‚ä¸‹å›¾ï¼Œå¯¹åˆå§‹é“¾è¡¨åšä¸€å±‚â€œç´¢å¼•â€ï¼Œæ¯ä¸¤ä¸ªèŠ‚ç‚¹æå–ä¸€ä¸ªèŠ‚ç‚¹åˆ°ä¸Šä¸€å±‚ï¼Œç„¶åç”¨downæŒ‡é’ˆè¿æ¥åˆ°ä¸‹ä¸€å±‚ã€‚</p><p><img src="https://api.codetool.top/img/1585324950553.jpg" alt></p><p>ç°åœ¨æˆ‘ä»¬æŸ¥è¯¢16è¿™ä¸ªèŠ‚ç‚¹ã€‚ä»ç¬¬ä¸€çº§ç´¢å¼•å¼€å§‹ï¼Œæ‰¾åˆ°13ï¼Œå¹¶ä¸”ä¸‹ä¸€ä¸ªä¸º17ï¼Œæ˜¾ç„¶16åœ¨è¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´ï¼Œåˆ©ç”¨downæŒ‡é’ˆä¸‹é™ä¸€å±‚ï¼Œè¿™æ¬¡æˆ‘ä»¬éå†2æ¬¡å³å¯ã€‚åˆ©ç”¨ç´¢å¼•åï¼Œéå†äº†5+2=7æ¬¡ï¼Œè€ŒåŸå§‹é“¾è¡¨éœ€è¦10æ¬¡ï¼Œè¿™é‡ŒåŠ ä¸€å±‚ç´¢å¼•éå†æ¬¡æ•°å‡å°‘äº†ï¼Œæ•ˆç‡æé«˜äº†ä¸€ç‚¹ï¼Œä½†è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸Šæ·»åŠ ç´¢å¼•å±‚ã€‚</p><p><img src="https://api.codetool.top/img/15853251665444.jpg" alt></p><p>è¿™é‡Œæˆ‘ä¸å†ç®—äº†ï¼Œç»“æœæ˜¯6æ¬¡ï¼Œæ•ˆç‡åˆæé«˜äº†ï¼</p><p>é‚£ä¹ˆè¿™ç§é“¾è¡¨åŠ å¤šçº§ç´¢å¼•å°±æ˜¯è·³è¡¨çš„ç»“æ„äº†ã€‚å¯ä»¥çœ‹å‡ºæ¥æœ€åå½¢æˆçš„å°±æ˜¯ä¸€ä¸ªç±»ä¼¼äºæœç´¢æ ‘çš„ç»“æ„ã€‚</p><h1 id="è·³è¡¨çš„æ“ä½œ">3 è·³è¡¨çš„æ“ä½œ</h1><p>Javaä¸­å·²ç»æœ‰äº†è·³è¡¨æ€æƒ³çš„å®ç°ï¼šconcurrentåŒ…ä¸‹çš„<code>ConcurrentSkipListMap</code>(åœ¨åŠŸèƒ½ä¸Šå¯¹åº”HashTableã€HashMapã€TreeMap)å’Œ <code>ConcurrentSkipListSet</code>(åœ¨åŠŸèƒ½ä¸Šå¯¹åº”HashSet)ã€‚</p><h2 id="è·³è¡¨çš„æ’å…¥">3.1 è·³è¡¨çš„æ’å…¥</h2><p>è·³è¡¨æ’å…¥çš„æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(logn)ï¼Œæ”¯æŒé«˜æ•ˆçš„åŠ¨æ€æ’å…¥ã€‚</p><p>åœ¨å•é“¾è¡¨ä¸­ï¼Œä¸€æ—¦å®šä½å¥½è¦æ’å…¥çš„ä½ç½®ï¼Œæ’å…¥ç»“ç‚¹çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¾ˆä½çš„ï¼Œå°±æ˜¯O(1)ã€‚ä½†æ˜¯ä¸ºäº†ä¿è¯åŸå§‹é“¾è¡¨ä¸­æ•°æ®çš„æœ‰åºæ€§ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰¾åˆ°è¦æ’å…¥çš„ä½ç½®ï¼Œè¿™ä¸ªæŸ¥æ‰¾çš„æ“ä½œå°±ä¼šæ¯”è¾ƒè€—æ—¶ã€‚</p><p>å¯¹äºçº¯ç²¹çš„å•é“¾è¡¨ï¼Œéœ€è¦éå†æ¯ä¸ªç»“ç‚¹ï¼Œæ¥æ‰¾åˆ°æ’å…¥çš„ä½ç½®ã€‚ä½†æ˜¯å¯¹äºè·³è¡¨æ¥è¯´ï¼ŒæŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(logn)ï¼Œæ‰€ä»¥è¿™é‡ŒæŸ¥æ‰¾æŸä¸ªæ•°æ®åº”è¯¥æ’å…¥çš„ä½ç½®çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯O(logn)ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://api.codetool.top/img/15853256465422.png" alt></p><h2 id="è·³è¡¨çš„åˆ é™¤">3.2 è·³è¡¨çš„åˆ é™¤</h2><p>è·³è¡¨çš„åˆ é™¤æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(logn)ï¼Œæ”¯æŒåŠ¨æ€çš„åˆ é™¤ã€‚</p><p>åœ¨è·³è¡¨ä¸­åˆ é™¤æŸä¸ªç»“ç‚¹æ—¶ï¼Œå¦‚æœè¿™ä¸ªç»“ç‚¹åœ¨ç´¢å¼•ä¸­ä¹Ÿå‡ºç°äº†ï¼Œæˆ‘ä»¬<strong>é™¤äº†è¦åˆ é™¤åŸå§‹é“¾è¡¨ä¸­çš„ç»“ç‚¹ï¼Œè¿˜è¦åˆ é™¤ç´¢å¼•ä¸­çš„</strong>ã€‚å› ä¸ºå•é“¾è¡¨ä¸­çš„åˆ é™¤æ“ä½œéœ€è¦æ‹¿åˆ°åˆ é™¤ç»“ç‚¹çš„å‰é©±ç»“ç‚¹ï¼Œç„¶åå†é€šè¿‡æŒ‡é’ˆæ“ä½œå®Œæˆåˆ é™¤ã€‚æ‰€ä»¥åœ¨æŸ¥æ‰¾è¦åˆ é™¤çš„ç»“ç‚¹çš„æ—¶å€™ï¼Œä¸€å®šè¦è·å–å‰é©±ç»“ç‚¹ï¼ˆåŒå‘é“¾è¡¨é™¤å¤–ï¼‰ã€‚å› æ­¤è·³è¡¨çš„åˆ é™¤æ“ä½œæ—¶é—´å¤æ‚åº¦å³ä¸ºO(logn)ã€‚</p><h2 id="è·³è¡¨ç´¢å¼•åŠ¨æ€æ›´æ–°">3.3 è·³è¡¨ç´¢å¼•åŠ¨æ€æ›´æ–°</h2><p>å½“æˆ‘ä»¬ä¸æ–­åœ°å¾€è·³è¡¨ä¸­æ’å…¥æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¦‚æœä¸æ›´æ–°ç´¢å¼•ï¼Œå°±æœ‰å¯èƒ½å‡ºç°æŸ2ä¸ªç´¢å¼•èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®éå¸¸å¤šçš„æƒ…å†µï¼Œåœ¨æç«¯æƒ…å†µä¸‹ï¼Œè·³è¡¨è¿˜ä¼šé€€åŒ–æˆå•é“¾è¡¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://api.codetool.top/img/15853257169186.png" alt></p><p>ä½œä¸ºä¸€ç§åŠ¨æ€æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦æŸç§æ‰‹æ®µæ¥ç»´æŠ¤ç´¢å¼•ä¸åŸå§‹é“¾è¡¨å¤§å°ä¹‹é—´çš„å¹³è¡¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœé“¾è¡¨ä¸­çš„ç»“ç‚¹å¤šäº†ï¼Œç´¢å¼•ç»“ç‚¹å°±ç›¸åº”åœ°å¢åŠ ä¸€äº›ï¼Œé¿å…å¤æ‚åº¦é€€åŒ–ï¼Œä»¥åŠæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œæ€§èƒ½çš„ä¸‹é™ã€‚</p><p>å¦‚æœä½ äº†è§£çº¢é»‘æ ‘ã€AVLæ ‘è¿™æ ·çš„å¹³è¡¡äºŒå‰æ ‘ï¼Œä½ å°±ä¼šçŸ¥é“å®ƒä»¬æ˜¯é€šè¿‡å·¦å³æ—‹çš„æ–¹å¼ä¿æŒå·¦å³å­æ ‘çš„å¤§å°å¹³è¡¡ï¼Œ<strong>è€Œè·³è¡¨æ˜¯é€šè¿‡éšæœºå‡½æ•°æ¥ç»´æŠ¤â€œå¹³è¡¡æ€§â€ã€‚</strong></p><p><strong>å½“æˆ‘ä»¬å¾€è·³è¡¨ä¸­æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªéšæœºå‡½æ•°ï¼Œæ¥å†³å®šè¿™ä¸ªç»“ç‚¹æ’å…¥åˆ°å“ªå‡ çº§ç´¢å¼•å±‚ä¸­</strong>ï¼Œæ¯”å¦‚éšæœºå‡½æ•°ç”Ÿæˆäº†å€¼Kï¼Œé‚£æˆ‘ä»¬å°±å°†è¿™ä¸ªç»“ç‚¹æ·»åŠ åˆ°ç¬¬ä¸€çº§åˆ°ç¬¬Kçº§è¿™ä¸ªKçº§ç´¢å¼•ä¸­ã€‚å¦‚ä¸‹å›¾ä¸­è¦æ’å…¥æ•°æ®ä¸º6ï¼ŒK=2çš„ä¾‹å­ï¼š</p><p><img src="https://api.codetool.top/img/15853257588573.png" alt></p><p>éšæœºå‡½æ•°çš„é€‰æ‹©æ˜¯éå¸¸æœ‰è®²ç©¶çš„ï¼Œä»æ¦‚ç‡ä¸Šè®²ï¼Œèƒ½å¤Ÿä¿è¯è·³è¡¨çš„ç´¢å¼•å¤§å°å’Œæ•°æ®å¤§å°å¹³è¡¡æ€§ï¼Œä¸è‡³äºæ€§èƒ½çš„è¿‡åº¦é€€åŒ–ã€‚è‡³äºéšæœºå‡½æ•°çš„é€‰æ‹©ï¼Œè§ä¸‹é¢çš„ä»£ç å®ç°è¿‡ç¨‹ï¼Œè€Œä¸”å®ç°è¿‡ç¨‹å¹¶ä¸æ˜¯é‡ç‚¹ï¼ŒæŒæ¡æ€æƒ³å³å¯ã€‚</p><h1 id="è·³è¡¨çš„Javaå®ç°">4 è·³è¡¨çš„Javaå®ç°</h1><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// è·³è¡¨ä¸­å­˜å‚¨çš„æ˜¯æ­£æ•´æ•°ï¼Œå¹¶ä¸”å­˜å‚¨çš„æ•°æ®æ˜¯ä¸é‡å¤çš„</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SkipList</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_LEVEL <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// ç»“ç‚¹çš„ä¸ªæ•°</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> levelCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// ç´¢å¼•çš„å±‚çº§æ•°</span>    <span class="token keyword">private</span> Node head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å¤´ç»“ç‚¹</span>    <span class="token keyword">private</span> Random random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// Nodeå†…éƒ¨ç±»</span>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token keyword">int</span> data <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> Node next<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>MAX_LEVEL<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token keyword">int</span> maxLevel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// é‡å†™toStringæ–¹æ³•</span>        <span class="token annotation punctuation">@Override</span>        <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            StringBuilder builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"{data:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>            builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"; leves: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>maxLevel<span class="token punctuation">)</span><span class="token punctuation">;</span>            builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" }"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// æŸ¥æ‰¾æ“ä½œ</span>    <span class="token keyword">public</span> Node <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>        Node p <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> levelCount <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> p<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data <span class="token operator">&lt;</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>                p <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> p<span class="token punctuation">.</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data <span class="token operator">==</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> p<span class="token punctuation">.</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// æ‰¾åˆ°ï¼Œåˆ™è¿”å›åŸå§‹é“¾è¡¨ä¸­çš„ç»“ç‚¹</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> null<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// æ’å…¥æ“ä½œ</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">int</span> level <span class="token operator">=</span> <span class="token function">randomLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Node newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        newNode<span class="token punctuation">.</span>data <span class="token operator">=</span> value<span class="token punctuation">;</span>        newNode<span class="token punctuation">.</span>maxLevel <span class="token operator">=</span> level<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// é€šè¿‡éšæœºå‡½æ•°æ”¹å˜ç´¢å¼•å±‚çš„ç»“ç‚¹å¸ƒç½®</span>        Node update<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>level<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> level<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>            update<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        Node p <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> level <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> p<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data <span class="token operator">&lt;</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>                p <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            update<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> level<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>            newNode<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> update<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            update<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> newNode<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>levelCount <span class="token operator">&lt;</span> level<span class="token punctuation">)</span><span class="token punctuation">{</span>            levelCount <span class="token operator">=</span> level<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// åˆ é™¤æ“ä½œ</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>        Node<span class="token punctuation">[</span><span class="token punctuation">]</span> update <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>levelCount<span class="token punctuation">]</span><span class="token punctuation">;</span>        Node p <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> levelCount <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> p<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data <span class="token operator">&lt;</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>                p <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            update<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> p<span class="token punctuation">.</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data <span class="token operator">==</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> levelCount <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>update<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> update<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data <span class="token operator">==</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>                    update<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> update<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// éšæœºå‡½æ•°</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">randomLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">int</span> level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MAX_LEVEL<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                level<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> level<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// æ˜¾ç¤ºè·³è¡¨ä¸­çš„ç»“ç‚¹</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        Node p <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            p <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h1 id="è·³è¡¨çš„åº”ç”¨">5 è·³è¡¨çš„åº”ç”¨</h1><ul><li>Lucene3.0ç‰ˆæœ¬ä¹‹å‰ä½¿ç”¨è·³è¡¨ç»“æ„å­˜å‚¨è¯å…¸ï¼Œåæ¥æ¢æˆäº†FSTï¼ˆæœ‰é™çŠ¶æ€è½¬ç§»æœºï¼‰</li><li>Redisåœ¨ä¸¤ä¸ªåœ°æ–¹ç”¨åˆ°äº†è·³è·ƒè¡¨ï¼Œä¸€ä¸ªæ˜¯å®ç°æœ‰åºé›†åˆé”®ï¼Œå¦ä¸€ä¸ªæ˜¯åœ¨é›†ç¾¤èŠ‚ç‚¹ä¸­ç”¨ä½œå†…éƒ¨æ•°æ®ç»“æ„ã€‚</li><li>â€¦â€¦</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ¬æ–‡å‚è€ƒèµ„æºï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/pcwl1206/article/details/83512600&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ã€æ•°æ®ç»“æ„ä¸ç®—æ³•ã€‘ä¹‹è·³è¡¨ï¼ˆJavaå®ç°ï¼‰â€”ç¬¬ä¹ç¯‡_
      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="æ•°æ®ç»“æ„" scheme="https://www.codetool.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>Luceneä¸­çš„åˆ†è¯å™¨æ¦‚è¿°</title>
    <link href="https://www.codetool.top/article/Lucene%E4%B8%AD%E7%9A%84%E5%88%86%E8%AF%8D%E5%99%A8%E6%A6%82%E8%BF%B0/"/>
    <id>https://www.codetool.top/article/Luceneä¸­çš„åˆ†è¯å™¨æ¦‚è¿°/</id>
    <published>2020-03-27T12:46:35.000Z</published>
    <updated>2020-03-27T12:46:53.507Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åˆ†è¯å™¨æ¦‚è¿°">1 åˆ†è¯å™¨æ¦‚è¿°</h1><p>åœ¨å¯¹Documentä¸­çš„å†…å®¹è¿›è¡Œç´¢å¼•ä¹‹å‰ï¼Œéœ€è¦ä½¿ç”¨åˆ†è¯å™¨ï¼ˆAnalyzerï¼‰è¿›è¡Œåˆ†è¯ï¼Œåˆ†è¯çš„ç›®çš„æ˜¯ä¸ºäº†æœç´¢ã€‚åˆ†è¯çš„ä¸»è¦è¿‡ç¨‹å°±æ˜¯å…ˆåˆ†è¯åè¿‡æ»¤ã€‚</p><ul><li>åˆ†è¯ï¼šé‡‡é›†åˆ°çš„æ•°æ®ä¼šå­˜å‚¨åˆ°documentå¯¹è±¡çš„FieldåŸŸä¸­ï¼Œåˆ†è¯å°±æ˜¯å°†Documentä¸­Fieldçš„valueå€¼åˆ‡åˆ†æˆä¸€ä¸ªä¸€ä¸ªçš„è¯ã€‚</li><li>è¿‡æ»¤ï¼šåŒ…æ‹¬å»é™¤æ ‡ç‚¹ç¬¦å·è¿‡æ»¤ã€å»é™¤åœç”¨è¯è¿‡æ»¤(çš„ã€æ˜¯ã€aã€an. theç­‰)ã€å¤§å†™è½¬å°å†™ã€è¯çš„å½¢è¿˜åŸ(å¤æ•°å½¢å¼è½¬æˆå•æ•°å½¢å‚ã€è¿‡å»å¼è½¬æˆç°åœ¨å¼ã€‚ã€‚ã€‚)ç­‰ã€‚</li></ul><p><strong>åœç”¨è¯ï¼š</strong> åœç”¨è¯æ˜¯ä¸ºèŠ‚çœå­˜å‚¨ç©ºé—´å’Œæé«˜æœç´¢æ•ˆç‡ï¼Œæœç´¢å¼•æ“åœ¨ç´¢å¼•é¡µé¢æˆ–å¤„ç†æœç´¢è¯·æ±‚æ—¶ä¼šè‡ªåŠ¨å¿½ç•¥æŸäº›å­—æˆ–è¯ï¼Œè¿™äº›å­—æˆ–è¯å³è¢«ç§°ä¸ºStop Words(åœç”¨è¯)ã€‚æ¯”å¦‚è¯­æ°”åŠ©è¯ã€å‰¯è¯ã€ä»‹è¯ã€è¿æ¥è¯ç­‰ï¼Œé€šå¸¸<strong>è‡ªèº«å¹¶æ— æ˜ç¡®çš„æ„ä¹‰ï¼Œåªæœ‰å°†å…¶æ”¾å…¥ä¸€ä¸ªå®Œæ•´çš„å¥å­ä¸­æ‰æœ‰ä¸€å®šä½œç”¨</strong>ï¼Œå¦‚å¸¸è§çš„â€œçš„â€ã€â€œåœ¨â€ã€â€œæ˜¯â€ã€â€œå•Šâ€ç­‰ã€‚</p><p>å¯¹äºåˆ†è¯æ¥è¯´ï¼Œä¸åŒçš„è¯­è¨€ï¼Œåˆ†è¯è§„åˆ™ä¸åŒã€‚Luceneä½œä¸ºä¸€ä¸ªå·¥å…·åŒ…æä¾›ä¸åŒè¯­è¨€çš„åˆ†è¯å™¨ã€‚</p><p>ä¸è®ºæ˜¯å»ºç«‹ç´¢å¼•è¿˜æ˜¯æŸ¥è¯¢çš„æ—¶å€™éƒ½è¦ä½¿ç”¨åˆ†è¯å™¨ï¼Œè€Œä¸”æœ€å¥½æ˜¯ä½¿ç”¨åŒä¸€ä¸ªåˆ†è¯å™¨ã€‚</p><h1 id="LuceneåŸç”Ÿåˆ†è¯å™¨">2 LuceneåŸç”Ÿåˆ†è¯å™¨</h1><h2 id="StandardAnalyzer">2.1 StandardAnalyzer</h2><p><strong>ç‰¹ç‚¹:</strong> Luceneæä¾›çš„æ ‡å‡†åˆ†è¯å™¨, å¯ä»¥å¯¹ç”¨è‹±æ–‡è¿›è¡Œåˆ†è¯, å¯¹ä¸­æ–‡æ˜¯å•å­—åˆ†è¯, ä¹Ÿå°±æ˜¯ä¸€ä¸ªå­—å°±è®¤ä¸ºæ˜¯ä¸€ä¸ªè¯ã€‚</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">protected</span> TokenStreamComponents <span class="token function">createComponents</span><span class="token punctuation">(</span><span class="token keyword">final</span> String fieldName<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">final</span> StandardTokenizer src <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StandardTokenizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    src<span class="token punctuation">.</span><span class="token function">setMaxTokenLength</span><span class="token punctuation">(</span>maxTokenLength<span class="token punctuation">)</span><span class="token punctuation">;</span>    TokenStream tok <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LowerCaseFilter</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>    tok <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StopFilter</span><span class="token punctuation">(</span>tok<span class="token punctuation">,</span> stopwords<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TokenStreamComponents</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> tok<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token annotation punctuation">@Override</span>        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">setReader</span><span class="token punctuation">(</span><span class="token keyword">final</span> Reader reader<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// So that if maxTokenLength was changed, the change takes</span>            <span class="token comment" spellcheck="true">// effect next time tokenStream is called:</span>            src<span class="token punctuation">.</span><span class="token function">setMaxTokenLength</span><span class="token punctuation">(</span>StandardAnalyzer<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>maxTokenLength<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">setReader</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>Tokenizer å°±æ˜¯åˆ†è¯å™¨ï¼Œè´Ÿè´£å°†readerè½¬æ¢ä¸ºè¯­æ±‡å•å…ƒå³è¿›è¡Œåˆ†è¯å¤„ç†ï¼ŒLuceneæä¾›äº†å¾ˆå¤šçš„åˆ†è¯å™¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„åˆ†è¯ï¼Œæ¯”å¦‚IKAnalyzerä¸€ä¸ªä¸­æ–‡åˆ†è¯å™¨ã€‚</p><p>TokenFilteræ˜¯åˆ†è¯è¿‡æ»¤å™¨ï¼Œè´Ÿè´£å¯¹è¯­æ±‡å•å…ƒè¿›è¡Œè¿‡æ»¤ï¼ŒTokenFilterå¯ä»¥æ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨é“¾ï¼ŒLuceneæä¾›äº†å¾ˆå¤šçš„åˆ†è¯å™¨è¿‡æ»¤å™¨ï¼Œæ¯”å¦‚å¤§å°å†™è½¬æ¢ã€å»é™¤åœç”¨è¯ç­‰ã€‚</p><p>å¦‚ä¸‹å›¾æ˜¯è¯­æ±‡å•å…ƒçš„ç”Ÿæˆè¿‡ç¨‹ï¼š</p><p><img src="https://api.codetool.top/img/15853089586548.jpg" alt></p><p>ä»ä¸€ä¸ª Readerå­—ç¬¦æµå¼€å§‹ï¼Œåˆ›å»ºä¸€ä¸ªåŸºäºReaderçš„Tokenizeråˆ†è¯å™¨ï¼Œç»è¿‡ä¸‰ä¸ªTokenFilterç”Ÿæˆè¯­æ±‡å•å…ƒTokenã€‚</p><h2 id="WhitespaceAnalyzer">2.2 WhitespaceAnalyzer</h2><p><strong>ç‰¹ç‚¹:</strong> ä»…ä»…æ˜¯å»æ‰äº†ç©ºæ ¼ï¼Œæ²¡æœ‰å…¶ä»–ä»»ä½•æ“ä½œï¼Œä¸æ”¯æŒä¸­æ–‡ã€‚</p><h2 id="SimpleAnalyzer">2.3 SimpleAnalyzer</h2><p><strong>ç‰¹ç‚¹:</strong> å°†é™¤äº†å­—æ¯ä»¥å¤–çš„ç¬¦å·å…¨éƒ¨å»é™¤ï¼Œå¹¶ä¸”å°†æ‰€æœ‰å­—æ¯å˜ä¸ºå°å†™ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªåˆ†è¯å™¨åŒæ ·æŠŠæ•°å­—ä¹Ÿå»é™¤äº†ï¼ŒåŒæ ·ä¸æ”¯æŒä¸­æ–‡ã€‚</p><h2 id="CJKAnalyzer">2.4 CJKAnalyzer</h2><p><strong>ç‰¹ç‚¹:</strong> è¿™ä¸ªæ”¯æŒä¸­æ—¥éŸ©æ–‡å­—ï¼Œå‰ä¸‰ä¸ªå­—æ¯ä¹Ÿå°±æ˜¯è¿™ä¸‰ä¸ªå›½å®¶çš„ç¼©å†™ã€‚å¯¹ä¸­æ–‡æ˜¯äºŒåˆ†æ³•åˆ†è¯, å»æ‰ç©ºæ ¼, å»æ‰æ ‡ç‚¹ç¬¦å·ã€‚ä¸ªäººæ„Ÿè§‰å¯¹ä¸­æ–‡æ”¯æŒä¾æ—§å¾ˆçƒ‚ã€‚</p><h1 id="ç¬¬ä¸‰æ–¹åˆ†è¯å™¨ç®€ä»‹">3 ç¬¬ä¸‰æ–¹åˆ†è¯å™¨ç®€ä»‹</h1><ul><li>paoding ï¼š åº–ä¸è§£ç‰›æœ€æ–°ç‰ˆåœ¨ <a href="https://code.google.com/p/paoding/" target="_blank" rel="noopener">https://code.google.com/p/paoding/</a> ä¸­æœ€å¤šæ”¯æŒLucene 3.0ï¼Œä¸”æœ€æ–°æäº¤çš„ä»£ç åœ¨ 2008-06-03ï¼Œåœ¨svnä¸­æœ€æ–°ä¹Ÿæ˜¯2010å¹´æäº¤ï¼Œå·²ç»è¿‡æ—¶ï¼Œä¸äºˆè€ƒè™‘ã€‚</li><li>mmseg4j ï¼šæœ€æ–°ç‰ˆå·²ä» <a href="https://code.google.com/p/mmseg4j/" target="_blank" rel="noopener">https://code.google.com/p/mmseg4j/</a> ç§»è‡³ <a href="https://github.com/chenlb/mmseg4j-solrï¼Œæ”¯æŒLucene" target="_blank" rel="noopener">https://github.com/chenlb/mmseg4j-solrï¼Œæ”¯æŒLucene</a> 4.10ï¼Œä¸”åœ¨githubä¸­æœ€æ–°æäº¤ä»£ç æ˜¯2017å¹´1æœˆï¼Œä»09å¹´~14å¹´ä¸€å…±æœ‰18ä¸ªç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯ä¸€å¹´å‡ ä¹æœ‰3ä¸ªå¤§å°ç‰ˆæœ¬ï¼Œæœ‰è¾ƒå¤§çš„æ´»è·ƒåº¦ï¼Œç”¨äº†mmsegç®—æ³•ã€‚</li><li>IK-analyzer ï¼š æœ€æ–°ç‰ˆåœ¨ <a href="https://code.google.com/p/ik-analyzer/ä¸Šï¼Œæ”¯æŒLucene" target="_blank" rel="noopener">https://code.google.com/p/ik-analyzer/ä¸Šï¼Œæ”¯æŒLucene</a> 4.10ä»2006å¹´12æœˆæ¨å‡º1.0ç‰ˆå¼€å§‹ï¼Œ IKAnalyzerå·²ç»æ¨å‡ºäº†4ä¸ªå¤§ç‰ˆæœ¬ã€‚æœ€åˆï¼Œå®ƒæ˜¯ä»¥å¼€æºé¡¹ç›®Luenceä¸ºåº”ç”¨ä¸»ä½“çš„ï¼Œç»“åˆè¯å…¸åˆ†è¯å’Œæ–‡æ³•åˆ†æç®—æ³•çš„ä¸­æ–‡åˆ†è¯ç»„ä»¶ã€‚ä»3.0ç‰ˆæœ¬å¼€å§‹ï¼Œ<strong>IKå‘å±•ä¸ºé¢å‘Javaçš„å…¬ç”¨åˆ†è¯ç»„ä»¶ï¼Œç‹¬ç«‹äºLuceneé¡¹ç›®ï¼ŒåŒæ—¶æä¾›äº†å¯¹Luceneçš„é»˜è®¤ä¼˜åŒ–å®ç°ã€‚åœ¨2012ç‰ˆæœ¬ä¸­ï¼ŒIKå®ç°äº†ç®€å•çš„åˆ†è¯æ­§ä¹‰æ’é™¤ç®—æ³•ï¼Œæ ‡å¿—ç€IKåˆ†è¯å™¨ä»å•çº¯çš„è¯å…¸åˆ†è¯å‘æ¨¡æ‹Ÿè¯­ä¹‰åˆ†è¯è¡åŒ–ã€‚</strong> ä½†æ˜¯ä¹Ÿå°±æ˜¯2012å¹´12æœˆåæ²¡æœ‰å†æ›´æ–°ã€‚</li><li>ansj_seg ï¼šæœ€æ–°ç‰ˆæœ¬åœ¨ <a href="https://github.com/NLPchina/ansj_seg" target="_blank" rel="noopener">https://github.com/NLPchina/ansj_seg</a> tagsä»…æœ‰1.1ç‰ˆæœ¬ï¼Œä»2012å¹´åˆ°2014å¹´æ›´æ–°äº†å¤§å°6æ¬¡ï¼Œä½†æ˜¯ä½œè€…æœ¬äººåœ¨2014å¹´10æœˆ10æ—¥è¯´æ˜ï¼šâ€œå¯èƒ½æˆ‘ä»¥åæ²¡æœ‰ç²¾åŠ›æ¥ç»´æŠ¤ansj_segäº†â€ï¼Œç°åœ¨ç”±â€nlp_chinaâ€ç®¡ç†ã€‚2014å¹´11æœˆæœ‰æ›´æ–°ã€‚å¹¶æœªè¯´æ˜æ˜¯å¦æ”¯æŒLuceneï¼Œæ˜¯ä¸€ä¸ªç”±CRFï¼ˆæ¡ä»¶éšæœºåœºï¼‰ç®—æ³•æ‰€åšçš„åˆ†è¯ç®—æ³•ã€‚</li><li>imdict-chinese-analyzer ï¼šæœ€æ–°ç‰ˆåœ¨ <a href="https://code.google.com/p/imdict-chinese-analyzer/" target="_blank" rel="noopener">https://code.google.com/p/imdict-chinese-analyzer/</a> ï¼Œ æœ€æ–°æ›´æ–°ä¹Ÿåœ¨2009å¹´5æœˆï¼Œä¸‹è½½æºç ï¼Œä¸æ”¯æŒLucene 4.10 ã€‚æ˜¯åˆ©ç”¨HMMï¼ˆéšé©¬å°”ç§‘å¤«é“¾ï¼‰ç®—æ³•ã€‚</li><li>Jcseg ï¼šæœ€æ–°ç‰ˆæœ¬åœ¨git.oschina.net/lionsoul/jcsegï¼Œæ”¯æŒLucene 4.10ï¼Œä½œè€…æœ‰è¾ƒé«˜çš„æ´»è·ƒåº¦ã€‚åˆ©ç”¨mmsegç®—æ³•ã€‚</li></ul><p>ikåˆ†è¯å™¨ç”¨æˆ·å¯è‡ªå®šä¹‰æ‹“å±•ï¼š</p><ul><li>æ‰©å±•è¯å…¸:<br>æ”¾ä¸“æœ‰åè¯ï¼Œæˆ–è€…æ˜¯æˆ‘ä»¬è®¤ä¸ºéœ€è¦å¼ºåˆ¶å°†æŸä¸€äº›å­—åˆ†æˆä¸€ä¸ªè¯ã€‚å‡¡æ˜¯å‡ºç°åœ¨æ‰©å±•è¯å…¸ä¸­çš„è¯ï¼Œå°±ä¼šè¢«å¼ºåˆ¶åˆ†æˆä¸€ä¸ªè¯ã€‚</li><li>åœç”¨è¯å…¸:<br>å‡¡æ˜¯å‡ºç°åœ¨åœç”¨è¯å…¸ä¸­çš„è¯ï¼Œéƒ½ä¼šè¢«è¿‡æ»¤æ‰.</li></ul><p>å…ˆå»ºç«‹é…ç½®æ–‡ä»¶<code>IKAnalyzer.cfg.xml</code>ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token doctype">&lt;!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comment</span><span class="token punctuation">></span></span>IK Analyzer æ‰©å±•é…ç½®<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comment</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ext_dict<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ext.dic;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ext_stopwords<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>stopword.dic;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span></code></pre><p><code>ext.dic</code>ä¸ºæ‹“å±•è¯å…¸ï¼Œæ¯ä¸ªè¯å•ç‹¬å ä¸€è¡Œï¼š</p><pre><code>åä¸ºæ‰‹æœºåä¸ºæ‰‹æœºæ£®é©¬å—æäººä¸‰æ˜Ÿè‹¹æœ</code></pre><p><code>stopword.dic</code>ä¸ºæ‹“å±•è¯å…¸ï¼Œæ¯ä¸ªè¯å•ç‹¬å ä¸€è¡Œï¼š</p><pre><code>aanandareasatbebutbyforifinintoisitnonotofon...</code></pre><p>æµ‹è¯•ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestIKAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 1. åˆ›å»ºåˆ†è¯å™¨,åˆ†ææ–‡æ¡£ï¼Œå¯¹æ–‡æ¡£è¿›è¡Œåˆ†è¯</span>    Analyzer analyzer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IKAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 2. åˆ›å»ºDirectoryå¯¹è±¡,å£°æ˜ç´¢å¼•åº“çš„ä½ç½®</span>    Directory directory <span class="token operator">=</span> FSDirectory<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>Paths<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"E:\\dir"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 3. åˆ›å»ºIndexWriteConfigå¯¹è±¡ï¼Œå†™å…¥ç´¢å¼•éœ€è¦çš„é…ç½®</span>    IndexWriterConfig config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexWriterConfig</span><span class="token punctuation">(</span>analyzer<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 4.åˆ›å»ºIndexWriterå†™å…¥å¯¹è±¡</span>    IndexWriter indexWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexWriter</span><span class="token punctuation">(</span>directory<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 5.å†™å…¥åˆ°ç´¢å¼•åº“ï¼Œé€šè¿‡IndexWriteræ·»åŠ æ–‡æ¡£å¯¹è±¡document</span>    Document doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    doc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> "vivo X23 8GB<span class="token operator">+</span>128GB å¹»å¤œè“<span class="token punctuation">,</span>æ°´æ»´å±å…¨é¢å±<span class="token punctuation">,</span>æ¸¸æˆæ‰‹æœº<span class="token punctuation">.</span>ç§»    åŠ¨è”é€šç”µä¿¡å…¨ç½‘é€š4Gæ‰‹æœº"<span class="token punctuation">,</span> Field<span class="token punctuation">.</span>Store<span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    indexWriter<span class="token punctuation">.</span><span class="token function">addDocument</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 6.é‡Šæ”¾èµ„æº</span>    indexWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åˆ†è¯å™¨æ¦‚è¿°&quot;&gt;1 åˆ†è¯å™¨æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;åœ¨å¯¹Documentä¸­çš„å†…å®¹è¿›è¡Œç´¢å¼•ä¹‹å‰ï¼Œéœ€è¦ä½¿ç”¨åˆ†è¯å™¨ï¼ˆAnalyzerï¼‰è¿›è¡Œåˆ†è¯ï¼Œåˆ†è¯çš„ç›®çš„æ˜¯ä¸ºäº†æœç´¢ã€‚åˆ†è¯çš„ä¸»è¦è¿‡ç¨‹å°±æ˜¯å…ˆåˆ†è¯åè¿‡æ»¤ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†è¯ï¼šé‡‡é›†åˆ°çš„æ•°æ®ä¼šå­˜å‚¨åˆ°documentå¯¹è±¡çš„Fi
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="Lucene" scheme="https://www.codetool.top/tags/Lucene/"/>
    
  </entry>
  
  <entry>
    <title>Luceneä¸­çš„åŸŸç±»å‹åŠæ–‡æ¡£çš„æ›´æ–°/åˆ é™¤</title>
    <link href="https://www.codetool.top/article/Lucene%E4%B8%AD%E7%9A%84%E5%9F%9F%E7%B1%BB%E5%9E%8B%E5%8F%8A%E6%96%87%E6%A1%A3%E7%9A%84%E6%9B%B4%E6%96%B0-%E5%88%A0%E9%99%A4/"/>
    <id>https://www.codetool.top/article/Luceneä¸­çš„åŸŸç±»å‹åŠæ–‡æ¡£çš„æ›´æ–°-åˆ é™¤/</id>
    <published>2020-03-27T11:13:31.000Z</published>
    <updated>2020-03-27T16:27:13.501Z</updated>
    
    <content type="html"><![CDATA[<h1 id="FieldåŸŸ">1 FieldåŸŸ</h1><p>Fieldæ˜¯æ–‡æ¡£ä¸­çš„åŸŸï¼ŒåŒ…æ‹¬Fieldåå’ŒFieldå€¼ä¸¤éƒ¨åˆ†ï¼Œä¸€ä¸ªæ–‡æ¡£å¯ä»¥åŒ…æ‹¬å¤šä¸ªFieldï¼ŒDocumentåªæ˜¯Fieldçš„ä¸€ä¸ªæ‰¿è½½ä½“ï¼ŒFieldå€¼å³ä¸ºè¦ç´¢å¼•çš„å†…å®¹ï¼Œä¹Ÿæ˜¯è¦æœç´¢çš„å†…å®¹ã€‚</p><h2 id="Fieldå±æ€§">1.1 Fieldå±æ€§</h2><h3 id="æ˜¯å¦åˆ†è¯-tokenized">1.1.1 æ˜¯å¦åˆ†è¯ (tokenized)</h3><ul><li>æ˜¯ï¼šä½œåˆ†è¯å¤„ç†ï¼Œå³å°†Fieldå€¼è¿›è¡Œåˆ†è¯ï¼Œåˆ†è¯çš„ç›®çš„æ˜¯ä¸ºäº†ç´¢å¼•ã€‚</li></ul><p>æ¯”å¦‚ï¼šå•†å“åç§°ã€å•†å“æè¿°ç­‰ï¼Œè¿™äº›å†…å®¹ç”¨æˆ·è¦è¾“å…¥å…³é”®å­—æœç´¢ï¼Œ<strong>ç”±äºæœç´¢çš„å†…å®¹æ ¼å¼å¤§ã€å†…å®¹å¤šéœ€è¦åˆ†è¯åå°†è¯­æ±‡å•å…ƒå»ºç«‹ç´¢å¼•</strong></p><ul><li>å¦ï¼šä¸ä½œåˆ†è¯å¤„ç†</li></ul><p>æ¯”å¦‚ï¼šå•†å“idã€è®¢å•å·ã€èº«ä»½è¯å·ç­‰</p><h3 id="æ˜¯å¦ç´¢å¼•-indexed">1.1.2 æ˜¯å¦ç´¢å¼• (indexed)</h3><ul><li>æ˜¯ï¼šè¿›è¡Œç´¢å¼•ã€‚å°†Fieldåˆ†è¯åçš„è¯æˆ–æ•´ä¸ªFieldå€¼è¿›è¡Œç´¢å¼•ï¼Œå­˜å‚¨åˆ°ç´¢å¼•åŸŸï¼Œç´¢å¼•çš„ç›®çš„æ˜¯ä¸ºäº†æœç´¢ã€‚</li></ul><p>æ¯”å¦‚ï¼šå•†å“åç§°ã€å•†å“æè¿°åˆ†æåè¿›è¡Œç´¢å¼•ï¼Œ<strong>è®¢å•å·ã€èº«ä»½è¯å·ä¸ç”¨åˆ†è¯ä½†ä¹Ÿè¦ç´¢å¼•</strong>ï¼Œè¿™äº›å°†æ¥éƒ½è¦ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ã€‚</p><ul><li>å¦ï¼šä¸ç´¢å¼•ã€‚<strong>å¦‚æœä¸éœ€è¦ç´¢å¼•å°±ä¸éœ€è¦åˆ†è¯ã€‚</strong></li></ul><p>æ¯”å¦‚ï¼šå›¾ç‰‡è·¯å¾„ã€æ–‡ä»¶è·¯å¾„ç­‰ï¼Œä¸ç”¨ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„ä¸ç”¨ç´¢å¼•ã€‚</p><h3 id="æ˜¯å¦å­˜å‚¨-stored">1.1.3 æ˜¯å¦å­˜å‚¨ (stored)</h3><ul><li>æ˜¯ï¼šå°†Fieldå€¼å­˜å‚¨åœ¨æ–‡æ¡£åŸŸä¸­ï¼Œå­˜å‚¨åœ¨æ–‡æ¡£åŸŸä¸­çš„Fieldæ‰å¯ä»¥ä»Documentä¸­è·å–ã€‚</li></ul><p>æ¯”å¦‚ï¼šå•†å“åç§°ã€è®¢å•å·ï¼Œå‡¡æ˜¯å°†æ¥<strong>è¦ä»Documentä¸­è·å–çš„Fieldéƒ½è¦å­˜å‚¨ã€‚</strong></p><ul><li>å¦ï¼šä¸å­˜å‚¨Fieldå€¼</li></ul><p>æ¯”å¦‚ï¼šå•†å“æè¿°ï¼Œ<strong>å†…å®¹è¾ƒå¤§ä¸ç”¨å­˜å‚¨</strong>ã€‚å¦‚æœè¦å‘ç”¨æˆ·å±•ç¤ºå•†å“æè¿°å¯ä»¥ä»ç³»ç»Ÿçš„å…³ç³»æ•°æ®åº“ä¸­è·å–</p><h2 id="Fieldç±»å‹">1.2 Fieldç±»å‹</h2><p>ä¸‹è¾¹åˆ—å‡ºäº†å¼€å‘ä¸­å¸¸ç”¨ çš„Filedç±»å‹ï¼Œæ³¨æ„Fieldçš„å±æ€§ï¼Œæ ¹æ®éœ€æ±‚é€‰æ‹©ï¼š</p><table><thead><tr><th>Fieldç±»</th><th>æ•°æ®ç±»å‹</th><th>Analyzedæ˜¯å¦åˆ†è¯</th><th>Indexedæ˜¯å¦ç´¢å¼•</th><th>Storedæ˜¯å¦å­˜å‚¨</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>StringField(FieldName,FieldValue,Store.YES))</td><td>å­—ç¬¦ä¸²</td><td>N</td><td>Y</td><td>Yæˆ–N</td><td>è¿™ä¸ªFieldç”¨æ¥æ„å»ºä¸€ä¸ªå­—ç¬¦ä¸²Fieldï¼Œä½†æ˜¯ä¸ä¼šè¿›è¡Œåˆ†è¯ï¼Œä¼šå°†æ•´ä¸ªä¸²å­˜å‚¨åœ¨ç´¢å¼•ä¸­ï¼Œæ¯”å¦‚(è®¢å•å·,èº«ä»½è¯å·ç­‰)æ˜¯å¦å­˜å‚¨åœ¨æ–‡æ¡£ä¸­ç”¨Store.YESæˆ–Store.NOå†³å®š</td></tr><tr><td>FloatPoint(FieldName, FieldValue)</td><td>Floatå‹</td><td>Y</td><td>Y</td><td>N</td><td>è¿™ä¸ªFieldç”¨æ¥æ„å»ºä¸€ä¸ªFloatæ•°å­—å‹Fieldï¼Œè¿›è¡Œåˆ†è¯å’Œç´¢å¼•ï¼Œä¸å­˜å‚¨, æ¯”å¦‚(ä»·æ ¼) å­˜å‚¨åœ¨æ–‡æ¡£ä¸­</td></tr><tr><td>DoublePoint(FieldName,FieldValue)</td><td>Doubleå‹</td><td>Y</td><td>Y</td><td>N</td><td>è¿™ä¸ªFieldç”¨æ¥æ„å»ºä¸€ä¸ªDoubleæ•°å­—å‹Fieldï¼Œè¿›è¡Œåˆ†è¯å’Œç´¢å¼•ï¼Œä¸å­˜å‚¨</td></tr><tr><td>LongPoint(FieldName, FieldValue)</td><td>Longå‹</td><td>Y</td><td>Y</td><td>N</td><td>è¿™ä¸ªFieldç”¨æ¥æ„å»ºä¸€ä¸ªLongæ•°å­—å‹Fieldï¼Œè¿›è¡Œåˆ†è¯å’Œç´¢å¼•ï¼Œä¸å­˜å‚¨</td></tr><tr><td>IntPoint(FieldName, FieldValue)</td><td>Integerå‹</td><td>Y</td><td>Y</td><td>N</td><td>è¿™ä¸ªFieldç”¨æ¥æ„å»ºä¸€ä¸ªIntegeræ•°å­—å‹Fieldï¼Œè¿›è¡Œåˆ†è¯å’Œç´¢å¼•ï¼Œä¸å­˜å‚¨</td></tr><tr><td>StoredField(FieldName, FieldValue)</td><td>é‡è½½æ–¹æ³•ï¼Œæ”¯æŒå¤šç§ç±»å‹</td><td>N</td><td>N</td><td>Y</td><td>è¿™ä¸ªFieldç”¨æ¥æ„å»ºä¸åŒç±»å‹Fieldä¸åˆ†æï¼Œä¸ç´¢å¼•ï¼Œä½†è¦Fieldå­˜å‚¨åœ¨æ–‡æ¡£ä¸­</td></tr><tr><td>TextField(FieldName, FieldValue, Store.NO) æˆ– TextField(FieldName,reader)</td><td>å­—ç¬¦ä¸²æˆ–æµ</td><td>Y</td><td>Y</td><td>Yæˆ–N</td><td>å¦‚æœæ˜¯ä¸€ä¸ªReader, luceneçŒœæµ‹å†…å®¹æ¯”è¾ƒå¤š,ä¼šé‡‡ç”¨Unstoredçš„ç­–ç•¥.</td></tr><tr><td>NumericDocValuesField(FieldName,FieldValue)</td><td>æ•°å€¼</td><td>-</td><td>-</td><td>-</td><td>é…åˆå…¶ä»–åŸŸæ’åºä½¿ç”¨</td></tr></tbody></table><p><strong>å¯¹äºæ•°å€¼ç±»å‹çš„æ•°æ®ï¼Œåˆ†è¯å¯ä»¥å®ç°èŒƒå›´æŸ¥è¯¢ã€‚</strong></p><h1 id="ç´¢å¼•ç»´æŠ¤">2 ç´¢å¼•ç»´æŠ¤</h1><h2 id="æ›´æ–°">2.1 æ›´æ–°</h2><p>ç®¡ç†äººå‘˜é€šè¿‡ç”µå•†ç³»ç»Ÿæ›´æ”¹å›¾ä¹¦ä¿¡æ¯ï¼Œè¿™æ—¶æ›´æ–°çš„æ˜¯å…³ç³»æ•°æ®åº“ï¼Œå¦‚æœä½¿ç”¨luceneæœç´¢å›¾ä¹¦ä¿¡æ¯ï¼Œ<strong>éœ€è¦åœ¨æ•°æ®åº“è¡¨bookä¿¡æ¯å˜åŒ–æ—¶åŠæ—¶æ›´æ–°luceneç´¢å¼•åº“ã€‚</strong></p><p>ç¤ºä¾‹ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateIndexTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºæ›´æ”¹ç›®æ ‡å¯¹è±¡</span>    Document document <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringField</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span><span class="token string">"100000003145"</span><span class="token punctuation">,</span> Field<span class="token punctuation">.</span>Store<span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"xxx"</span><span class="token punctuation">,</span>Field<span class="token punctuation">.</span>Store<span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IntPoint</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StoredField</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StoredField</span><span class="token punctuation">(</span><span class="token string">"image"</span><span class="token punctuation">,</span> <span class="token string">"xxx.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringField</span><span class="token punctuation">(</span><span class="token string">"categoryName"</span><span class="token punctuation">,</span> <span class="token string">"æ‰‹æœº"</span><span class="token punctuation">,</span>Field<span class="token punctuation">.</span>Store<span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringField</span><span class="token punctuation">(</span><span class="token string">"brandName"</span><span class="token punctuation">,</span> <span class="token string">"åä¸º"</span><span class="token punctuation">,</span>Field<span class="token punctuation">.</span>Store<span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºåˆ†è¯å™¨</span>    Analyzer analyzer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StandardAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºDirectoryç›®å½•å¯¹è±¡ï¼Œè¡¨ç¤ºç´¢å¼•åº“çš„ä½ç½®</span>    Directory dir <span class="token operator">=</span> FSDirectory<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>Paths<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"D:\\dir"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºIndexWriterConfigå¯¹è±¡ï¼ŒæŒ‡å®šåˆ‡åˆ†è¯ä½¿ç”¨çš„åˆ†è¯å™¨</span>    IndexWriterConfig config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexWriterConfig</span><span class="token punctuation">(</span>analyzer<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºIndexWriterè¾“å‡ºæµå¯¹è±¡ï¼ŒæŒ‡å®šè¾“å‡ºçš„ä½ç½®å’Œä½¿ç”¨çš„configåˆå§‹åŒ–å¯¹è±¡</span>    IndexWriter indexWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexWriter</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// ä¿®æ”¹ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ï¼šä¿®æ”¹æ¡ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼šä¿®æ”¹æˆçš„å†…å®¹</span>    indexWriter<span class="token punctuation">.</span><span class="token function">updateDocument</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Term</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span><span class="token string">"100000003145"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>document<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// é‡Šæ”¾èµ„æº</span>    indexWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>Luceneçš„ä¿®æ”¹å®é™…æ˜¯å°†å¯¹åº”çš„æ–‡æ¡£åˆ é™¤ç„¶åæ–°å»ºæ–‡æ¡£ã€‚</p><p>æ³¨æ„ï¼Œä¸èƒ½æ·»åŠ ä¸€ä¸ªåŸŸç±»å‹å’Œå…¶ä»–æ–‡æ¡£çš„åŸŸä¸ä¸€æ ·çš„æ–‡æ¡£ï¼Œå¦åˆ™æ‰“å¼€ç´¢å¼•åº“ä¼šæŠ¥é”™ï¼š</p><pre><code>java.lang.IllegalArgumentException: cannot change field &quot;brandName&quot; from index options=DOCS to inconsistent index options=DOCS_AND_FREQS_AND_POSITIONS    at org.apache.lucene.index.FieldInfo.update(FieldInfo.java:154) ~[luke-swing-with-deps.jar:?]    at org.apache.lucene.index.FieldInfos$Builder.addOrUpdateInternal(FieldInfos.java:534) ~[luke-swing-with-deps.jar:?]    at org.apache.lucene.index.FieldInfos$Builder.add(FieldInfos.java:559) ~[luke-swing-with-deps.jar:?]    at org.apache.lucene.index.FieldInfos$Builder.add(FieldInfos.java:554) ~[luke-swing-with-deps.jar:?]    at org.apache.lucene.index.FieldInfos$Builder.add(FieldInfos.java:480) ~[luke-swing-with-deps.jar:?]    at org.apache.lucene.index.FieldInfos.getMergedFieldInfos(FieldInfos.java:154) ~[luke-swing-with-deps.jar:?]    at org.apache.lucene.luke.models.util.IndexUtils.getFieldInfos(IndexUtils.java:379) ~[luke-swing-with-deps.jar:?]    ......</code></pre><h2 id="åˆ é™¤">2.2 åˆ é™¤</h2><pre class=" language-java"><code class="language-java"> <span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteIndexTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºåˆ†è¯å™¨ï¼ŒStandardAnalyzerå¯¹è‹±æ–‡åˆ†è¯æ•ˆæœå¥½ï¼Œå¯¹ä¸­æ–‡æ˜¯å•å­—åˆ†è¯</span>    Analyzer analyzer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StandardAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºDirectoryç›®å½•å¯¹è±¡ï¼Œè¡¨ç¤ºç´¢å¼•åº“çš„ä½ç½®</span>    Directory dir <span class="token operator">=</span> FSDirectory<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>Paths<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"D:\\dir"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºIndexWriterConfigå¯¹è±¡ï¼ŒæŒ‡å®šåˆ‡åˆ†è¯ä½¿ç”¨çš„åˆ†è¯å™¨</span>    IndexWriterConfig config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexWriterConfig</span><span class="token punctuation">(</span>analyzer<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ›å»ºIndexWriterè¾“å‡ºæµå¯¹è±¡ï¼ŒæŒ‡å®šè¾“å‡ºçš„ä½ç½®å’Œä½¿ç”¨çš„configåˆå§‹åŒ–å¯¹è±¡</span>    IndexWriter indexWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexWriter</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åˆ é™¤</span>    indexWriter<span class="token punctuation">.</span><span class="token function">deleteDocuments</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Term</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span><span class="token string">"100000003145"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// é‡Šæ”¾èµ„æº</span>    indexWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;FieldåŸŸ&quot;&gt;1 FieldåŸŸ&lt;/h1&gt;&lt;p&gt;Fieldæ˜¯æ–‡æ¡£ä¸­çš„åŸŸï¼ŒåŒ…æ‹¬Fieldåå’ŒFieldå€¼ä¸¤éƒ¨åˆ†ï¼Œä¸€ä¸ªæ–‡æ¡£å¯ä»¥åŒ…æ‹¬å¤šä¸ªFieldï¼ŒDocumentåªæ˜¯Fieldçš„ä¸€ä¸ªæ‰¿è½½ä½“ï¼ŒFieldå€¼å³ä¸ºè¦ç´¢å¼•çš„å†…å®¹ï¼Œä¹Ÿæ˜¯è¦æœç´¢çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Fi
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="Lucene" scheme="https://www.codetool.top/tags/Lucene/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†å¸ƒå¼ç³»ç»Ÿè®¤è¯æ–¹å¼ä¸OAuth2.0æ¦‚è¿°</title>
    <link href="https://www.codetool.top/article/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E8%AE%A4%E8%AF%81%E6%96%B9%E5%BC%8F%E4%B8%8EOAuth2-0%E6%A6%82%E8%BF%B0/"/>
    <id>https://www.codetool.top/article/åˆ†å¸ƒå¼ç³»ç»Ÿè®¤è¯æ–¹å¼ä¸OAuth2-0æ¦‚è¿°/</id>
    <published>2020-03-27T09:09:38.000Z</published>
    <updated>2020-03-27T09:11:11.752Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Session">1 Session</h1><p>åˆ†å¸ƒå¼session</p><p>è¿™ä¸ªæ—¶å€™ï¼Œé€šå¸¸çš„åšæ³•æœ‰ä¸‹é¢å‡ ç§ï¼š</p><ul><li>Sessionå¤åˆ¶ï¼šå¤šå°åº”ç”¨æœåŠ¡å™¨ä¹‹é—´åŒæ­¥sessionï¼Œä½¿sessionä¿æŒä¸€è‡´ï¼Œå¯¹å¤–é€æ˜ã€‚</li><li>Sessioné»è´´ï¼šå½“ç”¨æˆ·è®¿é—®é›†ç¾¤ä¸­æŸå°æœåŠ¡å™¨åï¼Œå¼ºåˆ¶æŒ‡å®šåç»­æ‰€æœ‰è¯·æ±‚å‡è½åˆ°æ­¤æœºå™¨ä¸Šã€‚</li><li>Sessioné›†ä¸­å­˜å‚¨ï¼šå°†Sessionå­˜å…¥åˆ†å¸ƒå¼ç¼“å­˜ä¸­ï¼Œæ‰€æœ‰æœåŠ¡å™¨åº”ç”¨å®ä¾‹ç»Ÿä¸€ä»åˆ†å¸ƒå¼ç¼“å­˜ä¸­å­˜å–Sessionã€‚</li></ul><p>æ€»ä½“æ¥è®²ï¼ŒåŸºäºsessionè®¤è¯çš„è®¤è¯æ–¹å¼ï¼Œå¯ä»¥æ›´å¥½çš„åœ¨æœåŠ¡ç«¯å¯¹ä¼šè¯è¿›è¡Œæ§åˆ¶ï¼Œä¸”å®‰å…¨æ€§è¾ƒé«˜ã€‚ä½†æ˜¯ï¼Œ<strong>sessionæœºåˆ¶æ–¹å¼åŸºäºcookieï¼Œåœ¨å¤æ‚å¤šæ ·çš„ç§»åŠ¨å®¢æˆ·ç«¯ä¸Šä¸èƒ½æœ‰æ•ˆçš„ä½¿ç”¨</strong>ï¼Œå¹¶ä¸”æ— æ³•è·¨åŸŸï¼Œå¦å¤–éšç€ç³»ç»Ÿçš„æ‰©å±•éœ€æé«˜sessionçš„å¤åˆ¶ã€é»è´´åŠå­˜å‚¨çš„å®¹é”™æ€§ã€‚</p><h1 id="åŸºäºtokençš„è®¤è¯æ–¹å¼">2 åŸºäºtokençš„è®¤è¯æ–¹å¼</h1><p>åŸºäºtokençš„è®¤è¯æ–¹å¼ï¼ŒæœåŠ¡ç«¯ä¸ç”¨å­˜å‚¨è®¤è¯æ•°æ®ï¼Œæ˜“ç»´æŠ¤æ‰©å±•æ€§å¼ºï¼Œ å®¢æˆ·ç«¯å¯ä»¥æŠŠtoken å­˜åœ¨ä»»æ„åœ°æ–¹ï¼Œå¹¶ä¸”å¯ä»¥å®ç°webå’Œappç»Ÿä¸€è®¤è¯æœºåˆ¶ã€‚å…¶ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œtokenç”±äºè‡ªåŒ…å«ä¿¡æ¯ï¼Œå› æ­¤ä¸€èˆ¬æ•°æ®é‡è¾ƒå¤§ï¼Œè€Œä¸”æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦ä¼ é€’ï¼Œå› æ­¤æ¯”è¾ƒå å¸¦å®½ã€‚å¦å¤–ï¼Œtokençš„ç­¾åéªŒç­¾æ“ä½œä¹Ÿä¼šç»™cpuå¸¦æ¥é¢å¤–çš„å¤„ç†è´Ÿæ‹…ã€‚</p><p><img src="https://api.codetool.top/img/15852961056443.jpg" alt></p><p>ä¼˜ç‚¹ï¼š</p><ol><li>é€‚åˆç»Ÿä¸€è®¤è¯çš„æœºåˆ¶ï¼Œå®¢æˆ·ç«¯ã€ä¸€æ–¹åº”ç”¨ã€ä¸‰æ–¹åº”ç”¨éƒ½éµå¾ªä¸€è‡´çš„è®¤è¯æœºåˆ¶ã€‚</li><li>tokenè®¤è¯æ–¹å¼å¯¹ç¬¬ä¸‰æ–¹åº”ç”¨æ¥å…¥æ›´é€‚åˆï¼Œå› ä¸ºå®ƒæ›´å¼€æ”¾ï¼Œå¯ä½¿ç”¨å½“å‰æœ‰æµè¡Œçš„å¼€æ”¾åè®®<code>OAuth2.0</code>ã€<code>JWT</code>ç­‰ã€‚</li><li>ä¸€èˆ¬æƒ…å†µæœåŠ¡ç«¯æ— éœ€å­˜å‚¨ä¼šè¯ä¿¡æ¯ï¼Œå‡è½»äº†æœåŠ¡ç«¯çš„å‹åŠ›</li></ol><h1 id="OAuth2-0ä»‹ç»">3 OAuth2.0ä»‹ç»</h1><p>OAuthï¼ˆå¼€æ”¾æˆæƒï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œå…è®¸ç”¨æˆ·æˆæƒç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®ä»–ä»¬å­˜å‚¨åœ¨å¦å¤–çš„æœåŠ¡æä¾›è€…ä¸Šçš„ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦å°†ç”¨æˆ·åå’Œå¯†ç æä¾›ç»™ç¬¬ä¸‰æ–¹åº”ç”¨æˆ–åˆ†äº«ä»–ä»¬æ•°æ®çš„æ‰€æœ‰å†…å®¹ã€‚OAuth2.0æ˜¯OAuthåè®®çš„å»¶ç»­ç‰ˆæœ¬ï¼Œä½†ä¸å‘åå…¼å®¹OAuth 1.0å³å®Œå…¨åºŸæ­¢äº†OAuth1.0ã€‚å¾ˆå¤šå¤§å…¬å¸å¦‚Googleï¼ŒYahooï¼ŒMicrosoftç­‰éƒ½æä¾›äº†OAUTHè®¤è¯æœåŠ¡ï¼Œè¿™äº›éƒ½è¶³ä»¥è¯´æ˜OAUTHæ ‡å‡†é€æ¸æˆä¸ºå¼€æ”¾èµ„æºæˆæƒçš„æ ‡å‡†ã€‚</p><p>Oauthåè®®ç›®å‰å‘å±•åˆ°2.0ç‰ˆæœ¬ï¼Œ1.0ç‰ˆæœ¬è¿‡äºå¤æ‚ï¼Œ2.0ç‰ˆæœ¬å·²å¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚</p><p>OAauth2.0åŒ…æ‹¬ä»¥ä¸‹è§’è‰²ï¼š</p><ol><li>å®¢æˆ·ç«¯<br>æœ¬èº«ä¸å­˜å‚¨èµ„æºï¼Œéœ€è¦é€šè¿‡èµ„æºæ‹¥æœ‰è€…çš„æˆæƒå»è¯·æ±‚èµ„æºæœåŠ¡å™¨çš„èµ„æºï¼Œæ¯”å¦‚ï¼šAndroidå®¢æˆ·ç«¯ã€Webå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ç«¯ï¼‰ã€å¾®ä¿¡å®¢æˆ·ç«¯ç­‰ã€‚</li><li>èµ„æºæ‹¥æœ‰è€…<br>é€šå¸¸ä¸ºç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥æ˜¯åº”ç”¨ç¨‹åºï¼Œå³è¯¥èµ„æºçš„æ‹¥æœ‰è€…ã€‚</li><li>æˆæƒæœåŠ¡å™¨ï¼ˆä¹Ÿç§°è®¤è¯æœåŠ¡å™¨ï¼‰<br>ç”¨äºæœåŠ¡æä¾›å•†å¯¹èµ„æºæ‹¥æœ‰çš„èº«ä»½è¿›è¡Œè®¤è¯ã€å¯¹è®¿é—®èµ„æºè¿›è¡Œæˆæƒï¼Œè®¤è¯æˆåŠŸåä¼šç»™å®¢æˆ·ç«¯å‘æ”¾ä»¤ç‰Œï¼ˆaccess_tokenï¼‰ï¼Œä½œä¸ºå®¢æˆ·ç«¯è®¿é—®èµ„æºæœåŠ¡å™¨çš„å‡­æ®ã€‚</li><li>èµ„æºæœåŠ¡å™¨<br>å­˜å‚¨èµ„æºçš„æœåŠ¡å™¨ã€‚  </li></ol><p>ç°åœ¨è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼ŒæœåŠ¡æä¾›å•†èƒ½å…è®¸éšä¾¿ä¸€ä¸ªå®¢æˆ·ç«¯å°±æ¥å…¥åˆ°å®ƒçš„æˆæƒæœåŠ¡å™¨å—ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼ŒæœåŠ¡æä¾›å•†ä¼šç»™å‡†å…¥çš„æ¥å…¥æ–¹ä¸€ä¸ªèº«ä»½ï¼Œç”¨äºæ¥å…¥æ—¶çš„å‡­æ®:  </p><ul><li><code>client_id</code>ï¼šå®¢æˆ·ç«¯æ ‡è¯† </li><li><code>client_secret</code>ï¼šå®¢æˆ·ç«¯ç§˜é’¥  </li></ul><p>å› æ­¤ï¼Œå‡†ç¡®æ¥è¯´ï¼ŒæˆæƒæœåŠ¡å™¨å¯¹ä¸¤ç§OAuth2.0ä¸­çš„ä¸¤ä¸ªè§’è‰²è¿›è¡Œè®¤è¯æˆæƒï¼Œåˆ†åˆ«æ˜¯èµ„æºæ‹¥æœ‰è€…ã€å®¢æˆ·ç«¯ã€‚</p><p><img src="https://api.codetool.top/img/15852993699961.jpg" alt></p><ol><li>å®¢æˆ·ç«¯è¯·æ±‚ç¬¬ä¸‰æ–¹æˆæƒ</li><li>èµ„æºæ‹¥æœ‰è€…åŒæ„ç»™å®¢æˆ·ç«¯æˆæƒ</li><li>å®¢æˆ·ç«¯è·å–åˆ°æˆæƒç ï¼Œè¯·æ±‚è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œ</li><li>è®¤è¯æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å“åº”ä»¤ç‰Œ</li><li>å®¢æˆ·ç«¯æºå¸¦ä»¤ç‰Œè¯·æ±‚èµ„æºæœåŠ¡å™¨çš„èµ„æº</li><li>èµ„æºæœåŠ¡å™¨è¿”å›å—ä¿æŠ¤èµ„æº</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Session&quot;&gt;1 Session&lt;/h1&gt;&lt;p&gt;åˆ†å¸ƒå¼session&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™ï¼Œé€šå¸¸çš„åšæ³•æœ‰ä¸‹é¢å‡ ç§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Sessionå¤åˆ¶ï¼šå¤šå°åº”ç”¨æœåŠ¡å™¨ä¹‹é—´åŒæ­¥sessionï¼Œä½¿sessionä¿æŒä¸€è‡´ï¼Œå¯¹å¤–é€æ˜ã€‚&lt;/li&gt;
&lt;li&gt;S
      
    
    </summary>
    
    
      <category term="é¡¹ç›®/ç¼–ç¨‹ç†è®º" scheme="https://www.codetool.top/categories/%E9%A1%B9%E7%9B%AE-%E7%BC%96%E7%A8%8B%E7%90%86%E8%AE%BA/"/>
    
    
      <category term="å®‰å…¨" scheme="https://www.codetool.top/tags/%E5%AE%89%E5%85%A8/"/>
    
      <category term="åˆ†å¸ƒå¼" scheme="https://www.codetool.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Spring Securityæ ¸å¿ƒç»„ä»¶</title>
    <link href="https://www.codetool.top/article/Spring%20Security%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/"/>
    <id>https://www.codetool.top/article/Spring Securityæ ¸å¿ƒç»„ä»¶/</id>
    <published>2020-03-27T07:53:54.000Z</published>
    <updated>2020-03-27T07:54:48.178Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Authentication">1 Authentication</h1><p>è®¤è¯ä¿¡æ¯ï¼Œåœ¨Spring Securityç”¨æˆ·è®¤è¯æµç¨‹ä¸­ï¼Œç”¨æˆ·æäº¤çš„ä¿¡æ¯è¢«Spring Securityå°è£…æˆä¸€ä¸ªAuthenticationå¯¹è±¡ï¼Œä¸åŒçš„è®¤è¯æ–¹å¼éœ€è¦çš„Authenticationå®ç°å¯èƒ½æ˜¯ä¸åŒçš„ï¼Œé€šå¸¸è¡¨å•ç™»å½•ä½¿ç”¨çš„æ˜¯å®ç°ç±»<code>UsernamePasswordAuthenticationToken</code>ï¼Œå®ƒåŒ…å«ç”¨æˆ·çš„ç”¨æˆ·åã€å¯†ç ç­‰ä¿¡æ¯ã€‚</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Authentication</span> <span class="token keyword">extends</span> <span class="token class-name">Principal</span><span class="token punctuation">,</span> Serializable <span class="token punctuation">{</span>    Collection<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">GrantedAuthority</span><span class="token operator">></span> <span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Object <span class="token function">getCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Object <span class="token function">getDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Object <span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> <span class="token function">isAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">setAuthenticated</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> isAuthenticated<span class="token punctuation">)</span> <span class="token keyword">throws</span> IllegalArgumentException<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><ol><li>Authenticationæ˜¯spring securityåŒ…ä¸­çš„æ¥å£ï¼Œç›´æ¥ç»§æ‰¿è‡ª<code>Principal</code>ç±»ï¼Œè€ŒPrincipalæ˜¯ä½äº <code>java.security</code> åŒ…ä¸­çš„ã€‚å®ƒæ˜¯è¡¨ç¤ºç€ä¸€ä¸ªæŠ½è±¡ä¸»ä½“èº«ä»½ï¼Œä»»ä½•ä¸»ä½“éƒ½æœ‰ä¸€ä¸ªåç§°ï¼Œå› æ­¤åŒ…å«ä¸€ä¸ª<code>getName()</code>æ–¹æ³•ã€‚</li><li><code>getAuthorities()</code>ï¼Œæƒé™ä¿¡æ¯åˆ—è¡¨ï¼Œé»˜è®¤æ˜¯<code>GrantedAuthority</code>æ¥å£çš„ä¸€äº›å®ç°ç±»ï¼Œé€šå¸¸æ˜¯ä»£è¡¨æƒé™ä¿¡æ¯çš„ä¸€ç³»åˆ—å­—ç¬¦ä¸²ã€‚</li><li><code>getCredentials()</code>ï¼Œå‡­è¯ä¿¡æ¯ï¼Œç”¨æˆ·è¾“å…¥çš„å¯†ç å­—ç¬¦ä¸²ï¼Œåœ¨è®¤è¯è¿‡åé€šå¸¸ä¼šè¢«ç§»é™¤ï¼Œç”¨äºä¿éšœå®‰å…¨ã€‚</li><li><code>getDetails()</code>ï¼Œç»†èŠ‚ä¿¡æ¯ï¼Œwebåº”ç”¨ä¸­çš„å®ç°æ¥å£é€šå¸¸ä¸º WebAuthenticationDetailsï¼Œå®ƒè®°å½•äº†è®¿é—®è€…çš„ipåœ°å€å’ŒsessionIdçš„å€¼ã€‚</li><li><code>getPrincipal()</code>ï¼Œèº«ä»½ä¿¡æ¯ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿”å›çš„æ˜¯UserDetailsæ¥å£çš„å®ç°ç±»ï¼ŒUserDetailsä»£è¡¨ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼Œé‚£ä»Authenticationä¸­å–å‡ºæ¥çš„UserDetailså°±æ˜¯å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼Œå®ƒä¹Ÿæ˜¯æ¡†æ¶ä¸­çš„å¸¸ç”¨æ¥å£ä¹‹ä¸€ã€‚</li></ol><h1 id="UserDetailService">2 UserDetailService</h1><p>UserDetailServiceæ˜¯Spring Securityä¸­è¾ƒä¸ºæ ¸å¿ƒçš„ä¸€ä¸ªç»„ä»¶ï¼Œåœ¨è®¤è¯æµç¨‹ä¸­ï¼ŒSpring Securityé€šè¿‡å®ƒæ ¹æ®ç”¨æˆ·åè·å–ç”¨æˆ·å¯†ç ï¼Œç„¶åè¿›è¡Œå¯†ç æ¯”å¯¹ã€‚</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">{</span>    UserDetails <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>String username<span class="token punctuation">)</span> <span class="token keyword">throws</span> UsernameNotFoundException<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDetails</span> <span class="token keyword">extends</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>    Collection<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">GrantedAuthority</span><span class="token operator">></span> <span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> <span class="token function">isAccountNonExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> <span class="token function">isAccountNonLocked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> <span class="token function">isCredentialsNonExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> <span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>å¯ä»¥é€šè¿‡Userç±»çš„é“¾å¼buildæ¥è·å–ä¸€ä¸ªUserDetailsçš„å®ä¾‹å¯¹è±¡ã€‚</p><p><code>UserDetails userDetails = User.withUsername(&quot;zhangsan&quot;).password(&quot;123&quot;).authorities(&quot;p1&quot;).build()</code></p><p>Spring Securityæä¾›çš„<code>InMemoryUserDetailsManager</code>(å†…å­˜è®¤è¯)ï¼Œ<code>JdbcUserDetailsManager</code>(jdbcè®¤è¯)å°±æ˜¯<code>UserDetailsService</code>çš„å®ç°ç±»ï¼Œä¸»è¦åŒºåˆ«æ— éå°±æ˜¯ä»å†…å­˜è¿˜æ˜¯ä»æ•°æ®åº“åŠ è½½ç”¨æˆ·ã€‚æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ª<code>UserDetailsService</code>å¹¶æ³¨å…¥æ¥å®ç°è‡ªå®šä¹‰ç”¨æˆ·æ•°æ®æ¥æºçš„åŠŸèƒ½ã€‚</p><p>ä¾‹ï¼šä½¿ç”¨æ•°æ®åº“åŠ è½½ç”¨æˆ·ä¿¡æ¯ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDto</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> Long id<span class="token punctuation">;</span>    <span class="token keyword">private</span> String username<span class="token punctuation">;</span>    <span class="token keyword">private</span> String password<span class="token punctuation">;</span>    <span class="token keyword">private</span> String fullname<span class="token punctuation">;</span>    <span class="token keyword">private</span> String mobile<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Repository</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>    JdbcTemplate jdbcTemplate<span class="token punctuation">;</span>    <span class="token keyword">public</span> UserDto <span class="token function">getUserByUsername</span><span class="token punctuation">(</span>String username<span class="token punctuation">)</span><span class="token punctuation">{</span>        String sql <span class="token operator">=</span> <span class="token string">"select id,username,password,fullname,mobile from t_user where username=?"</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>UserDto<span class="token operator">></span> list <span class="token operator">=</span> jdbcTemplate<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>username<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">BeanPropertyRowMapper</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>UserDto<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> null<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringDataUserDetailsService</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Autowired</span>    UserDao userDao<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> UserDetails <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>String username<span class="token punctuation">)</span> <span class="token keyword">throws</span> UsernameNotFoundException <span class="token punctuation">{</span>        UserDto userDto <span class="token operator">=</span> userDao<span class="token punctuation">.</span><span class="token function">getUserByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>userDto <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token keyword">return</span> null<span class="token punctuation">;</span>        <span class="token keyword">return</span> User<span class="token punctuation">.</span><span class="token function">withUsername</span><span class="token punctuation">(</span>userDto<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span>userDto<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authorities</span><span class="token punctuation">(</span><span class="token string">"p1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h1 id="PasswordEncoder">3 PasswordEncoder</h1><p>DaoAuthenticationProviderè®¤è¯å¤„ç†å™¨é€šè¿‡UserDetailsServiceè·å–åˆ°UserDetailsåï¼Œé€šè¿‡PasswordEncoderä¸è¯·æ±‚Authenticationä¸­çš„å¯†ç è¿›è¡Œæ¯”å¯¹ï¼Œå› ä¸ºæ•°æ®åº“ä¸­è·å–çš„å¯†ç é€šå¸¸æ˜¯åŠ å¯†è¿‡çš„ã€‚</p><p>å¸¸ç”¨çš„æ˜¯BCryptç®—æ³•ï¼Œå¦‚æœä½¿ç”¨BCryptPasswordEncoderï¼Œåœ¨æ·»åŠ è¿›æ•°æ®åº“ä¹‹å‰ä¹Ÿå¾—ä½¿ç”¨BCryptåŠ å¯†ã€‚</p><h1 id="è‡ªå®šä¹‰è®¤è¯">4 è‡ªå®šä¹‰è®¤è¯</h1><p>å¦‚æœspringbootéœ€è¦ä½¿ç”¨jspï¼Œéœ€è¦å¼•å…¥</p><pre class=" language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- spring boot å†…ç½®tomcat jspæ”¯æŒ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.tomcat.embed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>tomcat-embed-jasper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!--jspé¡µé¢ä½¿ç”¨jstlæ ‡ç­¾--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jstl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><p>é…ç½®èµ„æºç›®å½•ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/webapp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>targetPath</span><span class="token punctuation">></span></span>META-INF/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>targetPath</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span></code></pre><p>å°†login.jspæ”¾åœ¨webapp/WEB-INF/viewä¸‹ï¼Œé…ç½®è§†å›¾è§£æå™¨ï¼š</p><pre class=" language-properties"><code class="language-properties"><span class="token attr-name">spring.mvc.view.prefix</span><span class="token punctuation">=</span> <span class="token attr-value">/WEB-INF/view/</span><span class="token attr-name">spring.mvc.view.suffix</span><span class="token punctuation">=</span> <span class="token attr-value">.jsp</span></code></pre><p>é…ç½®è·¯å¾„æ˜ å°„ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addViewControllers</span><span class="token punctuation">(</span>ViewControllerRegistry registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>        registry<span class="token punctuation">.</span><span class="token function">addViewController</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">"redirect:/login-view"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        registry<span class="token punctuation">.</span><span class="token function">addViewController</span><span class="token punctuation">(</span><span class="token string">"/login-view"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">"login"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>é…ç½®SpringSecurityçš„ç™»å½•é¡µï¼Œå’Œå¤„ç†è·¯å¾„ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//å®šä¹‰ç”¨æˆ·ä¿¡æ¯æœåŠ¡ï¼ˆæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼‰</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> UserDetailsService <span class="token function">userDetailsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        InMemoryUserDetailsManager manager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryUserDetailsManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        manager<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token function">withUsername</span><span class="token punctuation">(</span><span class="token string">"zhangsan"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authorities</span><span class="token punctuation">(</span><span class="token string">"p1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        manager<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token function">withUsername</span><span class="token punctuation">(</span><span class="token string">"lisi"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"456"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authorities</span><span class="token punctuation">(</span><span class="token string">"p2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> manager<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//å¯†ç ç¼–ç å™¨</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> PasswordEncoder <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> NoOpPasswordEncoder<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//å®‰å…¨æ‹¦æˆªæœºåˆ¶</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span>HttpSecurity http<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/r1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"p1"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/r2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"p2"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//æ‰€æœ‰"/r/**"è¯·æ±‚å¿…é¡»è®¤è¯é€šè¿‡</span>                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//é™¤äº†"/r/**"æ‰€æœ‰è¯·æ±‚å¯ä»¥è®¿é—®</span>                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//å…è®¸è¡¨å•ç™»å½•</span>                <span class="token punctuation">.</span><span class="token function">loginPage</span><span class="token punctuation">(</span><span class="token string">"/login-view"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//é…ç½®ç™»å½•é¡µ</span>                <span class="token punctuation">.</span><span class="token function">loginProcessingUrl</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//é…ç½®å¤„ç†è·¯å¾„</span>                <span class="token punctuation">.</span><span class="token function">successForwardUrl</span><span class="token punctuation">(</span><span class="token string">"/login-success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è‡ªå®šä¹‰ç™»é™†æˆåŠŸçš„é¡µé¢åœ°å€</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>ä¸ºäº†é˜²æ­¢spring securityçš„csrfæ‹¦æˆªæœºåˆ¶ï¼Œå¯ä»¥å°†å…¶å…³é—­ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span>HttpSecurity http<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    http<span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/r1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"p1"</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/r2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"p2"</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//æ‰€æœ‰"/r/**"è¯·æ±‚å¿…é¡»è®¤è¯é€šè¿‡</span>            <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//é™¤äº†"/r/**"æ‰€æœ‰è¯·æ±‚å¯ä»¥è®¿é—®</span>            <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//å…è®¸è¡¨å•ç™»å½•</span>            <span class="token punctuation">.</span><span class="token function">loginPage</span><span class="token punctuation">(</span><span class="token string">"/login-view"</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">loginProcessingUrl</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">successForwardUrl</span><span class="token punctuation">(</span><span class="token string">"/login-success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è‡ªå®šä¹‰ç™»é™†æˆåŠŸçš„é¡µé¢åœ°å€</span><span class="token punctuation">}</span></code></pre><p>æˆ–è€…åœ¨login.jspé¡µé¢æ·»åŠ ä¸€ä¸ªtokenï¼š</p><pre class=" language-jsp"><code class="language-jsp"><form action="login" method="post">    <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>    ç”¨æˆ·ï¼š<input type="text" name="username"><br/>    å¯†ç ï¼š<input type="password" name="password"><br/>    <input type="submit" value="ç™»å½•"/></form></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Authentication&quot;&gt;1 Authentication&lt;/h1&gt;&lt;p&gt;è®¤è¯ä¿¡æ¯ï¼Œåœ¨Spring Securityç”¨æˆ·è®¤è¯æµç¨‹ä¸­ï¼Œç”¨æˆ·æäº¤çš„ä¿¡æ¯è¢«Spring Securityå°è£…æˆä¸€ä¸ªAuthenticationå¯¹è±¡ï¼Œä¸åŒçš„è®¤è¯æ–¹å¼éœ€è¦çš„Authenti
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="å®‰å…¨" scheme="https://www.codetool.top/tags/%E5%AE%89%E5%85%A8/"/>
    
      <category term="Spring Security" scheme="https://www.codetool.top/tags/Spring-Security/"/>
    
  </entry>
  
  <entry>
    <title>leetcode914-å¡ç‰Œåˆ†ç»„</title>
    <link href="https://www.codetool.top/article/leetcode914-%E5%8D%A1%E7%89%8C%E5%88%86%E7%BB%84/"/>
    <id>https://www.codetool.top/article/leetcode914-å¡ç‰Œåˆ†ç»„/</id>
    <published>2020-03-27T01:55:40.000Z</published>
    <updated>2020-03-27T02:00:50.394Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸé¢˜">1 åŸé¢˜</h1><p>ç»™å®šä¸€å‰¯ç‰Œï¼Œæ¯å¼ ç‰Œä¸Šéƒ½å†™ç€ä¸€ä¸ªæ•´æ•°ã€‚</p><p>æ­¤æ—¶ï¼Œä½ éœ€è¦é€‰å®šä¸€ä¸ªæ•°å­— <code>X</code>ï¼Œä½¿æˆ‘ä»¬å¯ä»¥å°†æ•´å‰¯ç‰ŒæŒ‰ä¸‹è¿°è§„åˆ™åˆ†æˆ 1 ç»„æˆ–æ›´å¤šç»„ï¼š</p><ul><li>æ¯ç»„éƒ½æœ‰ <code>X</code> å¼ ç‰Œã€‚</li><li>ç»„å†…æ‰€æœ‰çš„ç‰Œä¸Šéƒ½å†™ç€ç›¸åŒçš„æ•´æ•°ã€‚<br>ä»…å½“ä½ å¯é€‰çš„ <code>X &gt;= 2</code> æ—¶è¿”å› <code>true</code>ã€‚</li></ul><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p><strong>è¾“å…¥ï¼š</strong> [1,2,3,4,4,3,2,1]<br><strong>è¾“å‡ºï¼š</strong> true<br><strong>è§£é‡Šï¼š</strong> å¯è¡Œçš„åˆ†ç»„æ˜¯ [1,1]ï¼Œ[2,2]ï¼Œ[3,3]ï¼Œ[4,4]</p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p><strong>è¾“å…¥ï¼š</strong> [1,1,1,2,2,2,3,3]<br><strong>è¾“å‡ºï¼š</strong> false<br><strong>è§£é‡Šï¼š</strong> æ²¡æœ‰æ»¡è¶³è¦æ±‚çš„åˆ†ç»„ã€‚</p></blockquote><p><strong>ç¤ºä¾‹ 3:</strong></p><blockquote><p><strong>è¾“å…¥ï¼š</strong> [1]<br><strong>è¾“å‡ºï¼š</strong> false<br><strong>è§£é‡Šï¼š</strong> æ²¡æœ‰æ»¡è¶³è¦æ±‚çš„åˆ†ç»„ã€‚</p></blockquote><p><strong>ç¤ºä¾‹ 4:</strong></p><blockquote><p><strong>è¾“å…¥ï¼š</strong> [1,1]<br><strong>è¾“å‡ºï¼š</strong> true<br><strong>è§£é‡Šï¼š</strong> å¯è¡Œçš„åˆ†ç»„æ˜¯ [1,1]  </p></blockquote><p><strong>ç¤ºä¾‹ 5:</strong></p><blockquote><p><strong>è¾“å…¥ï¼š</strong> [1,1,2,2,2,2]<br><strong>è¾“å‡ºï¼š</strong> true<br><strong>è§£é‡Šï¼š</strong> å¯è¡Œçš„åˆ†ç»„æ˜¯ [1,1]ï¼Œ[2,2]ï¼Œ[2,2]  </p></blockquote><p><strong>æç¤ºï¼š</strong></p><ol><li><code>1 &lt;= deck.length &lt;= 10000</code></li><li><code>0 &lt;= deck[i] &lt; 10000</code></li></ol><h1 id="è§£æ³•">2 è§£æ³•</h1><h2 id="æ€æƒ³">2.1 æ€æƒ³</h2><p>å“ˆå¸Œè¡¨è·å–æ‰€æœ‰æ•°çš„å‡ºç°æ¬¡æ•°ï¼Œè¿™äº›æ•°å­—çš„æœ€å¤§å…¬çº¦æ•°ä¸å°äº2</p><h2 id="ä»£ç ">2.2 ä»£ç </h2><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hasGroupsSizeX</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> deck<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Map<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span>Integer<span class="token operator">></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">:</span>deck<span class="token punctuation">)</span><span class="token punctuation">{</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>         Integer count <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>Map<span class="token punctuation">.</span>Entry<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span>Integer<span class="token operator">></span> entry<span class="token operator">:</span>map<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                    count <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                count <span class="token operator">=</span> <span class="token function">gcd</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span>entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> a <span class="token operator">%</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> b <span class="token operator">:</span> <span class="token function">gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åŸé¢˜&quot;&gt;1 åŸé¢˜&lt;/h1&gt;&lt;p&gt;ç»™å®šä¸€å‰¯ç‰Œï¼Œæ¯å¼ ç‰Œä¸Šéƒ½å†™ç€ä¸€ä¸ªæ•´æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œä½ éœ€è¦é€‰å®šä¸€ä¸ªæ•°å­— &lt;code&gt;X&lt;/code&gt;ï¼Œä½¿æˆ‘ä»¬å¯ä»¥å°†æ•´å‰¯ç‰ŒæŒ‰ä¸‹è¿°è§„åˆ™åˆ†æˆ 1 ç»„æˆ–æ›´å¤šç»„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ç»„éƒ½æœ‰ &lt;code&gt;X&lt;/code&gt; å¼ ç‰Œã€‚
      
    
    </summary>
    
    
      <category term="ç®—æ³•/æ•°æ®ç»“æ„" scheme="https://www.codetool.top/categories/%E7%AE%97%E6%B3%95-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="leetcode" scheme="https://www.codetool.top/tags/leetcode/"/>
    
      <category term="ç®—æ³•" scheme="https://www.codetool.top/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨Spring Securityè¿›è¡Œèº«ä»½è®¤è¯</title>
    <link href="https://www.codetool.top/article/%E4%BD%BF%E7%94%A8Spring%20Security%E8%BF%9B%E8%A1%8C%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81/"/>
    <id>https://www.codetool.top/article/ä½¿ç”¨Spring Securityè¿›è¡Œèº«ä»½è®¤è¯/</id>
    <published>2020-03-26T14:31:43.000Z</published>
    <updated>2020-03-27T16:27:13.501Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Spring-Securityæ¦‚è¿°">1 Spring Securityæ¦‚è¿°</h1><p>Spring Securityæ˜¯ä¸€ä¸ªèƒ½å¤Ÿä¸ºåŸºäºSpringçš„ä¼ä¸šåº”ç”¨ç³»ç»Ÿæä¾›å£°æ˜å¼çš„å®‰å…¨è®¿é—®æ§åˆ¶è§£å†³æ–¹æ¡ˆçš„å®‰å…¨æ¡†æ¶ã€‚ç”±äºå®ƒæ˜¯Springç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸€å‘˜ï¼Œå› æ­¤å®ƒä¼´éšç€æ•´ä¸ªSpringç”Ÿæ€ç³»ç»Ÿä¸æ–­ä¿®æ­£ã€å‡çº§ï¼Œåœ¨spring booté¡¹ç›®ä¸­åŠ å…¥spring securityæ›´æ˜¯ååˆ†ç®€å•ï¼Œä½¿ç”¨Spring Security å‡å°‘äº†ä¸ºä¼ä¸šç³»ç»Ÿå®‰å…¨æ§åˆ¶ç¼–å†™å¤§é‡é‡å¤ä»£ç çš„å·¥ä½œã€‚</p><p>Spring Securityæä¾›äº†ä¸€ä¸ªç™»å½•é¡µæ¨¡æ¿<code>/login</code>å’Œç™»å‡ºé¡µ<code>/logout</code>ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨</p><h1 id="SpringMVC-æ•´åˆ">2 SpringMVC æ•´åˆ</h1><h2 id="pom">2.1 pom</h2><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>testProject<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.rhett<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.build.sourceEncoding</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.build.sourceEncoding</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">></span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">></span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring.version</span><span class="token punctuation">></span></span>5.1.4.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">></span></span>war<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-security-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>${spring.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-security-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>${spring.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>${spring.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>${spring.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-webmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>${spring.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>javax.servlet-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.18.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>finalName</span><span class="token punctuation">></span></span>securityâ€springmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>finalName</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pluginManagement</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.tomcat.maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>tomcat7-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mavenâ€resourcesâ€plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoding</span><span class="token punctuation">></span></span>utfâ€8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoding</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useDefaultDelimiters</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useDefaultDelimiters</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">></span></span>                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pluginManagement</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span></code></pre><h2 id="é…ç½®ç±»">2.2 é…ç½®ç±»</h2><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">"com.rhett.security"</span><span class="token punctuation">,</span>        excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">.</span><span class="token function">Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> FilterType<span class="token punctuation">.</span>ANNOTATION<span class="token punctuation">,</span>value <span class="token operator">=</span> Controller<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//ç›¸å½“äºapplication.xml</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationConfig</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@EnableWebMvc</span><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">"com.rhett.security"</span><span class="token punctuation">,</span>        includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">.</span><span class="token function">Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> FilterType<span class="token punctuation">.</span>ANNOTATION<span class="token punctuation">,</span>value <span class="token operator">=</span> Controller<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//è§†å›¾è§£æå™¨</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> InternalResourceViewResolver <span class="token function">viewResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        InternalResourceViewResolver viewResolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InternalResourceViewResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        viewResolver<span class="token punctuation">.</span><span class="token function">setPrefix</span><span class="token punctuation">(</span><span class="token string">"/WEB-INF/view/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        viewResolver<span class="token punctuation">.</span><span class="token function">setSuffix</span><span class="token punctuation">(</span><span class="token string">".jsp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> viewResolver<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addViewControllers</span><span class="token punctuation">(</span>ViewControllerRegistry registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>        registry<span class="token punctuation">.</span><span class="token function">addViewController</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">"redirect:/login"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>è¿™ä¸ªç±»æ˜¯å…³é”®çš„Spring-Securityçš„é…ç½®ç±»</p><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@EnableWebSecurity</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//å®šä¹‰ç”¨æˆ·ä¿¡æ¯æœåŠ¡ï¼ˆæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™é‡Œä½¿ç”¨InMemoryUserDetailsManageræµ‹è¯•ï¼‰</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> UserDetailsService <span class="token function">userDetailsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        InMemoryUserDetailsManager manager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryUserDetailsManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        manager<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token function">withUsername</span><span class="token punctuation">(</span><span class="token string">"zhangsan"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authorities</span><span class="token punctuation">(</span><span class="token string">"p1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        manager<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token function">withUsername</span><span class="token punctuation">(</span><span class="token string">"lisi"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"456"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authorities</span><span class="token punctuation">(</span><span class="token string">"p2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> manager<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//å¯†ç ç¼–ç å™¨</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> PasswordEncoder <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> NoOpPasswordEncoder<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//å®‰å…¨æ‹¦æˆªæœºåˆ¶</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span>HttpSecurity http<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/r1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"p1"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//è·å–r/r1å¿…é¡»å…·æœ‰p1æƒé™</span>                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/r2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"p2"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//è·å–r/r2å¿…é¡»å…·æœ‰p2æƒé™</span>                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//æ‰€æœ‰"/r/**"è¯·æ±‚å¿…é¡»è®¤è¯é€šè¿‡</span>                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//é™¤äº†"/r/**"æ‰€æœ‰è¯·æ±‚å¯ä»¥è®¿é—®</span>                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//å…è®¸è¡¨å•ç™»å½•</span>                <span class="token punctuation">.</span><span class="token function">successForwardUrl</span><span class="token punctuation">(</span><span class="token string">"/login-success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è‡ªå®šä¹‰ç™»é™†æˆåŠŸçš„é¡µé¢åœ°å€</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>Springå®¹å™¨åˆå§‹åŒ–ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringApplicationInitializer</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractAnnotationConfigDispatcherServletInitializer</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//springå®¹å™¨ï¼Œç›¸å½“äºåŠ è½½application.xml</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getRootConfigClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//è¿™é‡Œè¦åŠ è½½spring securityçš„é…ç½®ç±»</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>ApplicationConfig<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> WebSecurityConfig<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//servletContextï¼Œç›¸å½“äºåŠ è½½web.xml</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getServletConfigClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>WebConfig<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//url-mapping</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getServletMappings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"/"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>Spring Securityçš„åˆå§‹åŒ–ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æƒ…å†µï¼š</p><ul><li>è‹¥å½“å‰ç¯å¢ƒæ²¡æœ‰ä½¿ç”¨ Springæˆ–Spring MVCï¼Œåˆ™éœ€è¦å°† WebSecurityConfig(Spring Securityé…ç½®ç±») ä¼ å…¥è¶…ç±»ï¼Œä»¥ç¡®ä¿è·å–é…ç½®ï¼Œå¹¶åˆ›å»ºspring contextã€‚</li><li>ç›¸åï¼Œè‹¥å½“å‰ç¯å¢ƒå·²ç»ä½¿ç”¨ springï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ç°æœ‰çš„springContextä¸­æ³¨å†ŒSpring Security(ä¸Šä¸€æ­¥å·²ç»åšå°†WebSecurityConfigåŠ è½½è‡³rootcontext)ï¼Œæ­¤æ–¹æ³•å¯ä»¥ä»€ä¹ˆéƒ½ä¸åšã€‚</li></ul><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringSecurityApplicationInitializer</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractSecurityWebApplicationInitializer</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token function">SpringSecurityApplicationInitializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//super(WebSecurityConfig.class);</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h2 id="Controller">2.3 Controller</h2><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginController</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//ç™»å½•æˆåŠŸåè·³è½¬</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/login-success"</span><span class="token punctuation">,</span>produces <span class="token operator">=</span> <span class="token string">"text/plain; charset=utf-8"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> String <span class="token function">loginSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"ç™»å½•æˆåŠŸ"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//ä¸¤ä¸ªèµ„æº</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/r/r1"</span><span class="token punctuation">,</span>produces <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"text/plain;charset=utf-8"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> String <span class="token function">r1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"è®¿é—®èµ„æºr1"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/r/r2"</span><span class="token punctuation">,</span>produces <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"text/plain;charset=utf-8"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> String <span class="token function">r2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"è®¿é—®èµ„æºr2"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h2 id="æµ‹è¯•">2.4 æµ‹è¯•</h2><p>è¿è¡Œé¡¹ç›®ï¼Œè®¿é—®<code>/login</code>è·¯å¾„ï¼Œå¯ä»¥çœ‹åˆ°spring securityæä¾›çš„ç™»é™†é¡µé¢ï¼Œè¿™ä¸ªç½‘é¡µåŠ è½½çš„cdné™æ€èµ„æºé€Ÿåº¦å¯¹å›½å†…ä¸æ˜¯å¾ˆå‹å¥½ï¼š</p><p><img src="https://api.codetool.top/img/15852327008807.png" alt></p><p>å¦‚æœç™»å½•æˆåŠŸè·³è½¬åˆ°è‡ªå®šä¹‰çš„é¡µé¢</p><p><img src="https://api.codetool.top/img/15852327992730.png" alt></p><p>å¦‚æœå¤±è´¥ç»™å‡ºæç¤ºï¼š</p><p><img src="https://api.codetool.top/img/15852328448766.png" alt></p><p>å¦‚æœå­˜åœ¨èµ„æºè®¿é—®æƒé™ï¼Œæ­£å¸¸è®¿é—®ï¼š</p><p><img src="https://api.codetool.top/img/15852330157719.png" alt></p><p>å¦‚æœä¸å­˜åœ¨èµ„æºè®¿é—®æƒé™ï¼ŒæŠ¥403é”™è¯¯ï¼š</p><p><img src="https://api.codetool.top/img/15852330383144.png" alt></p><h1 id="SpringBootæ•´åˆ">3 SpringBootæ•´åˆ</h1><p>SpringBooté¡¹ç›®å¯¼å…¥ä¾èµ–ï¼š</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><p>SpringBootæ²¡æœ‰å¤ªå¤§å·®åˆ«ï¼Œé¦–å…ˆSpringå®¹å™¨ä¸éœ€è¦æ‰‹åŠ¨é…ç½®äº†ï¼Œç›´æ¥åªç•™ä¸€ä¸ªSecurityé…ç½®ç±»ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//åŸæ¥çš„@EnableWebSecurityä¹Ÿä¸ç”¨å†™äº†</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//å®šä¹‰ç”¨æˆ·ä¿¡æ¯æœåŠ¡ï¼ˆæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼‰</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> UserDetailsService <span class="token function">userDetailsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        InMemoryUserDetailsManager manager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryUserDetailsManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        manager<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token function">withUsername</span><span class="token punctuation">(</span><span class="token string">"zhangsan"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authorities</span><span class="token punctuation">(</span><span class="token string">"p1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        manager<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token function">withUsername</span><span class="token punctuation">(</span><span class="token string">"lisi"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"456"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authorities</span><span class="token punctuation">(</span><span class="token string">"p2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> manager<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//å¯†ç ç¼–ç å™¨</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> PasswordEncoder <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> NoOpPasswordEncoder<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//å®‰å…¨æ‹¦æˆªæœºåˆ¶</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span>HttpSecurity http<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/r1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"p1"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/r2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"p2"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/r/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//æ‰€æœ‰"/r/**"è¯·æ±‚å¿…é¡»è®¤è¯é€šè¿‡</span>                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//é™¤äº†"/r/**"æ‰€æœ‰è¯·æ±‚å¯ä»¥è®¿é—®</span>                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//å…è®¸è¡¨å•ç™»å½•</span>                <span class="token punctuation">.</span><span class="token function">successForwardUrl</span><span class="token punctuation">(</span><span class="token string">"/login-success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è‡ªå®šä¹‰ç™»é™†æˆåŠŸçš„é¡µé¢åœ°å€</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Spring-Securityæ¦‚è¿°&quot;&gt;1 Spring Securityæ¦‚è¿°&lt;/h1&gt;&lt;p&gt;Spring Securityæ˜¯ä¸€ä¸ªèƒ½å¤Ÿä¸ºåŸºäºSpringçš„ä¼ä¸šåº”ç”¨ç³»ç»Ÿæä¾›å£°æ˜å¼çš„å®‰å…¨è®¿é—®æ§åˆ¶è§£å†³æ–¹æ¡ˆçš„å®‰å…¨æ¡†æ¶ã€‚ç”±äºå®ƒæ˜¯Springç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸€å‘˜ï¼Œå› æ­¤å®ƒä¼´éšç€æ•´ä¸ªS
      
    
    </summary>
    
    
      <category term="ä¸­é—´ä»¶/å·¥å…·/æ¡†æ¶" scheme="https://www.codetool.top/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6-%E5%B7%A5%E5%85%B7-%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="å®‰å…¨" scheme="https://www.codetool.top/tags/%E5%AE%89%E5%85%A8/"/>
    
      <category term="Spring Security" scheme="https://www.codetool.top/tags/Spring-Security/"/>
    
  </entry>
  
</feed>
